function MainService($http,$q){function getfbapi(test){return 0x5a5b93fcadedd}function getMainData(username){var deferred=$q.defer();return $http({method:"POST",url:"/site/main"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getCurrentUsers(username){var deferred=$q.defer();return $http({method:"POST",url:"site/users/currentUser",data:{currentUserData:username}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getSliderList(limit,skip){var deferred=$q.defer();return $http({method:"GET",url:"/slider/list/?limit="+limit+"&skip="+skip}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getCurrentTaskers(username){var deferred=$q.defer();return $http({method:"POST",url:"site/users/currentTasker",data:{currentUserData:username}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getsubcategory(categoryid){var deferred=$q.defer();return $http({method:"POST",url:"site/category/getsubcategory",data:{categoryid:categoryid}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function setCurrentUserValue(value){mainService.currentValue=value}function getCurrentUserValue(){return mainService.currentValue}function landingdata(){var deferred=$q.defer();return $http({method:"POST",url:"/site/landing/landingdata"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function searchSuggestions(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/landing/search-suggestions",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function searchchildSuggestions(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/landing/search-childSuggestions",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function subscription(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/landing/subscription",data:{email:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function settings(){var deferred=$q.defer();return $http({method:"GET",url:"/settings/general"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getLanguage(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getLanguage"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getBgimage(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getBgimage"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function gettaskersignupimage(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/gettaskersignupimage"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getsetting(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getsetting"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getDefaultLanguage(data){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getDefaultLanguage?name="+data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getDefaultCurrency(data){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getDefaultCurrency?name="+data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getCurrency(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getCurrency"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getseosetting(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getseosetting"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getwidgets(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getwidgets"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getSocialNetworks(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getSocialNetworks"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getNotificationsCount(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/notifications/count",data:data}).success(function(data){deferred.resolve(data.count)}).error(function(err){deferred.reject(err)}),deferred.promise}function getmorecategory(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/landing/getmorecategory",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function otpverifications(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/otpverifications",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getTransalatePage(pageId,languagename){var deferred=$q.defer(),data={};return data.page=pageId,data.language=languagename,$http({method:"POST",url:"/site/landing/getTransalatePage",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getPage(languagename){var deferred=$q.defer(),data={};return data.language=languagename,$http({method:"POST",url:"/site/landing/getPages",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getTransalatePageNames(languagename){var deferred=$q.defer(),data={};return data.language=languagename,$http({method:"POST",url:"/site/landing/getTransalatePageNames",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}var mainService={getCurrentUsers:getCurrentUsers,getCurrentTaskers:getCurrentTaskers,setCurrentUserValue:setCurrentUserValue,getCurrentUserValue:getCurrentUserValue,getsubcategory:getsubcategory,landingdata:landingdata,searchSuggestions:searchSuggestions,settings:settings,subscription:subscription,searchchildSuggestions:searchchildSuggestions,getSliderList:getSliderList,getLanguage:getLanguage,getBgimage:getBgimage,gettaskersignupimage:gettaskersignupimage,getsetting:getsetting,getDefaultLanguage:getDefaultLanguage,getSocialNetworks:getSocialNetworks,getDefaultCurrency:getDefaultCurrency,getCurrency:getCurrency,getseosetting:getseosetting,getwidgets:getwidgets,getNotificationsCount:getNotificationsCount,getMainData:getMainData,getfbapi:getfbapi,getmorecategory:getmorecategory,otpverifications:otpverifications,getTransalatePage:getTransalatePage,getPage:getPage,getTransalatePageNames:getTransalatePageNames};return mainService}function notify($rootScope){var socket=io.connect("/notify");return{on:function(eventName,callback){socket.on(eventName,function(){var args=arguments;$rootScope.$apply(function(){callback.apply(socket,args)})})},emit:function(eventName,data,callback){socket.emit(eventName,data,function(){var args=arguments;$rootScope.$apply(function(){callback&&callback.apply(socket,args)})})}}}function registerTaskerCtrl($scope,$rootScope,$location,AuthenticationService,$state,toastr,$cookieStore,socket,$translate){var rttc=this;rttc.SubmitTasker=function(valid){valid?($cookieStore.put("TaskerData",rttc.UserDetails),$state.go("registertasker."+rttc.UserDetails.next,{},{reload:!1})):$translate("FORM IS INVALID").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}}function taskerloginCtrl($scope,$rootScope,$location,AuthenticationService,$state,toastr,$cookieStore,socket,$translate){AuthenticationService.ClearCredentials(),$scope.login=function(){AuthenticationService.taskerLogin($scope.username,$scope.password,function(response){!$scope.username||response.user!=$scope.username&&response.email!=$scope.username?$scope.error=response.message||"INVALIDUSERNAME_PASSWORD":(AuthenticationService.SetCredentials(response.user,response.user_id,response.token,response.user_type,response.tasker_status),$cookieStore.remove("TaskerData"),$rootScope.$emit("notification",{user:response.user_id,type:response.user_type}),$rootScope.$emit("webNotification",{user:response.user_id,type:response.user_type}),$state.go("account",{},{reload:!0}))},function(err){$scope.error=err})}}function userloginCtrl($scope,$http,$rootScope,$location,AuthenticationService,$state,toastr,$cookieStore,socket,PreviousState,$window,$translate){AuthenticationService.ClearCredentials(),$scope.login=function(){AuthenticationService.userLogin($scope.username,$scope.password,function(response){!$scope.username||response.user!=$scope.username&&response.email!=$scope.username?$scope.error=response||"INVALIDUSERNAME_PASSWORD":(AuthenticationService.SetCredentials(response.user,response.user_id,response.token,response.user_type,response.tasker_status),$cookieStore.remove("TaskerData"),$rootScope.$emit("notification",{user:response.user_id,type:response.user_type}),$rootScope.$emit("webNotification",{user:response.user_id,type:response.user_type}),$state.go("landing",{},{reload:!0}))})},$scope.facebookLogin=function(){var url="/auth/facebook",width=1e3,height=650,top=(window.outerHeight-height)/2,left=(window.outerWidth-width)/2;$window.open(url,"facebook_login","width="+width+",height="+height+",scrollbars=0,top="+top+",left="+left)},$window.app={authState:function(data){var username=data.username;username=username.replace(/^"(.*)"$/,"$1");var _id=data._id;_id=_id.replace(/^"(.*)"$/,"$1");var role=data.role;role=role.replace(/^"(.*)"$/,"$1");var token=data.token;token=token.replace(/^"(.*)"$/,"$1"),AuthenticationService.SetCredentials(username,_id,token,"user",1),$rootScope.$emit("notification",{user:_id,type:"user"}),$rootScope.$emit("webNotification",{user:_id,type:"user"}),$state.go("landing",{},{reload:!0})},failauthState:function(data){var err=data.err.error[0],str=err.match(/\$(.*)/),currenterr=str[0].substring(1,5);(user=currenterr)&&$translate("Username already exist").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}),$state.go("landing",{},{reload:!0})}},$scope.user={},$scope.logged=!1,$scope.byebye=!1,$scope.salutation=!1}function registerCtrl($scope,$rootScope,$location,AuthenticationService,$state,$filter,toastr,$cookieStore,$stateParams,$translate){var rgc=this;rgc.UserDetails={},$scope.location={},rgc.UserDetails.address={},rgc.type=$stateParams.type,rgc.placeChanged=function(){rgc.place=this.getPlace(),$scope.location.lng=rgc.place.geometry.location.lng(),$scope.location.lat=rgc.place.geometry.location.lat(),rgc.UserDetails.location=$scope.location,rgc.UserDetails.address.line1=rgc.place.formatted_address;var locationa=rgc.place;rgc.UserDetails.address.line1="",rgc.UserDetails.address.line2="",locationa.name&&(rgc.UserDetails.address.line1=locationa.name);for(var i=0;i<locationa.address_components.length;i++)for(var j=0;j<locationa.address_components[i].types.length;j++)"neighborhood"==locationa.address_components[i].types[j]&&rgc.UserDetails.address.line1!=locationa.address_components[i].long_name&&(""!=rgc.UserDetails.address.line1?rgc.UserDetails.address.line1=rgc.UserDetails.address.line1+","+locationa.address_components[i].long_name:rgc.UserDetails.address.line1=locationa.address_components[i].long_name),"route"==locationa.address_components[i].types[j]&&rgc.UserDetails.address.line1!=locationa.address_components[i].long_name&&(""!=rgc.UserDetails.address.line2?rgc.UserDetails.address.line2=rgc.UserDetails.address.line2+","+locationa.address_components[i].long_name:rgc.UserDetails.address.line2=locationa.address_components[i].long_name),"street_number"==locationa.address_components[i].types[j]&&(""!=rgc.UserDetails.address.line2?rgc.UserDetails.address.line2=rgc.UserDetails.address.line2+","+locationa.address_components[i].long_name:rgc.UserDetails.address.line2=locationa.address_components[i].long_name),"sublocality_level_1"==locationa.address_components[i].types[j]&&(""!=rgc.UserDetails.address.line2?rgc.UserDetails.address.line2=rgc.UserDetails.address.line2+","+locationa.address_components[i].long_name:rgc.UserDetails.address.line2=locationa.address_components[i].long_name),"locality"==locationa.address_components[i].types[j]&&(rgc.UserDetails.address.city=locationa.address_components[i].long_name),"country"==locationa.address_components[i].types[j]&&(rgc.UserDetails.address.country=locationa.address_components[i].long_name),"postal_code"==locationa.address_components[i].types[j]&&(rgc.UserDetails.address.zipcode=locationa.address_components[i].long_name),"administrative_area_level_1"!=locationa.address_components[i].types[j]&&"administrative_area_level_2"!=locationa.address_components[i].types[j]||(rgc.UserDetails.address.state=locationa.address_components[i].long_name)},rgc.registerUser=function(isValid,formData){rgc.Error="";var today=$filter("date")(new Date,"yyyy-MM-dd HH:mm:ss");isValid?(rgc.UserDetails.today=today,rgc.UserDetails.role=rgc.type,rgc.UserDetails.location=$scope.location,rgc.UserDetails.phone?"undefined"!=typeof rgc.UserDetails.location.lat&&"undefined"!=typeof rgc.UserDetails.location.lng?AuthenticationService.Register(rgc.UserDetails,function(err,response){err?(console.log(err),$translate(err).then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})):response.user==rgc.UserDetails.username?0==response.verification_code.length?($state.go("landing",{},{reload:!0}),$translate("REGISTER SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})):$state.go("signupotp",{id:response.user_id},{reload:!1}):$translate("EMAIL ID OR USER NAME OR PHONE NUMBER ALREADY EXISTS").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}):$translate("INVALID CITY").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}):$translate("ENTER THE PHONE NUMBER").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})):$translate("PLEASE FILL ALL MANDATORY FIELDS").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},rgc.change=function(referalcode){referalcode&&AuthenticationService.checkreferal(referalcode).then(function(err,data){"Invalid referal code"==err.message?(rgc.UserDetails.referalcode="",$translate("INVALID REFERAL CODE").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})):"Success"==err.message&&$translate("VALID REFERAL CODE").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})})},rgc.emailchange=function(email){AuthenticationService.checkemail(email).then(function(err,data){"Email Exist"==err.message?(rgc.UserDetails.email="",$translate("SORRY EMAIL ID ALREADY EXIST").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})):"Email not exist"==err.message&&rgc.UserDetails.email&&$translate("VALID EMAIL ID").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})})}}function LogoutController($scope,$rootScope,$location,AuthenticationService,$state,$filter,toastr,$cookieStore){var user=AuthenticationService.GetCredentials();AuthenticationService.Logout(user).then(function(data){AuthenticationService.ClearCredentials(),$state.go("landing",{},{reload:!0})})}function LogoutController($scope,$rootScope,$location,AuthenticationService,$state,$filter,toastr,$cookieStore,$uibModal,$translate){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/common/views/logoff_confirmpage.html",controller:"LogoffconfirmModalInstanceCtrl",controllerAs:"LOCMI"});modalInstance.result.then(function(taskconfirmdata){if("true"==taskconfirmdata.statusvalue){var user=AuthenticationService.GetCredentials();AuthenticationService.Logout(user).then(function(data){AuthenticationService.ClearCredentials(),$state.go("landing",{},{reload:!0}),$translate("SUCCESSFULLY_LOGED_OFF").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})})}else $state.go("landing",{},{reload:!0})},function(){})}function LogoffconfirmModalInstanceCtrl($uibModalInstance,$state,sweet){var tocmi=this;tocmi.ok=function(){tocmi.statusvalue="true",$uibModalInstance.close(tocmi)},tocmi.cancel=function(){tocmi.statusvalue="false",$uibModalInstance.close(tocmi)}}function AuthenticationService($http,$cookieStore,$rootScope,toastr,$q,$cookies,Upload,socket,notify){var service={};return service.taskerLogin=function(username,password,callback){$http.post("/site/taskerlogin",{username:username,password:password}).success(function(response){callback(response)}).error(function(err){callback(err)})},service.userLogin=function(username,password,callback){$http.post("/site",{username:username,password:password}).success(function(response){callback(response)}).error(function(err){toastr.error("login error","Error")})},service.facebookuser=function(facebookdata){var deferred=$q.defer();return $http({method:"post",url:"/site/users/facebooksiteregister",data:{facebookdata:facebookdata}}).success(function(response){deferred.resolve(response)}).error(function(err){deferred.reject(err)}),deferred.promise},service.Register=function(value,callback){$http.post("/siteregister",value).success(function(response){callback(null,response)}).error(function(err){console.log(err),callback(err,null)})},service.checkreferal=function(referalcode){var deferred=$q.defer();return $http({method:"post",url:"/site/users/checkreferal",data:{referalcode:referalcode}}).success(function(response){deferred.resolve(response)}).error(function(err){deferred.reject(err)}),deferred.promise},service.checkemail=function(email){var deferred=$q.defer();return $http({method:"post",url:"/site/users/checkemail",data:{email:email}}).success(function(response){deferred.resolve(response)}).error(function(err){deferred.reject(err)}),deferred.promise},service.currentmsgcount=function(data){var deferred=$q.defer();return $http({method:"post",url:"/site/chat/msgcount",data:data}).success(function(response){deferred.resolve(response.count)}).error(function(err){deferred.reject(err)}),deferred.promise},service.unreadmsg=function(data){var deferred=$q.defer();return $http({method:"Post",url:"/site/chat/unreadmsg",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise},service.BecomeTaskerRegister=function(value,callback){if(value.files=[],value.taskerfile.length>0)for(var i=0;i<value.taskerfile.length;i++)delete value.taskerfile[i].$$hashKey,value.files.push(value.taskerfile[i]);$http({method:"post",url:"/site/users/taskerRegister",arrayKey:"",data:value}).success(function(response){callback(null,response)}).error(function(err){callback(err,null)})},service.facebook=function(){var deferred=$q.defer();return $http({method:"get",url:"/auth/facebook"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise},service.getMyLastName=function(){var deferred=$q.defer();return FB.api("/me",{fields:"last_name"},function(response){!response||response.error?deferred.reject("Error occured"):deferred.resolve(response)}),deferred.promise},service.google=function(){var deferred=$q.defer();return $http({method:"GET",url:"/auth/google"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise},service.Logout=function(currentuser){var deferred=$q.defer();return $http({method:"Post",url:"/site-logout",data:currentuser}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise},service.checktaskeremail=function(email){var deferred=$q.defer();return $http({method:"Post",url:"/site/users/checktaskeremail",data:{email:email}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise},service.SetCredentials=function(username,user_id,token,user_type,tasker_status){var authdata=token;$rootScope.siteglobals={currentUser:{username:username,user_id:user_id,authdata:authdata,user_type:user_type,tasker_status:tasker_status}},socket.emit("create room",{user:user_id}),notify.emit("join network",{user:user_id}),$http.defaults.headers.common.Authorization=authdata,$cookieStore.put("siteglobals",$rootScope.siteglobals),$rootScope.$emit("eventName",{count:0})},service.GetCredentials=function(){return $rootScope.siteglobals},service.isAuthenticated=function(){var cookieData=$cookieStore.get("siteglobals"),isAuthenticated=!1;return cookieData&&(isAuthenticated=!0),isAuthenticated},service.isTaskerAuthenticated=function(){var isAuthenticated=!1;return 0!=Object.keys($rootScope.siteglobals).length&&1==$rootScope.siteglobals.currentUser.tasker_status&&(isAuthenticated=!0),isAuthenticated},service.ClearCredentials=function(){$rootScope.siteglobals={},$cookieStore.remove("siteglobals"),$rootScope.$emit("eventName",{count:0})},service}function becomeTaskerCtrl($scope,$compile,uiCalendarConfig,$uibModal,$state,$cookieStore,CategoryserviceResolve,$filter,toastr,AuthenticationService,$rootScope,$location,accountService,$translate,NgMap,$timeout){function calculate_age(birth_month,birth_day,birth_year){console.log("ggg",birth_month,birth_day,birth_year);var today_date=new Date,today_year=today_date.getFullYear(),today_month=today_date.getMonth(),today_day=today_date.getDate(),age=today_year-birth_year;return today_month<birth_month-1&&age--,birth_month-1==today_month&&today_day<birth_day&&age--,console.log("age",age),age}var btc=this;$scope.oneAtATime=!0;var workingDays=[{day:"Sunday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Monday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Tuesday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Wednesday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Thursday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Friday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Saturday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0}],workingTimes={};workingTimes.morning={from:moment.tz(new Date(99,5,24,8,0,0,0),$scope.date.timezone).format($scope.date.time_format),to:moment.tz(new Date(99,5,24,12,0,0,0),$scope.date.timezone).format($scope.date.time_format)},workingTimes.afternoon={from:moment.tz(new Date(99,5,24,12,0,0,0),$scope.date.timezone).format($scope.date.time_format),to:moment.tz(new Date(99,5,24,16,0,0,0),$scope.date.timezone).format($scope.date.time_format)},workingTimes.evening={from:moment.tz(new Date(99,5,24,16,0,0,0),$scope.date.timezone).format($scope.date.time_format),to:moment.tz(new Date(99,5,24,20,0,0,0),$scope.date.timezone).format($scope.date.time_format)};var DaysData=[{Morning:"MORNING",afternoon:"AFTERNOON",evening:"EVENING",Save:"SAVE"}];btc.categoryList=CategoryserviceResolve,angular.forEach(btc.categoryList,function(parentvalue,parentIndex){angular.forEach(parentvalue.category,function(value,index){0==index?(value.active=!0,value.terms=!1,value.quick_pitch="",value.hour_rate="",value.experience=""):(value.active=!1,value.terms=!1,value.quick_pitch="",value.hour_rate="",value.experience=""),angular.forEach(value.skills,function(skills){skills.selected=!1})})}),btc.selectedcategory=[],btc.selectedcategory=btc.categoryList[0].category[0];var user=AuthenticationService.GetCredentials();$scope.avatar="",btc.data={gender:"",birthdate:{year:"",month:"",date:""},working_days:workingDays,avatar:"",next:"step2",taskerskills:[],Map:[]},btc.data=$cookieStore.get("TaskerData")||btc.data,btc.data.centerMap=btc.data.location,btc.WorkingDate?btc.WorkingDate=new Date(btc.WorkingDate):btc.WorkingDate=new Date,$scope.visibleValue=!1,$scope.myImage="",btc.myCroppedImage="",$scope.handleFileSelect=function(evt){$scope.visibleValue=!0;var file=evt.currentTarget.files[0],reader=new FileReader;reader.onload=function(evt){$scope.$apply(function($scope){$scope.myImage=evt.target.result})},reader.readAsDataURL(file)},angular.forEach(btc.data.taskerskills,function(taskerskills){angular.forEach(btc.categoryList,function(categoryList){taskerskills.categoryid==categoryList._id&&(categoryList.terms=taskerskills.terms,categoryList.quick_pitch=taskerskills.quick_pitch,categoryList.hour_rate=taskerskills.hour_rate,categoryList.experience=taskerskills.experience,angular.forEach(taskerskills.skills,function(taskerskillArr){angular.forEach(categoryList.skills,function(categoryskillArr){categoryskillArr.tags==taskerskillArr.tags&&(categoryskillArr.selected=!0)})}))})}),accountService.getExperience().then(function(respo){btc.experience=respo}),btc.placeChanged=function(){btc.data.address.line1="",btc.data.address.line2="",btc.data.address.city="",btc.data.address.state="",btc.data.address.country="",btc.data.address.zipcode="",btc.details={},btc.place=this.getPlace(),btc.data.tasker_area={},btc.data.tasker_area.lng=btc.place.geometry.location.lng(),btc.data.tasker_area.lat=btc.place.geometry.location.lat(),btc.details.location=btc.data.tasker_area,btc.data.address.line1=btc.place.formatted_address;var locationa=btc.place;locationa.name&&(btc.data.address.line1=locationa.name);for(var i=0;i<locationa.address_components.length;i++)for(var j=0;j<locationa.address_components[i].types.length;j++)"neighborhood"==locationa.address_components[i].types[j]&&btc.data.address.line1!=locationa.address_components[i].long_name&&(""!=btc.data.address.line1?btc.data.address.line1=btc.data.address.line1+","+locationa.address_components[i].long_name:btc.data.address.line1=locationa.address_components[i].long_name),"route"==locationa.address_components[i].types[j]&&btc.data.address.line1!=locationa.address_components[i].long_name&&(""!=btc.data.address.line2?btc.data.address.line2=btc.data.address.line2+","+locationa.address_components[i].long_name:btc.data.address.line2=locationa.address_components[i].long_name),"street_number"==locationa.address_components[i].types[j]&&(""!=btc.data.address.line2?btc.data.address.line2=btc.data.address.line2+","+locationa.address_components[i].long_name:btc.data.address.line2=locationa.address_components[i].long_name),"sublocality_level_1"==locationa.address_components[i].types[j]&&(""!=btc.data.address.line2?btc.data.address.line2=btc.data.address.line2+","+locationa.address_components[i].long_name:btc.data.address.line2=locationa.address_components[i].long_name),"locality"==locationa.address_components[i].types[j]&&(btc.data.address.city=locationa.address_components[i].long_name),"country"==locationa.address_components[i].types[j]&&(btc.data.address.country=locationa.address_components[i].long_name),"postal_code"==locationa.address_components[i].types[j]&&(btc.data.address.zipcode=locationa.address_components[i].long_name),"administrative_area_level_1"!=locationa.address_components[i].types[j]&&"administrative_area_level_2"!=locationa.address_components[i].types[j]||(btc.data.address.state=locationa.address_components[i].long_name);for(var componentForm={street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"short_name",country:"long_name",postal_code:"short_name"},i=0;i<locationa.address_components.length;i++){var addressType=locationa.address_components[i].types[0];if(componentForm[addressType]){var val=locationa.address_components[i][componentForm[addressType]];componentForm[addressType].value=val}}},btc.taskerareaChanged=function(){btc.place=this.getPlace(),btc.data.location={},btc.data.location.lng=btc.place.geometry.location.lng(),btc.data.location.lat=btc.place.geometry.location.lat(),btc.data.availability_address=btc.place.formatted_address;var locationa=btc.place,dummy=locationa.address_components.filter(function(value){return"locality"==value.types[0]}).map(function(data){return data});btc.dummyAddress=dummy.length},btc.filter={},btc.format="dd-MM-yyyy",btc.filterDate=function(){console.log("inside"),btc.data.birthdate.year=btc.WorkingDate.getFullYear(),btc.data.birthdate.month=btc.WorkingDate.getMonth()+1,btc.data.birthdate.date=btc.WorkingDate.getDate(),console.log("ggg",btc.data.birthdate.month,btc.data.birthdate.date,btc.data.birthdate.year),calculate_age(btc.data.birthdate.month,btc.data.birthdate.date,btc.data.birthdate.year)>18?(btc.data.birthdate.year=btc.WorkingDate.getFullYear(),btc.data.birthdate.month=btc.WorkingDate.getMonth()+1,btc.data.birthdate.date=btc.WorkingDate.getDate()):$translate("YOURS AGE SHOULD BE 18").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},btc.selectedCategory=function(parentindex,index){btc.selectedcategory=$filter("filter")(btc.categoryList[parentindex].category,{active:!0}),btc.selectedcategory[0].active=!1,btc.categoryList[parentindex].category[index].active=!0,btc.selectedcategory=btc.categoryList[parentindex].category[index],btc.flag=!1},btc.booleanValue=!1,btc.emailchange=function(email){void 0==email?$translate("INVALID EMAIL ID").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}):AuthenticationService.checktaskeremail(email).then(function(err,data){"Email Exist"==err.message?(btc.booleanValue=!0,$translate("SORRY EMAIL ID ALREADY EXIST").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})):"Email not exist"==err.message&&(btc.booleanValue=!1,$translate("VALID EMAIL ID").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}))})},btc.emptyLatLng=function(){btc.data.tasker_area=void 0},btc.SubmitinfoTasker=function(valid){valid?(btc.data.avatarBase64=btc.myCroppedImage,1==btc.booleanValue?$translate("SORRY EMAIL ID ALREADY EXIST").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}):"undefined"!=typeof btc.data.tasker_area&&"undefined"!=typeof btc.data.tasker_area.lat&&"undefined"!=typeof btc.data.tasker_area.lng?"undefined"!=typeof btc.data.phone&&"undefined"!=typeof btc.data.phone.code&&"undefined"!=typeof btc.data.phone.number?accountService.checkphoneno(btc.data.phone).then(function(response){response.length>0?$translate("Phone Number Already Existed!").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}):($cookieStore.put("TaskerData",btc.data),$state.go("becometasker."+btc.data.next,{},{reload:!1}))}):$translate("Phone Number is required!").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}):$translate("Invalid City").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})):$translate("PLEASE FILL ALL MANDATORY FIELDS").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},btc.data.location={},$scope.maps=[],btc.SubmitTasker=function(page,valid){console.log(valid),$scope.$on("mapInitialized",function(evt,evtMap){$scope.maps.push(evtMap)}),valid&&(btc.data.avatar=btc.myCroppedImage,btc.data.radius||(btc.data.radius=50),btc.taskerareaaddress||navigator.geolocation.getCurrentPosition(function(pos){
var latlng=new google.maps.LatLng(pos.coords.latitude,pos.coords.longitude),geocoder=geocoder=new google.maps.Geocoder;console.log("geocoder",geocoder),geocoder.geocode({latLng:latlng},function(results,status){console.log("results, status",results,status),status==google.maps.GeocoderStatus.OK&&results[1]&&$scope.$apply(function(){btc.data.availability_address=results[1].formatted_address,btc.taskerareaaddress=results[1].formatted_address,btc.temp_taskerareaaddress=btc.taskerareaaddress})}),btc.data.location.lng=pos.coords.longitude,btc.data.location.lat=pos.coords.latitude}),btc.data.avatar&&1!=page?(console.log("btc.data.avatar",btc.data.avatar),$cookieStore.put("TaskerData",btc.data),$state.go("becometasker."+btc.data.next,{},{reload:!1})):btc.data.birthdate.month&&btc.data.birthdate.date&&btc.data.birthdate.year?calculate_age(btc.data.birthdate.month,btc.data.birthdate.date,btc.data.birthdate.year)>12?($cookieStore.put("TaskerData",btc.data),$state.go("becometasker."+btc.data.next,{},{reload:!1})):$translate("YOURS AGE SHOULD BE 18").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}):toastr.error("please select age"))},btc.mapToInput=function(event){if($scope.maps[0]){btc.data.radius=parseInt($scope.maps[0].shapes.circle.radius/1e3);var lat=$scope.maps[0].shapes.circle.center.lat(),lng=$scope.maps[0].shapes.circle.center.lng(),latlng=new google.maps.LatLng(lat,lng),geocoder=geocoder=new google.maps.Geocoder;geocoder.geocode({latLng:latlng},function(results,status){"OK"==status&&$scope.$apply(function(){btc.place={},btc.data.availability_address=results[0].formatted_address,btc.taskerareaaddress=results[0].formatted_address,btc.temp_taskerareaaddress=btc.taskerareaaddress,btc.data.location={},btc.data.location.lng=lng,btc.data.location.lat=lat})})}},$scope.surveyFiles=[],btc.taskerData={},btc.taskerData.profile_details=[],btc.TaskerRegister=function(valid){btc.taskerData={},valid>0?(btc.taskerData=angular.copy(btc.data),btc.taskerData.taskerfile=[],btc.taskerData.taskerfile=$scope.surveyFiles,AuthenticationService.BecomeTaskerRegister(btc.taskerData,function(err,response){err?$translate("YOUR CREDENTIALS ARE WRONG"+err).then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}):(response.ok&&(AuthenticationService.SetCredentials(user.currentUser.username,user.currentUser.user_id,user.currentUser.authdata,"tasker",1),$rootScope.$emit("eventName",{count:0}),$cookieStore.remove("TaskerData"),$translate("TASKER ADDED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$location.path("/account")),response.errors?toastr.error(response.errors):($cookieStore.remove("TaskerData"),$state.go("becometasker.success",{},{reload:!1})))})):$translate("SELECT ATLEAST ONE OF THE SKILLS").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},btc.taskerskills=angular.copy(btc.data.taskerskills),btc.addskills=function(valid){if(valid){var skills=$filter("filter")(btc.selectedcategory.skills,{selected:!0});angular.forEach(skills,function(value){delete value.selected});var DefaultCurrency={};DefaultCurrency=$scope.DefaultCurrency;var data={categoryid:btc.selectedcategory.parent,childid:btc.selectedcategory._id,terms:btc.selectedcategory.terms,quick_pitch:btc.selectedcategory.quick_pitch,hour_rate:btc.selectedcategory.hour_rate/DefaultCurrency[0].value,experience:btc.selectedcategory.experience,file:btc.selectedcategory.file,skills:skills},insetflag=!0;angular.forEach(btc.taskerskills,function(value,key){value.childid==btc.selectedcategory._id&&(insetflag=!1,btc.taskerskills[key]=data)}),insetflag&&btc.taskerskills.push(data),btc.data.taskerskills=angular.copy(btc.taskerskills),$cookieStore.put("TaskerData",btc.data),$translate("SKILLS UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),btc.flag=!1}},btc.emptyLatLng=function(temp_taskerareaaddress){temp_taskerareaaddress!=btc.taskerareaaddress&&(btc.data.location="")},btc.SubmitTaskerlocation=function(valid,radiusvalue){if(btc.data.radius=radiusvalue,0==btc.data.working_days[6].not_working||0==btc.data.working_days[5].not_working||0==btc.data.working_days[4].not_working||0==btc.data.working_days[3].not_working||0==btc.data.working_days[2].not_working||0==btc.data.working_days[1].not_working||0==btc.data.working_days[0].not_working)if(calculate_age(btc.data.birthdate.month,btc.data.birthdate.date,btc.data.birthdate.year)>12){if(""==btc.data.location)return void $translate("INVALID WORK LOCATION").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)});$cookieStore.put("TaskerData",btc.data),$state.go("becometasker."+btc.data.next,{},{reload:!1})}else $translate("YOURS AGE SHOULD BE 18").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)});else $translate("PLEASE SELECT YOUR WORKING DAYS").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},btc.availabilitiesModelOpen=function(size,index){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/tasker/views/availabilitypop.modal.tab.html",controller:"ModalInstanceWorkingDayCtrl",size:size,resolve:{WorkingDays:function(){return btc.data.working_days},workingTimes:function(){return workingTimes},DaysData:function(){return DaysData},selectedIndex:function(){return index}}});modalInstance.result.then(function(WorkingDays,selectedIndex){btc.data.working_days[selectedIndex]=WorkingDays},function(){})},accountService.getCategories().then(function(respo){btc.categories=respo}),accountService.getExperience().then(function(respo){btc.experiences=respo}),btc.data.taskerskills=[],btc.selectedCat=[],btc.categoryModal=function(category){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/tasker/views/addcategory.model.tab.html",controller:"ModalInstancecategory",controllerAs:"ACM",resolve:{experiences:function(){return btc.experiences},defaultcurrency:function(){return $scope.DefaultCurrency},user:function(){return btc.data},selectedCat:function(){return btc.selectedCat},categories:function(){return btc.categories},category:function(){return category}}});modalInstance.result.then(function(selectedCategoryData){var mode=selectedCategoryData.mode;if(delete selectedCategoryData.mode,"Add"==mode)btc.taskerskills.push(selectedCategoryData),btc.selectedCat.push(selectedCategoryData.childid);else for(var i=0;i<btc.taskerskills.length;i++)btc.taskerskills[i].childid==selectedCategoryData.childid&&(btc.taskerskills[i]=selectedCategoryData);btc.data.taskerskills=btc.taskerskills,btc.addnewcategories=btc.categories.filter(function(data){return btc.data.taskerskills.some(function(data2){return data2.childid==data._id})}).map(function(mapdata){return mapdata})},function(){})},btc.deletecategoryitem=function(data){var indexx=btc.selectedCat.indexOf(data);btc.selectedCat.splice(indexx,1),angular.forEach(btc.addnewcategories,function(value,key){value._id==data&&btc.addnewcategories.splice(key,1)}),angular.forEach(btc.data.taskerskills,function(value,key){value.childid==data&&btc.taskerskills.splice(key,1)})}}function contactCtrl($scope,ContactService,$rootScope,$location,$filter,$state,toastr,$translate){var cttc=this;cttc.Messagedetails={},cttc.userMessage=function(isValid,formData){isValid&&void 0!=cttc.Messagedetails.mobile?(console.log("cttc.Messagedetails.mobile",cttc.Messagedetails.mobile),cttc.Messagedetails.mobile=cttc.Messagedetails.mobile.code+"-"+cttc.Messagedetails.mobile.number,ContactService.savemessage(cttc.Messagedetails).then(function(response){$translate("WELL GET IN TOUCH WITH YOU SHORTLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$state.go("landing")},function(err){err.msg?toastr.error("danger",err.msg):$translate("WELL GET IN TOUCH WITH YOU SHORTLY").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})):$translate("PLEASE ENTER THE VALID DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},cttc.subscription=function(data){}}function ContactService($http,$q){function savemessage(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/contact/savecontactusmessage",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}var ContactService={savemessage:savemessage};return ContactService}function categoryCtrl($scope,$rootScope,$location,$stateParams,CategoryserviceResolve,CategoryService,$state,$translate,ngMeta){var cac=this;cac.data=CategoryserviceResolve,cac.itemsPerPage=6,cac.currentPage=1,cac.totalItems=0,cac.categoryDatails=cac.data.response.ActiveCategory.parentcategory,cac.subcategory=cac.data.response.ActiveCategory.subcategory,cac.totalItems=cac.data.response.ActiveCategory.totalsubcategory,cac.categoryDatails.name&&ngMeta.setTitle(cac.categoryDatails.name),cac.getSubcategoryResponse=!0,cac.getSubcategory=function(){cac.subcategory=[],angular.isDefined(cac.categoryDatails._id)&&(cac.getSubcategoryResponse=!1,CategoryService.getcategory(cac.categoryDatails.slug,cac.currentPage,cac.itemsPerPage).then(function(data){data.response.ActiveCategory.subcategory.length>0&&(cac.subcategory=data.response.ActiveCategory.subcategory,cac.totalItems=data.response.ActiveCategory.totalsubcategory)},function(error){}))}}function CategoryService($http,$q){function getcategory(data,page,itemsPerPage){var skip=0;if(page>1)var skip=(parseInt(page)-1)*itemsPerPage;var deferred=$q.defer();return $http({method:"POST",url:"/site/category/getcategory",data:{slug:data,skip:skip,itemsCount:itemsPerPage}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getcategoryList(data,page,itemsPerPage){var deferred=$q.defer();return $http({method:"GET",url:"/site/category/getCategoryList"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}var categoryService={getcategory:getcategory,getcategoryList:getcategoryList};return categoryService}function taskCtrl($scope,$rootScope,$location,$stateParams,$uibModal,TaskService,TaskserviceResolve,toastr,$state,AuthenticationService,CurrentUserTaskserviceResolve,MainService,$translate,ngMeta){var tac=this,user=AuthenticationService.GetCredentials();if(tac.taskbaseinfo={},$scope.location={},tac.filter={},tac.filter.location={lat:"",lng:""},tac.availability=2,tac.taskbaseinfo.address={},tac.addressList=[],TaskserviceResolve[0].SubCategoryInfo.name&&ngMeta.setTitle(TaskserviceResolve[0].SubCategoryInfo.name),CurrentUserTaskserviceResolve[0])if(CurrentUserTaskserviceResolve[0].addressList.length>0)if(CurrentUserTaskserviceResolve[0]){tac.currentuserid=CurrentUserTaskserviceResolve[0]._id,tac.addressList=CurrentUserTaskserviceResolve[0].addressList;var addlist=tac.addressList.filter(function(el){return 3==el.status});addlist.length>0?tac.filter.address=addlist[0]._id:CurrentUserTaskserviceResolve[0].addressList[0]&&(tac.filter.address=CurrentUserTaskserviceResolve[0].addressList[0]._id)}else tac.currentuserid="";else CurrentUserTaskserviceResolve[0]?(tac.currentuserid=CurrentUserTaskserviceResolve[0]._id,tac.addressList=CurrentUserTaskserviceResolve[0].addressList,tac.filter.address=""):tac.currentuserid="";TaskserviceResolve.length>0?tac.taskbaseinfo.SubCategoryInfo=TaskserviceResolve[0].SubCategoryInfo:($translate("WE ARE LOOKING FOR THIS TROUBLE SORRY UNABLE TO FETCH DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}),$state.go("landing",{},{reload:!1})),tac.changeCategory=function(category){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/task-step/views/change-category.html",controller:"changeCategoryModalInstanceCtrl",controllerAs:"CCM"});modalInstance.result.then(function(selectedCategoryData){$state.go("landing",{},{reload:!1})},function(){})},tac.placeChanged=function(){if(console.log("placechanged"),tac.filter.address){var address=tac.addressList.filter(function(el){return el._id==tac.filter.address});address.length>0?tac.filter.location=address[0].location:CurrentUserTaskserviceResolve[0].addressList[0]&&(tac.filter.location=CurrentUserTaskserviceResolve[0].addressList[0].location),TaskService.checktaskeravailability(tac.filter.location,tac.taskbaseinfo.SubCategoryInfo._id).then(function(response){angular.isDefined(response)&&(response.count>0?tac.availability=1:tac.availability=0)},function(error){tac.availability=0})}},tac.addressInfo=function(data){TaskService.address(data).then(function(result){})},tac.deleteaddress=function(index){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/task-step/views/delete-confirm-model.html",controller:"DeleteAddress",controllerAs:"DATA",resolve:{user:function(){return tac.user}}});modalInstance.result.then(function(userid){TaskService.deleteaddress({userid:user.currentUser.user_id,id:index}).then(function(response){MainService.getCurrentUsers(user.currentUser.username).then(function(refdata){tac.addressList=refdata[0].addressList})})})},tac.addressStatus=function(id){TaskService.addressStatus(id,user.currentUser.user_id).then(function(response){MainService.getCurrentUsers(user.currentUser.username).then(function(refdata){tac.addressList=refdata[0].addressList})}),$translate("PREFERRED ADDRESS ADDED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})},tac.Editaddress=function(index){if(index>=0){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/task-step/views/addaddressmodel.html",controller:"AddAddress",controllerAs:"ATA",resolve:{user:function(){return angular.copy(tac.addressList[index])}}});modalInstance.result.then(function(data){""!=data.addressList.location.lat&&"undefined"!=data.addressList.location.lan?TaskService.AddAddress(user.currentUser.user_id,data).then(function(response){$translate("ADDRESS ADDED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),MainService.getCurrentUsers(user.currentUser.username).then(function(refdata){tac.addressList=refdata[0].addressList})}):$translate("PLEASE ENTER VALID LOCATION").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})}else MainService.getCurrentUsers(user.currentUser.username).then(function(refdata){if(refdata[0].addressList.length<5){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/task-step/views/addaddressmodel.html",controller:"AddAddress",controllerAs:"ATA",resolve:{user:function(){return tac.addressList[index]}}});modalInstance.result.then(function(data){""!=data.addressList.location.lat&&"undefined"!=data.addressList.location.lan?TaskService.AddAddress(user.currentUser.user_id,data).then(function(response){0==response.status?$translate("ADDRESS ALREADY ON YOUR LIST").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}):($translate("ADDRESS ADDED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),MainService.getCurrentUsers(user.currentUser.username).then(function(refdata){tac.addressList=refdata[0].addressList}))}):$translate("PLEASE ENTER VALID LOCATION").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})}else $translate("SORRY MORE THAN 5 ADDRESS COULD NOT BE ADDED").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})},tac.SearchTasker=function(taskavailable,valid){if(console.log("sdfsdfsdfsdfsdfsdf",taskavailable),0==taskavailable)$translate("THE TASKER IS UN AVILABLE ON SELECTED ADDRESS").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)});else if(1==valid){var address=tac.addressList.filter(function(el){return el._id==tac.filter.address});if(tac.temporaryAddress=address,console.log("address",address),address[0]){tac.filter.location=address[0].location;var data={};data.categoryid=tac.taskbaseinfo.SubCategoryInfo._id,data.address=tac.taskbaseinfo.address.line1,console.log("CurrentUserTaskserviceResolve[0].address",CurrentUserTaskserviceResolve[0].address),CurrentUserTaskserviceResolve[0].address?data.billing_address={zipcode:CurrentUserTaskserviceResolve[0].address.zipcode||"",country:CurrentUserTaskserviceResolve[0].address.country||"",state:CurrentUserTaskserviceResolve[0].address.state||"",city:CurrentUserTaskserviceResolve[0].address.city||"",line2:CurrentUserTaskserviceResolve[0].address.line2||"",line1:CurrentUserTaskserviceResolve[0].address.line1||""}:data.billing_address={zipcode:address[0].zipcode||"",country:address[0].country||"",state:address[0].state||"",city:address[0].city||"",line2:address[0].street||"",line1:address[0].line1||""},data.userid=tac.currentuserid,data.categoryid=tac.taskbaseinfo.SubCategoryInfo._id,data.task_description=tac.filter.about,data.location={lat:tac.filter.location.lat,log:tac.filter.location.lng},data.task_address={zipcode:address[0].zipcode||"",country:address[0].country||"",state:address[0].state||"",city:address[0].city||"",landmark:address[0].landmark||"",line2:address[0].street||"",line1:address[0].line1||"",lat:address[0].location.lat||"",lng:address[0].location.lng||""},TaskService.addtask(data).then(function(result){console.log("result--",result),tac.booking_id=result.booking_id;var option={slug:tac.taskbaseinfo.SubCategoryInfo.slug,task:result._id};$state.go("search",option,{reload:!1})},function(error){toastr.error(error)})}else toastr.error("Click on the address to check provider availability and proceed")}}}function taskProfileCtrl($scope,$rootScope,$location,$stateParams,$uibModal,TaskService,TaskProfileResolve,toastr,$state,$translate){var tpc=this;if(angular.isDefined($stateParams.taskerId)&&(tpc.taskerId=$stateParams.taskerId),angular.isDefined($stateParams.slug)&&(tpc.cate=$stateParams.slug),tpc.taskDetailInfo={},tpc.availableSymbal=!1,TaskProfileResolve){if(TaskProfileResolve.location){var latlng=new google.maps.LatLng(TaskProfileResolve.location.lat,TaskProfileResolve.location.lng),geocoder=geocoder=new google.maps.Geocoder;geocoder.geocode({latLng:latlng},function(results,status){status==google.maps.GeocoderStatus.OK&&results[1]&&(TaskProfileResolve.availability_address?TaskProfileResolve.availability_address=TaskProfileResolve.availability_address:TaskProfileResolve.availability_address=results[1].formatted_address)})}tpc.taskDetailInfo=TaskProfileResolve,0==tpc.taskDetailInfo.availability?(tpc.availabilityValue="Tasker is Unavailable",tpc.availableSymbal=!1):(tpc.availabilityValue="Tasker is Available",tpc.availableSymbal=!0),tpc.questionValue="Tasker has not provided any details",tpc.answerValue="Answer is Unavailable",tpc.taskDetailInfo.profile_details[0]&&(tpc.taskDetailInfo.profile_details[0].answer&&(tpc.checkVAlue=1,tpc.answerValue=tpc.taskDetailInfo.profile_details),tpc.taskDetailInfo.profile_details[0].question&&(tpc.questionValue=tpc.taskDetailInfo.profile_details))}else $translate("WE ARE LOOKING FOR THIS TROUBLE SORRY UNABLE TO FETCH DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}),$state.go("landing");TaskService.taskerreviews(tpc.taskerId).then(function(response){response[0]&&(tpc.taskprofile=response[0],console.log("tpc.taskprofile",tpc.taskprofile),tpc.taskertempid=tpc.taskprofile[0]._id,tpc.profilelength=tpc.taskprofile.length,tpc.overallRating=0,angular.forEach(tpc.taskprofile,function(value,key){value.rate&&(tpc.overallRating=tpc.overallRating+value.rate.rating)}),tpc.overallrate=tpc.overallRating/tpc.profilelength,tpc.taskprofile[0].createdAt&&(tpc.convertdate=new Date(tpc.taskprofile[0].createdAt)),tpc.dateConversion=tpc.convertdate.getFullYear(),tpc.induvidualrating=parseInt(response[1]),TaskProfileResolve.taskerskills&&angular.forEach(TaskProfileResolve.taskerskills,function(value1,key1){value1.childid==$stateParams.sub_id&&(tpc.experience=value1.experience.name)}))},function(err){toastr.error(err)})}function taskFilterCtrl($scope,$rootScope,$location,$stateParams,SearchResolve,TaskService,TaskserviceResolve,toastr,$state,$filter,AuthenticationService,$modal,MainService,TaskServiceNewResolve,$translate,ngMeta,TaskerCountResolve,NgMap,$scope,$q,$log){var tfc=this;tfc.viewType="list";var option={};tfc.search=SearchResolve,tfc.taskinfo=TaskServiceNewResolve,tfc.page=TaskerCountResolve.count,TaskserviceResolve[0].categorydetails&&TaskserviceResolve[0].categorydetails.marker&&(tfc.marker=TaskserviceResolve[0].categorydetails.marker),TaskserviceResolve[0].SubCategoryInfo.name&&ngMeta.setTitle(TaskserviceResolve[0].SubCategoryInfo.name);var user=AuthenticationService.GetCredentials();MainService.getCurrentUsers(user.currentUser.username).then(function(result){tfc.currentUserData=result[0]},function(error){$translate("INIT CURRENT DATA ERROR").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}),MainService.getDefaultCurrency().then(function(response){tfc.DefaultCurrency=response});var stateParams=angular.copy($rootScope.currentparams);angular.isDefined(stateParams.categoryid)&&(option.category=stateParams.category),angular.isDefined(stateParams.task)&&(option.task=stateParams.task),tfc.filter=option,tfc.taskbaseinfo={},tfc.currentPage=1,tfc.itemsPerPage=6,tfc.totalItem=tfc.page,tfc.format="MM/dd/yyyy",tfc.logincheck=AuthenticationService.isAuthenticated(),TaskserviceResolve.length>0?tfc.taskbaseinfo.SubCategoryInfo=TaskserviceResolve[0].SubCategoryInfo:($translate("WE ARE LOOKING FOR THIS TROUBLE SORRY UNABLE TO FETCH DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}),$state.go("landing",{},{reload:!1})),angular.isDefined(tfc.filter.date)&&""!=tfc.filter.date?(tfc.WorkingDate=new Date(tfc.filter.date),"Invalid Date"==tfc.WorkingDate&&(tfc.WorkingDate=new Date)):tfc.WorkingDate=new Date,tfc.FullDate=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],tfc.filter.day=tfc.FullDate[tfc.WorkingDate.getDay()],tfc.filter.date=$filter("date")(tfc.WorkingDate,tfc.format,""),tfc.hours={morning:!1,afternoon:!1,evening:!1},angular.isDefined(tfc.filter.hour)?"morning"==tfc.filter.hour?tfc.hours.morning=!0:"afternoon"==tfc.filter.hour?tfc.hours.afternoon=!0:"evening"==tfc.filter.hour?tfc.hours.evening=!0:(tfc.filter.hour="morning",tfc.hours.morning=!0):(tfc.filter.hour="morning",tfc.hours.morning=!0),tfc.teskerErrorMsg=function(){toastr.error("Own task can't continue")},tfc.filter.categoryid=tfc.taskbaseinfo.SubCategoryInfo._id,tfc.getTaskerDetailsResponse=!1,tfc.search.minRate==tfc.search.maxRate?(tfc.min=tfc.filter.minvalue=tfc.search.minRate||0,tfc.max=tfc.filter.maxvalue=tfc.min+200):(tfc.min=tfc.filter.minvalue=tfc.search.minRate||0,tfc.max=tfc.filter.maxvalue=tfc.search.maxRate||500),tfc.search.kmminRate==tfc.search.kmmaxRate?(tfc.kmmin=0,tfc.kmmax=100):(tfc.kmmin=0,tfc.kmmax=100),tfc.UIslide=[tfc.min,tfc.max],tfc.UIkmslide=[tfc.kmmin,tfc.kmmax],$scope.$watchCollection("DefaultCurrency",function(newNames,oldNames){tfc.min=tfc.min.toFixed(2),tfc.max=tfc.max.toFixed(2)}),tfc.changeViewType=function(type){tfc.viewType=type,tfc.getTaskerDetails(),NgMap.getMap().then(function(map){$scope.map=map})},tfc.getTaskerDetails=function(){tfc.UIslide&&(tfc.filter.minvalue=tfc.UIslide[0],tfc.filter.maxvalue=tfc.UIslide[1]),tfc.UIkmslide&&(tfc.filter.kmminvalue=tfc.UIkmslide[0],tfc.filter.kmmaxvalue=tfc.UIkmslide[1]),tfc.TaskerDetails=[],tfc.getTaskerDetailsResponse=!1,tfc.dummyarrayValue=[],"search"!=$rootScope.currentState.name?$state.go($rootScope.currentState,$rootScope.currentparams,{reload:!1,inherit:!0,notify:!0}):"list"==tfc.viewType?TaskService.getTaskerByGeoFilter(tfc.filter,tfc.currentPage,tfc.itemsPerPage).then(function(response){angular.isDefined(response.countall)&&(tfc.totalItem=response.countall),angular.isDefined(response.result)&&(tfc.TaskerDetails=response.result,angular.forEach(tfc.TaskerDetails,function(value,key){angular.forEach(value.taskerskills,function(value1,key1){value1.childid==tfc.filter.categoryid&&tfc.dummyarrayValue.push(value1)})})),angular.isDefined(response.avgrating)&&(tfc.avgtasker=response.avgrating),angular.isDefined(response.taskercount)&&(tfc.taskercount=response.taskercount),angular.forEach(tfc.TaskerDetails,function(value,key){angular.forEach(tfc.avgtasker,function(value1,key1){value._id==value1._id&&(tfc.TaskerDetails[key].avarating=parseInt(value1.avg),tfc.TaskerDetails[key].taskCount=parseInt(value1.datacount),tfc.TaskerDetails[key].recentReview=value1.documentData[value1.documentData.length-1],value1.documentData[value1.documentData.length-1].userdetails.avatar&&(tfc.TaskerDetails[key].userAvater=value1.documentData[value1.documentData.length-1].userdetails.avatar))})}),angular.forEach(tfc.TaskerDetails,function(value,key){angular.forEach(tfc.taskercount,function(value1,key1){value._id==value1._id&&(tfc.TaskerDetails[key].taskercount=value1.induvidualcount)})}),tfc.getTaskerDetailsResponse=!0},function(error){}):TaskService.getTaskerByGeoFiltermap(tfc.filter,tfc.currentPage,tfc.itemsPerPage).then(function(response){angular.isDefined(response.result)&&(tfc.TaskerDetails=response.result,angular.forEach(tfc.TaskerDetails,function(value,key){angular.forEach(value.taskerskills,function(value1,key1){value1.childid==tfc.filter.categoryid&&tfc.dummyarrayValue.push(value1)})}),$scope.lat=tfc.taskinfo.location.lat,$scope.lng=tfc.taskinfo.location.lng,$scope.markerData=[],$scope.cityMetaData=[],$scope.getCityInfo=function(){for(var TaskerData=[],i=0;i<tfc.TaskerDetails.length;i++){tfc.TaskerDetails[i];TaskerData.push({id:i,cityName:tfc.TaskerDetails[i].address.line1+","+tfc.TaskerDetails[i].address.state+","+tfc.TaskerDetails[i].address.country,TaskerName:tfc.TaskerDetails[i],icon:tfc.TaskerDetails[i].avatar})}TaskerData.forEach(function(item){var cityData=item;$scope.cityMetaData.push(cityData),tfc.addressMarker(cityData)})},tfc.addressMarker=function(cityItem){var address=($q.defer(),cityItem.TaskerName.availability_address),geocoder=new google.maps.Geocoder;geocoder.geocode({address:address},function(results,status){status==google.maps.GeocoderStatus.OK?$scope.$apply(function(){$scope.markerData.push({id:cityItem.id,latitude:results[0].geometry.location.lat(),longitude:results[0].geometry.location.lng(),title:results[0].formatted_address,tasker:cityItem.TaskerName,icon:cityItem.icon,avatar:cityItem.TaskerName.avatar,position:[results[0].geometry.location.lat(),results[0].geometry.location.lng()]})}):$log.info("Geocode was not successful for the following reason:"+status)})},$scope.getCityInfo(),tfc.showCity=function(event,cityItem){$scope.selectedCity=cityItem,$scope.map.showInfoWindow("myInfoWindow","m"+cityItem.id)}),angular.isDefined(response.avgrating)&&(tfc.avgtasker=response.avgrating),angular.isDefined(response.taskercount)&&(tfc.taskercount=response.taskercount),angular.forEach(tfc.TaskerDetails,function(value,key){angular.forEach(tfc.avgtasker,function(value1,key1){value._id==value1._id&&(tfc.TaskerDetails[key].avarating=parseInt(value1.avg),tfc.TaskerDetails[key].taskCount=parseInt(value1.datacount),tfc.TaskerDetails[key].recentReview=value1.documentData[value1.documentData.length-1],value1.documentData[value1.documentData.length-1].userdetails.avatar&&(tfc.TaskerDetails[key].userAvater=value1.documentData[value1.documentData.length-1].userdetails.avatar))})}),angular.forEach(tfc.TaskerDetails,function(value,key){angular.forEach(tfc.taskercount,function(value1,key1){value._id==value1._id&&(tfc.TaskerDetails[key].taskercount=value1.induvidualcount)})}),tfc.getTaskerDetailsResponse=!0},function(error){})},tfc.timinglist=[{value:"morning",time:"8AM - 9AM",data:"08:00"},{value:"morning",time:"9AM - 10AM",data:"09:00"},{value:"morning",time:"10AM - 11AM",data:"10:00"},{value:"morning",time:"11AM - 12PM",data:"11:00"},{value:"afternoon",time:"12PM - 1PM",data:"12:00"},{value:"afternoon",time:"1PM - 2PM",data:"13:00"},{value:"afternoon",time:"2PM - 3PM",data:"14:00"},{value:"afternoon",time:"3PM - 4PM",data:"15:00"},{value:"evening",time:"4PM - 5PM",data:"16:00"},{value:"evening",time:"5PM - 6PM",data:"17:00"},{value:"evening",time:"6PM - 7PM",data:"18:00"},{value:"evening",time:"7PM - 8PM",data:"19:00"}],tfc.filterDate=function(){if(tfc.filter.day=tfc.FullDate[tfc.WorkingDate.getDay()],tfc.filter.date=$filter("date")(tfc.WorkingDate,tfc.format,""),tfc.timeValue=new Date,tfc.ttvalue=tfc.timeValue.getHours(),tfc.thisMonth=tfc.timeValue.getMonth(),tfc.thisDate=tfc.timeValue.getDate(),tfc.timeDisabledValue=tfc.ttvalue+":00",tfc.selectedDate=tfc.WorkingDate.getDate(),tfc.selectedMonth=tfc.WorkingDate.getMonth(),tfc.filterTiming="",tfc.selectedDate==tfc.thisDate)if(tfc.selectedMonth==tfc.thisMonth){tfc.filterTiming=[];for(var i=0;i<tfc.timinglist.length;i++)tfc.timinglist[i].data>tfc.timeDisabledValue&&tfc.filterTiming.push(tfc.timinglist[i])}else tfc.filterTiming=tfc.timinglist;else tfc.filterTiming=tfc.timinglist;tfc.filterTiming.length?tfc.dafaulttime=tfc.filterTiming[0].data:(tfc.WorkingDate.setDate(tfc.WorkingDate.getDate()+1),tfc.filterTiming=tfc.timinglist,tfc.dafaulttime=tfc.filterTiming[0].data),tfc.hourfilter(tfc.dafaulttime)},tfc.hourfilter=function(hour){tfc.filter.time=hour,"08:00"==hour||"09:00"==hour||"10:00"==hour||"11:00"==hour?value="morning":"12:00"==hour||"13:00"==hour||"14:00"==hour||"15:00"==hour?value="afternoon":"16:00"!=hour&&"17:00"!=hour&&"18:00"!=hour&&"19:00"!=hour||(value="evening");for(var i in tfc.hours)value!=i?tfc.hours[i]=!1:tfc.hours[i]=!0;tfc.filter.hour!=value&&(tfc.filter.hour=value,tfc.filter.time=hour),tfc.getTaskerDetails()},tfc.registermodal=function(category){var modalInstance=$modal.open({animation:!0,templateUrl:"app/site/modules/task-step/views/register.modal.tab.html",controller:"RegisterModalInstanceCtrl",controllerAs:"RCM"});modalInstance.result.then(function(userinfo){},function(){})},tfc.confirmatask=function(message){var date={};date.currectdate=tfc.filter.date,date.time=tfc.filter.time,tfc.taskinfo.tasker=message.tasker._id,tfc.taskinfo.invoice={amount:{minimum_cost:tfc.taskinfo.category.commision,task_cost:tfc.taskinfo.category.commision,total:tfc.taskinfo.category.commision,grand_total:tfc.taskinfo.category.commision}},tfc.taskinfo.booking_information={service_type:tfc.taskinfo.category.name,work_type:tfc.taskinfo.category.name,work_id:tfc.taskinfo.category._id,instruction:tfc.taskinfo.task_description,booking_date:"",reach_date:"",est_reach_date:"",location:tfc.taskinfo.billing_address.line1+","+tfc.taskinfo.billing_address.line2+","+tfc.taskinfo.billing_address.city+","+tfc.taskinfo.billing_address.state+","+tfc.taskinfo.billing_address.country+","+tfc.taskinfo.billing_address.zipcode},tfc.taskinfo.history={},tfc.taskinfo.history.job_booking_time=new Date,tfc.taskinfo.history.est_reach_date="",tfc.taskinfo.status=1,angular.forEach(message.tasker.taskerskills,function(value,key){value.childid==tfc.taskinfo.category._id&&(tfc.hour_rate=value.hour_rate)}),tfc.taskinfo.hourly_rate=tfc.hour_rate||"";new Date;tfc.taskinfo.task_hour=tfc.filter.hour,tfc.filter.time?TaskService.confirmtask(tfc.taskinfo,date).then(function(result){console.log("result result",result),$translate("REQUEST HAS BEEN SENT TO TASKER SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$state.go("landing",{reload:!1})},function(error){toastr.error(error)}):$translate("CHOOSE YOUR TASK TIME").then(function(headline){
toastr.info(headline)},function(translationId){toastr.error(headline)})}}function TaskService($http,$q){function taskbaseinfo(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/taskbaseinfo/",data:{slug:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getaddressdata(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/getaddressdata/",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getuserdata(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/getuserdata/",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function deleteaddress(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/deleteaddress/",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function AddAddress(userid,data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/addaddress/",data:{userid:userid,data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function taskerreviews(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/taskerreviews",data:{slug:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function taskprofileinfo(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/taskprofileinfo",data:{slug:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function checktaskeravailability(location,categoryId){var url="/site/task/taskerAvailabilitybyWorkingAreaCount?lat="+location.lat+"&lon="+location.lng+"&categoryid="+categoryId,deferred=$q.defer();return $http({method:"GET",url:url}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function gettaskuser(filter){var url="/site/task/gettaskuser",deferred=$q.defer();return $http({method:"POST",url:url,data:{user:filter.tasker,categoryid:filter.categoryid,hour:filter.hour,day:filter.day,loginUser:filter.loginUser,vehicle:filter.vechile}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getTaskerByGeoFilter(filter,page,itemsPerPage){var url="",categoryid="",taskid="",date="";angular.isDefined(filter.date)&&(date=filter.date);var time="";angular.isDefined(filter.time)&&(time=filter.time),angular.isDefined(filter.categoryid)&&(categoryid=filter.categoryid),angular.isDefined(filter.task)&&(taskid=filter.task);var vechile="";angular.isDefined(filter.vechile)&&(vechile=filter.vechile);var lon="";angular.isDefined(filter.lon)&&(lon=filter.lon);var lat="";angular.isDefined(filter.lat)&&(lat=filter.lat);var day="";angular.isDefined(filter.day)&&(day=filter.day);var hour="";angular.isDefined(filter.hour)&&(hour=filter.hour);var minvalue="";angular.isDefined(filter.minvalue)&&(minvalue=filter.minvalue);var maxvalue="";angular.isDefined(filter.maxvalue)&&(maxvalue=filter.maxvalue);var kmminvalue="";angular.isDefined(filter.kmminvalue)&&(kmminvalue=filter.kmminvalue);var kmmaxvalue="";if(angular.isDefined(filter.kmmaxvalue)&&(kmmaxvalue=filter.kmmaxvalue),page){var skip=(parseInt(page)-1)*itemsPerPage;url="/site/task/taskeravailabilitybyWorkingArea?page="+page+"&skip="+skip+"&limit="+itemsPerPage+"&vechile="+vechile+"&categoryid="+categoryid+"&day="+day+"&hour="+hour+"&time="+time+"&task="+taskid+"&date="+date+"&minvalue="+minvalue+"&maxvalue="+maxvalue+"&kmminvalue="+kmminvalue+"&kmmaxvalue="+kmmaxvalue}else url="/site/task/taskeravailabilitybyWorkingArea?page=0&skip=0&limit="+itemsPerPage+"&vechile="+vechile+"&categoryid="+categoryid+"&day="+day+"&hour="+hour+"&time="+time+"&task="+taskid+"&date="+date+"&minvalue="+minvalue+"&maxvalue="+maxvalue+"&kmminvalue="+kmminvalue+"&kmmaxvalue="+kmmaxvalue;var deferred=$q.defer(),result=1;if(1==result)return $http({method:"GET",url:url}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),result=2,deferred.promise}function getTaskerByGeoFiltermap(filter,page,itemsPerPage){var url="",categoryid="",taskid="",date="";angular.isDefined(filter.date)&&(date=filter.date);var time="";angular.isDefined(filter.time)&&(time=filter.time),angular.isDefined(filter.categoryid)&&(categoryid=filter.categoryid),angular.isDefined(filter.task)&&(taskid=filter.task);var vechile="";angular.isDefined(filter.vechile)&&(vechile=filter.vechile);var lon="";angular.isDefined(filter.lon)&&(lon=filter.lon);var lat="";angular.isDefined(filter.lat)&&(lat=filter.lat);var day="";angular.isDefined(filter.day)&&(day=filter.day);var hour="";angular.isDefined(filter.hour)&&(hour=filter.hour);var minvalue="";angular.isDefined(filter.minvalue)&&(minvalue=filter.minvalue);var maxvalue="";angular.isDefined(filter.maxvalue)&&(maxvalue=filter.maxvalue);var kmminvalue="";angular.isDefined(filter.kmminvalue)&&(kmminvalue=filter.kmminvalue);var kmmaxvalue="";if(angular.isDefined(filter.kmmaxvalue)&&(kmmaxvalue=filter.kmmaxvalue),page){var skip=(parseInt(page)-1)*itemsPerPage;url="/site/task/taskeravailabilitybyWorkingAreaMap?page="+page+"&skip="+skip+"&limit="+itemsPerPage+"&vechile="+vechile+"&categoryid="+categoryid+"&day="+day+"&hour="+hour+"&time="+time+"&task="+taskid+"&date="+date+"&minvalue="+minvalue+"&maxvalue="+maxvalue+"&kmminvalue="+kmminvalue+"&kmmaxvalue="+kmmaxvalue}else url="/site/task/taskeravailabilitybyWorkingAreaMap?page="+page+"&skip=0&limit="+itemsPerPage+"&vechile="+vechile+"&categoryid="+categoryid+"&day="+day+"&hour="+hour+"&time="+time+"&task="+taskid+"&date="+date+"&minvalue="+minvalue+"&maxvalue="+maxvalue+"&kmminvalue="+kmminvalue+"&kmmaxvalue="+kmmaxvalue;var deferred=$q.defer(),result=1;if(1==result)return $http({method:"GET",url:url}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),result=2,deferred.promise}function saveuser(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/saveuser",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function addtask(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/addnewtask",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getTaskDetailsbyid(id){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/gettaskdetailsbyid",data:{id:id}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function confirmtask(data,time){var sendData={data:data,time:time},deferred=$q.defer();return $http({method:"POST",url:"/site/task/confirmtask",data:sendData}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function addressStatus(add_id,userid){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/addressStatus",data:{add_id:add_id,userid:userid}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function searchTasker(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/search-tasker",data:{task:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function taskerCount(task,itemsPerPage,page){var skip=(parseInt(page)-1)*itemsPerPage,url="/site/task/taskerCount?page="+page+"&skip="+skip+"&limit="+itemsPerPage+"&task="+task,deferred=$q.defer();return $http({method:"GET",url:url}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}var taskService={taskbaseinfo:taskbaseinfo,checktaskeravailability:checktaskeravailability,getTaskerByGeoFilter:getTaskerByGeoFilter,getTaskerByGeoFiltermap:getTaskerByGeoFiltermap,gettaskuser:gettaskuser,taskprofileinfo:taskprofileinfo,taskerreviews:taskerreviews,saveuser:saveuser,addtask:addtask,getTaskDetailsbyid:getTaskDetailsbyid,confirmtask:confirmtask,deleteaddress:deleteaddress,getaddressdata:getaddressdata,AddAddress:AddAddress,addressStatus:addressStatus,searchTasker:searchTasker,taskerCount:taskerCount,getuserdata:getuserdata};return taskService}function accountsCtrl($scope,MainService,accountService,accountServiceResolve,$filter,$uibModal,$location,toastr,$timeout,Slug,$state,$window,$anchorScroll,AuthenticationService,sweet,$stateParams,$translate,NgMap){function Availability(){this.init=function(){$timeout(function(){google.maps.event.trigger($scope.maps[0],"resize"),$scope.maps[0].setCenter(new google.maps.LatLng(acc.user.location.lat,acc.user.location.lng))},100)}}var acc=this,stateparamcontent=$stateParams;acc.taskervariable=AuthenticationService.GetCredentials();var user=AuthenticationService.GetCredentials();if(accountServiceResolve[0]&&(acc.user=accountServiceResolve[0]||{}),$scope.visibleValue=!1,0==acc.accountMode&&($scope.visibleValue=!1),acc.user.gender&&(acc.user.gender=acc.user.gender.toLowerCase().replace(/\s+/g,"")),"tasker"==acc.user.role&&(1==acc.user.availability?acc.availabilityvalue=!0:acc.availabilityvalue=!1,acc.user.location)){var latlng=new google.maps.LatLng(acc.user.location.lat,acc.user.location.lng),geocoder=geocoder=new google.maps.Geocoder;geocoder.geocode({latLng:latlng},function(results,status){status==google.maps.GeocoderStatus.OK&&results[1]&&(acc.user.availability_address?(acc.taskerareaaddress=acc.user.availability_address,acc.tempTaskAddress=acc.user.availability_address):(acc.taskerareaaddress=results[1].formatted_address,acc.tempTaskAddress=results[1].formatted_address),acc.dummyAddress=1)})}if($scope.myImage="",acc.myCroppedImage="",$scope.handleFileSelect=function(evt){$scope.visibleValue=!0;var file=evt.currentTarget.files[0],reader=new FileReader;reader.onload=function(evt){$scope.$apply(function($scope){$scope.myImage=evt.target.result})},reader.readAsDataURL(file)},$scope.maps=[],$scope.$on("mapInitialized",function(evt,evtMap){$scope.maps.push(evtMap)}),acc.mapToInput=function(event){if($scope.maps[0]){acc.user.radius=parseInt($scope.maps[0].shapes.circle.radius/1e3);var lat=$scope.maps[0].shapes.circle.center.lat(),lng=$scope.maps[0].shapes.circle.center.lng(),latlng=new google.maps.LatLng(lat,lng),geocoder=geocoder=new google.maps.Geocoder;geocoder.geocode({latLng:latlng},function(results,status){"OK"==status&&$scope.$apply(function(){acc.taskerareaaddress=results[0].formatted_address,acc.user.availability_address=results[0].formatted_address,acc.user.location.lng=lng,acc.user.location.lat=lat})})}},acc.valueChange=function(){var user=AuthenticationService.GetCredentials();if(user.currentUser.username)if("user"==user.currentUser.user_type)MainService.getCurrentUsers(user.currentUser.username).then(function(response){acc.user=response[0],$scope.visibleValue=!1},function(err){});else if("tasker"==user.currentUser.user_type)return MainService.getCurrentTaskers(user.currentUser.username).then(function(response){acc.user=response[0],$scope.visibleValue=!1},function(err){})},accountService.getsettings().then(function(response){acc.getsettings=response,acc.inter=parseInt(acc.getsettings.settings.wallet.amount.maximum)+parseInt(acc.getsettings.settings.wallet.amount.minimum),acc.interamount=acc.inter/2,acc.walletMinAmt=(response.settings.wallet.amount.minimum*$scope.DefaultCurrency[0].value).toFixed(2),acc.walletMaxAmt=(response.settings.wallet.amount.maximum*$scope.DefaultCurrency[0].value).toFixed(2),acc.walletMidAmt=(response.settings.wallet.amount.maximum/2*$scope.DefaultCurrency[0].value).toFixed(2)}),$scope.fileupload=function($files,$event,$rejectedFiles){if($files)if($files.length&&$files[0].size<2097152)for(var i=0;i<$files.length;i++)$scope.avatar=$files[i],acc.user.avatar=$scope.avatar;else $translate("IMAGE SIZE IS SHOULD NOT BE LARGER THEN 1 MB").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},acc.filter=$location.$$search,acc.accountMenu=[{heading:"ACCOUNT",template:"app/site/modules/accounts/views/account.tab.html",type:"common",active:!0},{heading:"PASSWORD",template:"app/site/modules/accounts/views/password.tab.html",type:"common"},{heading:"TASK DETAILS",template:"app/site/modules/accounts/views/task-details.tab.html",type:"user",active:!0},{heading:"INVITE FRIENDS",template:"app/site/modules/accounts/views/invitefriend.tab.html",type:"user"},{heading:"WALLET",template:"app/site/modules/accounts/views/wallet.tab.html",type:"user"},{heading:"TRANSACTION",template:"app/site/modules/accounts/views/user-transaction.tab.html",type:"user"},{heading:"ACCOUNT_INFO",template:"app/site/modules/accounts/views/accountinfo.tab.html",type:"tasker"},{heading:"CATEGORY",template:"app/site/modules/accounts/views/category.tab.html",type:"tasker"},{heading:"AVAILABILITY",template:"app/site/modules/accounts/views/availability.tab.html",type:"tasker","function":new Availability},{heading:"PROFILE DETAILS",template:"app/site/modules/accounts/views/profileinfo.tab.html",type:"tasker"},{heading:"JOB DETAILS",type:"tasker",template:"app/site/modules/accounts/views/task-invitation.tab.html"},{heading:"TRANSACTION",type:"tasker",template:"app/site/modules/accounts/views/transaction.tab.html"},{heading:"REVIEWS",template:"app/site/modules/accounts/views/reviews.tab.html",type:"common"},{heading:"DEACTIVATE",template:"app/site/modules/accounts/views/deactivate.tab.html",type:"common"}],acc.SettingsTab=acc.accountMenu.filter(function(menu){if("user"==acc.user.role){if("facebook"==acc.user.type){if(("common"==menu.type||"user"==menu.type)&&"PASSWORD"!=menu.heading)return void 0==stateparamcontent.status?("TASK DETAILS"==menu.heading&&(menu.active=!1),"ACCOUNT"==menu.heading&&(menu.active=!0)):"ACCOUNT"==menu.heading&&(menu.active=!0),menu}else if("common"==menu.type||"user"==menu.type)return void 0==stateparamcontent.status?("TASK DETAILS"==menu.heading&&(menu.active=!1),"ACCOUNT"==menu.heading&&(menu.active=!0)):"ACCOUNT"==menu.heading&&(menu.active=!0),menu}else if("common"==menu.type||"tasker"==menu.type)return void 0==stateparamcontent.status?("JOB DETAILS"==menu.heading&&(menu.active=!1),"ACCOUNT"==menu.heading&&(menu.active=!0)):"JOB DETAILS"==menu.heading&&(menu.active=!0),menu}),acc.go=function(route){$state.go(route)},acc.accountMode=!0,acc.saveAccount=function(isValid){isValid?(acc.user.avatarBase64=acc.myCroppedImage,accountService.saveAccount(acc.user).then(function(response){$translate("SAVED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$location.hash("editaccountdiv"),$anchorScroll(),$location.url($location.path());var user=AuthenticationService.GetCredentials();user.currentUser.username&&"user"==user.currentUser.user_type&&MainService.getCurrentUsers(user.currentUser.username).then(function(response){acc.user=response[0],$scope.visibleValue=!1},function(err){})},function(err){err.msg?toastr.success(err.msg):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},acc.placeChanged=function(){acc.user.address.line1="",acc.user.address.line2="",acc.user.address.city="",acc.user.address.state="",acc.user.address.country="",acc.user.address.zipcode="",acc.place=this.getPlace();var UserDetails={};UserDetails.location={},UserDetails.location.lng=acc.place.geometry.location.lng(),UserDetails.location.lat=acc.place.geometry.location.lat(),acc.user.lat=UserDetails.location.lat,acc.user.lng=UserDetails.location.lng;var locationa=acc.place;acc.user.address.line1=acc.place.formatted_address,locationa.name&&(acc.user.address.line1=locationa.name);for(var i=0;i<locationa.address_components.length;i++)for(var j=0;j<locationa.address_components[i].types.length;j++)"neighborhood"==locationa.address_components[i].types[j]&&acc.user.address.line1!=locationa.address_components[i].long_name&&(""!=acc.user.address.line1?acc.user.address.line1=acc.user.address.line1+","+locationa.address_components[i].long_name:acc.user.address.line1=locationa.address_components[i].long_name),"route"==locationa.address_components[i].types[j]&&acc.user.address.line1!=locationa.address_components[i].long_name&&(""!=acc.user.address.line2?acc.user.address.line2=acc.user.address.line2+","+locationa.address_components[i].long_name:acc.user.address.line2=locationa.address_components[i].long_name),"street_number"==locationa.address_components[i].types[j]&&(""!=acc.user.address.line2?acc.user.address.line2=acc.user.address.line2+","+locationa.address_components[i].long_name:acc.user.address.line2=locationa.address_components[i].long_name),"sublocality_level_1"==locationa.address_components[i].types[j]&&(""!=acc.user.address.line2?acc.user.address.line2=acc.user.address.line2+","+locationa.address_components[i].long_name:acc.user.address.line2=locationa.address_components[i].long_name),"locality"==locationa.address_components[i].types[j]&&(acc.user.address.city=locationa.address_components[i].long_name),"country"==locationa.address_components[i].types[j]&&(acc.user.address.country=locationa.address_components[i].long_name),"postal_code"==locationa.address_components[i].types[j]&&(acc.user.address.zipcode=locationa.address_components[i].long_name),"administrative_area_level_1"!=locationa.address_components[i].types[j]&&"administrative_area_level_2"!=locationa.address_components[i].types[j]||(acc.user.address.state=locationa.address_components[i].long_name)},acc.password={},acc.password.userId=acc.user._id,acc.savePassword=function(isvalid,data){isvalid?data.newpassword==data.new_confirmed?accountService.savePassword(data).then(function(response){$translate("SAVED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$state.go("account")},function(err){err.message?toastr.error(err.message):$translate("PLEASE TYPE A DIFFERENT PASSWORD").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}):$translate("CONFIRM PASSWORD IS NOT MATCH").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}):$translate("FORM IS INVALID").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},acc.banking={},acc.banking=acc.user.banking,acc.saveaccountinfo=function(isvalid,data){acc.banking.userId=acc.user._id,isvalid?accountService.saveaccountinfo(data).then(function(response){$translate("SAVED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$state.go("account")},function(err){err.message}):$translate("please fill all mandatory fileds").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},acc.FacebookInviteFriends=function(){accountService.getsettings().then(function(response){acc.getsettingdata=response,accountService.getseosetting().then(function(seoresponse){acc.getseosetting=seoresponse;var invite={};invite.name="Signup with my code - "+acc.getsettingdata.settings.site_title,invite.link=acc.getsettingdata.settings.site_url,invite.description="Signup with my code "+acc.user.unique_code+" to earn "+$scope.DefaultCurrency[0].symbol+acc.getsettings.settings.referral.amount.referral+" on your "+acc.getsettingdata.settings.site_title+" wallet",invite.picture=acc.getsettingdata.settings.site_url+"uploads/default/facebook-share.jpg",acc.getsettingdata&&FB.ui({method:"send",name:invite.name,link:invite.link,description:invite.description,picture:invite.picture})})})},acc.addReview=function(taskdetails){accountService.gettaskreview(taskdetails._id).then(function(response){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/userreview.modal.tab.html",controller:"addReviewModal",controllerAs:"ARM",resolve:{TaskDetails:function(){return taskdetails}}});modalInstance.result.then(function(data){accountService.addUserReview(data).then(function(respo){acc.reviewdata=respo,acc.GetTaskList("completed")})})})},$scope.$watchCollection("DefaultCurrency",function(newNames,oldNames){acc.getsettings.settings&&(acc.walletMinAmt=(acc.getsettings.settings.wallet.amount.minimum*newNames[0].value).toFixed(2),acc.walletMaxAmt=(acc.getsettings.settings.wallet.amount.maximum*newNames[0].value).toFixed(2),acc.walletMidAmt=(acc.getsettings.settings.wallet.amount.maximum/2*newNames[0].value).toFixed(2))}),acc.changeWalletAmt=function(value){acc.walletMinAmt=(acc.getsettings.settings.wallet.amount.minimum*$scope.DefaultCurrency[0].value).toFixed(2),acc.walletMaxAmt=(acc.getsettings.settings.wallet.amount.maximum*$scope.DefaultCurrency[0].value).toFixed(2),acc.walletMidAmt=(acc.getsettings.settings.wallet.amount.maximum/2*$scope.DefaultCurrency[0].value).toFixed(2)},acc.changeWallet=function(value){acc.walletAamount=parseFloat(value).toFixed(2)},acc.savewallet=function savewallet(data,savewallet){acc.walletMinAmt=(acc.getsettings.settings.wallet.amount.minimum*$scope.DefaultCurrency[0].value).toFixed(2),acc.walletMaxAmt=(acc.getsettings.settings.wallet.amount.maximum*$scope.DefaultCurrency[0].value).toFixed(2),acc.walletMidAmt=(acc.getsettings.settings.wallet.amount.maximum/2*$scope.DefaultCurrency[0].value).toFixed(2);var detaileddata={};if(detaileddata.data=data.amount,detaileddata.currencyvalue=savewallet,detaileddata.data)if(parseFloat(data.amount)>=acc.walletMinAmt&&parseFloat(data.amount)<=acc.walletMaxAmt){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/wallet.modal.tab.html",controller:"WalletRechargeModal",controllerAs:"WRM",resolve:{Rechargeamount:function(){return detaileddata}}});modalInstance.result.then(function(data){user=acc.user._id,accountService.updatewalletdata(data,user).then(function(response){402==response.statusCode?toastr.error(response.message):($translate("WALLET MONEY HAS BEEN UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),acc.getwalletdetails=response.wallet,wallet.amount="")},function(err){})},function(){})}else $translate("PLEASE ENTER THE AMOUNT TO ADD TO THE WALLET").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)});else $translate("PLEASE ENTER THE AMOUNT TO ADD TO THE WALLET").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},acc.savewalletpaypal=function(data,savewallet){acc.walletMinAmt=(acc.getsettings.settings.wallet.amount.minimum*$scope.DefaultCurrency[0].value).toFixed(2),acc.walletMaxAmt=(acc.getsettings.settings.wallet.amount.maximum*$scope.DefaultCurrency[0].value).toFixed(2),acc.walletMidAmt=(acc.getsettings.settings.wallet.amount.maximum/2*$scope.DefaultCurrency[0].value).toFixed(2);var detaileddata={};detaileddata.data=data.amount,detaileddata.currencyvalue=savewallet,detaileddata.data&&parseFloat(data.amount)>=acc.walletMinAmt&&parseFloat(data.amount)<=acc.walletMaxAmt?(user=acc.user._id,accountService.updatewalletdatapaypal(data,user).then(function(response){1==response.status&&"paypal"==response.payment_mode?$window.location.href=response.redirectUrl:$translate("UNABLE PROCESS YOUR PAYMENT").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},function(err){})):$translate("PLEASE ENTER THE AMOUNT TO ADD TO THE WALLET").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},accountService.getCategories().then(function(respo){acc.categories=respo}),accountService.getCategoriesofuser(acc.user._id).then(function(respo){acc.usercategories=respo,acc.updatecat=function(){accountService.getCategoriesofuser(acc.user._id).then(function(respo){acc.usercategories=respo})},accountService.getExperience().then(function(respo){acc.experiences=respo})}),acc.payment=function(isValid,formdata){isValid?accountService.confirmtask(acc.taskPayment).then(function(err,response){$translate("SAVED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})},function(err){err.msg?toastr.error(err.msg):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}):$translate("PLEASE ENTER THE VALID DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},MainService.getDefaultCurrency().then(function(response){acc.DefaultCurrency=response}),acc.categoryModal=function(category){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/category.modal.tab.html",controller:"CategoriesModalInstanceCtrl",controllerAs:"ACM",resolve:{experiences:function(){return acc.experiences},defaultcurrency:function(){return $scope.DefaultCurrency},user:function(accountService){return category?accountService.edit(acc.user._id):acc.user},categories:function(){return acc.categories},category:function(){return category}}});modalInstance.result.then(function(selectedCategoryData,isValid){selectedCategoryData.hour_rate=selectedCategoryData.hour_rate/$scope.DefaultCurrency[0].value,accountService.updateCategory(selectedCategoryData).then(function(response){$translate("UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),acc.updatecat()},function(err){err.msg?toastr.error(err.msg):$translate("PLEASE ENTER THE VALID DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})})},acc.deletecategory=function(category,catname){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/deletecategory.modal.tab.html",controller:"DeleteCategoriesModalInstanceCtrl",controllerAs:"DACM",resolve:{user:function(){return acc.user},category:function(){return category},categoryname:function(){return catname}}});modalInstance.result.then(function(deletecategorydata){accountService.deleteCategory(deletecategorydata).then(function(response){$translate("CATEGORY DELETED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),acc.updatecat()},function(){})},function(){})},accountService.getQuestion().then(function(respo){acc.getQuestion=respo}),acc.user.profile_details&&(acc.user.profile_details.length>0?acc.profileDetails=acc.user.profile_details.reduce(function(total,current){return total[current.question]=current.answer,total},{}):(acc.profileDetails=[],acc.user.profile_details=[])),acc.saveProfile=function(){var i=0;for(var key in acc.profileDetails)acc.user.profile_details.filter(function(obj){return obj.question===key})[0]?acc.user.profile_details[i].answer=acc.profileDetails[key]:acc.user.profile_details.push({question:key,answer:acc.profileDetails[key]}),i++;accountService.saveProfile(acc.user).then(function(response){$translate("UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})},function(err){err.msg?$scope.addAlert(err.msg):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})},acc.taskitemsPerPage=2,acc.tasktotalItem=0,acc.taskInvitation=[],acc.getwalletdetails={},acc.getsettings={},acc.taskInvitationDetails=[],acc.tasker=[],acc.getTaskDetailsByStausResponse=!1,acc.getTaskDetailsByStaus=function(status,page){acc.taskInvitation=[],acc.getTaskDetailsByStausResponse=!1,acc.tasktotalItem=0,"6"==status||"7"==status?status="completed":"8"==status?status="cancelled":"2"==status||"3"==status||"4"==status||"5"==status?status="ongoing":"1"==status&&(status="assigned"),void 0==page?acc.CurrentPage=1:acc.CurrentPage=page,acc.currentStatus=status,accountService.getTaskDetailsByStaus(acc.user._id,acc.currentStatus,page,acc.taskitemsPerPage).then(function(response){response.length>0&&(acc.taskInvitationDetails=response,acc.taskInvitation=response[0].TaskDetails,console.log("ACC.taskInvitation*************",acc.taskInvitation),acc.tasktotalItem=response[0].count),acc.getTaskDetailsByStausResponse=!0})},acc.getUserTaskDetailsByStaus=function(status,page){acc.taskInvitation=[],acc.getUserTaskDetailsByStaus=!1,acc.tasktotalItem=0,"6"==status||"7"==status?status="completed":"8"==status?status="cancelled":"2"==status||"3"==status||"4"==status||"5"==status?status="ongoing":"1"==status&&(status="assigned"),acc.currentStatus=status,accountService.getUserTaskDetailsByStaus(acc.user._id,acc.currentStatus,page,acc.taskitemsPerPage).then(function(response){response.length>0&&(acc.taskInvitationDetails=response,acc.taskInvitation=response[0].TaskDetails,acc.tasktotalItem=response[0].count),acc.getTaskDetailsByStausResponse=!0})},acc.getWalleDetailsTemp=function(status){acc.index=0,accountService.getwalletdetails(acc.user._id).then(function(response){response?acc.getwalletdetails=response:acc.getwalletdetails.total=0})},acc.getUserWalletTransaction=function(){acc.index=1,accountService.getUserWalletTransaction(acc.user._id,acc.walletListCurrentPage,acc.walletListitemsPerPage).then(function(response){function CategoryList(from,perPage){acc.SubCategoryList=[];for(var i=from;i<perPage;i++){if(i===acc.totalitem.length)return!1;acc.SubCategoryList.push(acc.totalitem[i])}}response&&(acc.currentPage=1,acc.numPerPage=10,acc.totalitems=response.transaction.length,acc.totalitem=response.transaction,acc.SubCategoryList=response.transaction,CategoryList(0,10),acc.getUserWalletTransaction=function(value){if(acc.currentPage){var spliceFrom=(acc.currentPage-1)*acc.numPerPage,offset=spliceFrom+acc.numPerPage;CategoryList(spliceFrom,offset)}})})},acc.getTasker=function(){acc.tasker=[],accountService.getTasker(acc.user._id).then(function(response){response.length>0&&(acc.tasker=response[0].TaskDetails)})},acc.taskertransitemsPerPage=5,acc.taskertranstotalItem=0,acc.taskertransCurrentPage=1,acc.getTransactionHis=function(page){accountService.getTransactionHis(acc.user._id,page,acc.taskertransitemsPerPage).then(function(response){response&&(acc.transcationhis=response.result,acc.taskertranstotalItem=response.count)})},acc.transitemsPerPage=5,acc.transtotalItem=0,acc.transCurrentPage=1,acc.getUserTransaction=function(page){accountService.getUserTransaction(acc.user._id,page,acc.transitemsPerPage).then(function(response){response&&(acc.usertranscation=response.result,acc.transtotalItem=response.count)})},accountService.getcancelreason(acc.user.role).then(function(response){response.length>0&&(acc.getcancelreason=response)}),acc.updatetaskstatus=function(taskid,status,currentpage){console.log("currentpage",currentpage);var data={};data.taskid=taskid,data.status=status,accountService.updatetaskstatus(data).then(function(response){response.error?$translate(response.error).then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}):3==response.status?$translate("YOU START-OFF THE TASK").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}):4==response.status?$translate("YOU ARRIVED TO THE TASK LOCATION").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}):6==response.status?$translate("YOUR REQUEST FOR CASH").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline);
}):$translate("YOU STARTED TASK").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),acc.getTaskDetailsByStaus("ongoing",currentpage),6==response.status&&acc.getTaskDetailsByStaus("completed"),acc.currentPage=currentpage})},acc.updatetaskstatuscash=function(taskid,status){var data={};data.taskid=taskid,data.status=status,accountService.updatetaskstatuscash(data).then(function(response){response.error?$translate(response.error).then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}):$translate("PAYMENT_COMPLETED").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),acc.getTaskDetailsByStaus("completed")})},acc.TaskTranscationViewModal=function(index,catid){var tasktranscationhis=acc.transcationhis[index],transcation={};transcation.date=tasktranscationhis.createdAt,transcation.invoice=tasktranscationhis.invoice,transcation.bookingid=tasktranscationhis._id,tasktranscationhis.transactions&&(transcation.transcationid=tasktranscationhis.transactions[0]),transcation.categoryname=tasktranscationhis.category.name;var taskerskills=tasktranscationhis.tasker.taskerskills;angular.forEach(taskerskills,function(key,value){key.childid==tasktranscationhis.category._id&&(transcation.perHour=key.hour_rate)}),transcation.worked_hours=tasktranscationhis.invoice.worked_hours,transcation.username=tasktranscationhis.user.username,transcation.addresss=tasktranscationhis.billing_address.city,transcation.tasker_earn=tasktranscationhis.invoice.amount.admin_commission;var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/model/transaction.modal.html",controller:"TaskTranscationViewModal",controllerAs:"TTEMS",size:"lg",resolve:{TaskDetails:function(){return transcation},task:function(){return acc.transcationhis[index]},defaultcurrency:function(){return $scope.DefaultCurrency},getsettings:function(){return acc.getsettings},getmaincatname:function(){return accountService.getmaincatname(catid)}}});modalInstance.result.then(function(data){},function(){})},acc.TaskUserTranscationViewModal=function(index,catid){var tasktranscationhis=acc.usertranscation[index],transcation={};transcation.date=tasktranscationhis.createdAt,transcation.invoice=tasktranscationhis.invoice,transcation.bookingid=tasktranscationhis._id,tasktranscationhis.transactions&&(transcation.transcationid=tasktranscationhis.transactions[0]),transcation.categoryname=tasktranscationhis.category.name;var taskerskills=tasktranscationhis.tasker.taskerskills;angular.forEach(taskerskills,function(key,value){key.childid==tasktranscationhis.category._id&&(transcation.perHour=key.hour_rate)}),transcation.worked_hours=tasktranscationhis.invoice.worked_hours,transcation.username=tasktranscationhis.user.username,transcation.addresss=tasktranscationhis.billing_address.city,transcation.tasker_earn=tasktranscationhis.invoice.amount.admin_commission;var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/model/usertransaction.modal.html",controller:"TaskUserTranscationViewModal",controllerAs:"TTEMS",size:"lg",resolve:{TaskDetails:function(){return transcation},task:function(){return acc.usertranscation[index]},defaultcurrency:function(){return $scope.DefaultCurrency},getsettings:function(){return acc.getsettings},getmaincatname:function(){return accountService.getmaincatname(catid)}}});modalInstance.result.then(function(data){},function(){})},acc.getmaincatname=function(catid){accountService.getmaincatname(catid).then(function(response){acc.maincategoryname=response.name})},acc.taskerareaChanged=function(){acc.place=this.getPlace(),acc.user.location={},acc.user.location.lng=acc.place.geometry.location.lng(),acc.user.location.lat=acc.place.geometry.location.lat(),acc.user.availability_address=acc.place.formatted_address;var locationa=acc.place,dummy=locationa.address_components.filter(function(value){return"locality"==value.types[0]}).map(function(data){return data});acc.dummyAddress=dummy.length},acc.taskerconfirmpay=function(taskid,status){var data={};data.taskid=taskid,data.status=status,accountService.updateTaskcompletion(data).then(function(response){6==response.status?$translate("TASK_COMPLETED").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}),acc.getTaskDetailsByStaus("ongoing")})},acc.savewalletpaypal=function(data,savewallet){acc.walletMinAmt=(acc.getsettings.settings.wallet.amount.minimum*$scope.DefaultCurrency[0].value).toFixed(2),acc.walletMaxAmt=(acc.getsettings.settings.wallet.amount.maximum*$scope.DefaultCurrency[0].value).toFixed(2),acc.walletMidAmt=(acc.getsettings.settings.wallet.amount.maximum/2*$scope.DefaultCurrency[0].value).toFixed(2);var detaileddata={};detaileddata.data=data.amount,detaileddata.currencyvalue=savewallet,detaileddata.data&&parseFloat(data.amount)>=acc.walletMinAmt&&parseFloat(data.amount)<=acc.walletMaxAmt?(user=acc.user._id,accountService.updatewalletdatapaypal(data,user).then(function(response){1==response.status&&"paypal"==response.payment_mode?$window.location.href=response.redirectUrl:$translate("UNABLE PROCESS YOUR PAYMENT").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},function(err){})):$translate("PLEASE ENTER THE AMOUNT TO ADD TO THE WALLET").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},acc.updateModalTask=function(index,status){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/task-dispute.modal.html",controller:"DisputeReviewModalInstanceCtrl",controllerAs:"DNM",resolve:{TaskDetails:function(){return acc.taskList[index]},status:function(){return status}}});modalInstance.result.then(function(data){acc.taskInvitation.length>0&&angular.isDefined(acc.taskInvitation[index]._id)&&accountService.updateTask(acc.taskInvitation[index]._id,status).then(function(response){acc.taskInvitation.splice(index,1)},function(err){})},function(){})},acc.TaskReviewModalSave=function(index){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/task-review.modal.tab.html",controller:"TaskReviewModalSave",controllerAs:"TREMS",resolve:{TaskDetails:function(){return acc.taskList[index]}}}),userdata=acc.taskList[index];modalInstance.result.then(function(data){var reviewdata={};reviewdata.rating=data.rating,reviewdata.comments=data.comments,reviewdata.user=userdata.user,reviewdata.tasker=userdata.tasker._id,reviewdata.task=userdata._id,reviewdata.type="tasker",accountService.setReview(reviewdata).then(function(response){acc.getreviewdetails})})},acc.TaskReviewModal=function(index){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/task-review.modal.html",controller:"TaskReviewModalCtrl",controllerAs:"TREM",resolve:{TaskDetails:function(){return acc.taskInvitation[index]}}}),userdata=acc.taskInvitation[index];modalInstance.result.then(function(data){var reviewdata={};reviewdata.rating=data.rating,reviewdata.comments=data.comments,reviewdata.user=userdata.user._id,reviewdata.tasker=userdata.tasker,reviewdata.task=userdata._id,reviewdata.type="tasker",accountService.inserttaskerreview(reviewdata).then(function(response){accountService.getReview(acc.user._id,acc.reviewListCurrentPage,acc.reviewListitemsPerPage).then(function(respo){}),acc.getTaskDetailsByStaus("completed")},function(err){})},function(){})},acc.TaskInviteViewModal=function(index){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/taskinvite.view.modal.tab.html",controller:"TaskInviteViewModalInstanceCtrl",controllerAs:"TVMI",resolve:{TaskInvite:function(){return acc.taskInvitation[index]},DefaultCurrency:function(){return $scope.DefaultCurrency},getsettings:function(){return acc.getsettings}}});modalInstance.result.then(function(data){},function(){})},acc.TaskerextrapriceModal=function(taskid,status){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/taskerextraprice.view.modal.tab.html",controller:"TaskerExtraViewModalInstanceCtrl",controllerAs:"TEVMI",resolve:{Taskid:function(){return taskid},status:function(){return status},DefaultCurrency:function(){return $scope.DefaultCurrency}}});modalInstance.result.then(function(data){accountService.updateTaskcompletion(data).then(function(response){6==response.status?$translate("TASK_COMPLETED").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}),acc.getTaskDetailsByStaus("ongoing"),acc.currentPage=1},function(){})},function(){})},acc.taskListitemsPerPage=2,acc.taskListtotalItem=0,acc.taskList=[],acc.taskinfobyid=[],acc.getTaskListResponse=!1,acc.taskinfobyid=function(taskid){accountService.gettaskinfobyid(taskid).then(function(response){response.length>0})},acc.GetTaskList=function(status,page){acc.status=status,acc.taskList=[],acc.getTaskListResponse=!1,acc.taskListtotalItem=0,void 0==page?acc.taskListCurrentPage=1:acc.taskListCurrentPage=page,accountService.taskListService(acc.user._id,status,acc.taskListCurrentPage,acc.taskListitemsPerPage).then(function(response){response.length>0&&(acc.taskList=response[0].TaskDetails,console.log("acc.taskList*****",acc.taskList[0].invoice.amount),acc.taskListtotalItem=response[0].count,accountService.getTaskDetails(acc.user._id).then(function(respo){acc.taskList.review=respo})),acc.getTaskListResponse=!0})},acc.updateTaskDetails=function(index,status){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/task-confirm.modal.html",controller:"TaskReviewModalInstanceCtrl",controllerAs:"TRM",resolve:{TaskDetails:function(){return acc.taskList[index]}}});modalInstance.result.then(function(data){user=acc.user._id,task=acc.taskList[index]._id,type="user",acc.taskList.length>0&&angular.isDefined(acc.taskList[index]._id)&&accountService.updateTask(acc.taskList[index]._id,status).then(function(response){acc.taskList.splice(index,1)},function(err){})},function(){})},acc.TaskDetailsViewModal=function(index){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/taskdetails.view.modal.tab.html",controller:"TaskDetailsViewModalInstanceCtrl",controllerAs:"TDVMI",resolve:{TaskDetails:function(){return acc.taskList[index]},DefaultCurrency:function(){return $scope.DefaultCurrency}}});modalInstance.result.then(function(data){},function(){})},acc.TaskDetailsViewModalforstatus=function(index){console.log("index---------------",index);var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/taskdetailsforstatus.modal.tab.html",controller:"TaskDetailsViewforstatusModalInstanceCtrl",controllerAs:"TDVSMI",resolve:{TaskDetails:function(){return acc.taskList[index]},defaultcurrency:function(){return $scope.DefaultCurrency}}});modalInstance.result.then(function(data){},function(){})},acc.reviewModal=function(data,task){$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/reviewdetails.view.modal.tab.html",controller:"reviewModelCtrl",controllerAs:"RMC",resolve:{data:function(){return data},role:function(){return acc.user.role}}})},acc.TaskDetailsViewModal=function(index){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/taskdetails.view.modal.tab.html",controller:"TaskDetailsViewModalInstanceCtrl",controllerAs:"TDVMI",resolve:{TaskDetails:function(){return acc.taskList[index]},DefaultCurrency:function(){return $scope.DefaultCurrency}}});modalInstance.result.then(function(data){},function(){})},acc.TaskDetailsIgnoreModal=function(id,status){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/task-cancel.modal.tab.html",controller:"TaskDetailsIgnoreModalInstanceCtrl",controllerAs:"TDIMI",resolve:{userid:function(){return id},status:function(){return status},cancelreason:function(){return acc.getcancelreason}}});modalInstance.result.then(function(taskignoredata){accountService.usercanceltask(taskignoredata).then(function(response){acc.taskCurrentPage=1,acc.GetTaskList("cancelled"),acc.tabFourActive=!0},function(){err.msg?toastr.error(err.msg):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})},function(){})},acc.ignoreTask=function(id,status){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/task-cancel.modal.tab.html",controller:"TaskDetailsIgnoreModalInstanceCtrl",controllerAs:"TDIMI",resolve:{userid:function(){return id},status:function(){return status},cancelreason:function(){return acc.getcancelreason}}});modalInstance.result.then(function(taskignoredata){accountService.ignoreTask(taskignoredata).then(function(response){acc.currentPage=1,acc.getTaskDetailsByStaus("cancelled"),acc.tabFourActive=!0},function(){err.msg?$scope.addAlert(err.msg):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})},function(){})},acc.taskerconfirmtask=function(id,taskerid,status){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/tasker-taskconfirm.modal.tab.html",controller:"TaskDetailsconfirmModalInstanceCtrl",controllerAs:"TDCMI",resolve:{taskid:function(){return id},taskerid:function(){return taskerid},status:function(){return status}}});modalInstance.result.then(function(taskconfirmdata){accountService.taskerconfirmTask(taskconfirmdata).then(function(response){response.error?toastr.error(response.error):"You have already booked a job in the chosen time, please choose a different time slot to perform job."==response&&toastr.warning(response),acc.getTaskDetailsByStaus("assigned")},function(err){err.msg?toastr.error(err.msg):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})},function(){})},"tasker"==acc.user.role){acc.availability={},acc.availability.days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var workingDays=[{day:"Sunday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Monday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Tuesday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Wednesday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Thursday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Friday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Saturday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0}],workingTimes={};workingTimes.morning={from:moment.tz(new Date(99,5,24,8,0,0,0),$scope.date.timezone).format($scope.date.time_format),to:moment.tz(new Date(99,5,24,12,0,0,0),$scope.date.timezone).format($scope.date.time_format)},workingTimes.afternoon={from:moment.tz(new Date(99,5,24,12,0,0,0),$scope.date.timezone).format($scope.date.time_format),to:moment.tz(new Date(99,5,24,16,0,0,0),$scope.date.timezone).format($scope.date.time_format)},workingTimes.evening={from:moment.tz(new Date(99,5,24,16,0,0,0),$scope.date.timezone).format($scope.date.time_format),to:moment.tz(new Date(99,5,24,20,0,0,0),$scope.date.timezone).format($scope.date.time_format)},acc.workingDays=workingDays;var DaysData=[{Morning:"MORNING",afternoon:"AFTERNOON",evening:"EVENING",Save:"SAVE"}];angular.forEach(acc.workingDays,function(workingDays,key){angular.forEach(acc.user.working_days,function(UserWorkingdays){UserWorkingdays.day==workingDays.day&&(1!=UserWorkingdays.hour.evening&&1!=UserWorkingdays.hour.evening&&1!=UserWorkingdays.hour.evening||(UserWorkingdays.not_working=!1,acc.workingDays[key]=UserWorkingdays))})}),console.log("acc.workingDays/*/*/",acc.workingDays),acc.availabilityModal=function(size,index){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/availability.modal.tab.html",controller:"AvailabilityModalInstanceCtrl",size:size,resolve:{workingDays:function(){return acc.workingDays},workingTimes:function(){return workingTimes},DaysData:function(){return DaysData},selectedIndex:function(){return index}}});modalInstance.result.then(function(WorkingDays){console.log("////////////////WorkingDays, selectedIndex///",WorkingDays,index),acc.user.working_days[index]=WorkingDays},function(){})},acc.emptyLatLng=function(temp_address){temp_address!=acc.taskerareaaddress&&(acc.user.location.lat="",acc.user.location.lng="")},acc.saveAvailability=function(){return""==acc.user.location.lat||""==acc.user.location.lng?void toastr.error("Invalid Address"):void accountService.saveAvailability(acc.user).then(function(response){$translate("UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})},function(err){err.msg?toastr.error(err.msg):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})}}acc.availabilityChange=function(value){acc.data={},0==value?acc.data.availability=0:acc.data.availability=1,acc.data._id=acc.user._id,accountService.updateAvailability(acc.data).then(function(response){$translate("TASKER AVAILABILITY UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})},function(err){err.msg?toastr.error(err.msg):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})},acc.deactivate=function(deactivateAcc){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/deactivate.modal.tab.html",controller:"DeactivateCtrl",controllerAs:"DECM",resolve:{user:function(){return acc.user}}});modalInstance.result.then(function(userid){accountService.deactivateAccount(userid).then(function(response){$translate("YOUR ACCOUNT DEACTIVATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})},function(){err.msg?toastr.error(err.msg):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})})},acc.reviewListCurrentPage=1,acc.reviewListitemsPerPage=5,acc.reviewListtotalItem=0,acc.getreviewdetails=function(status){acc.index=0,accountService.getReview(acc.user._id,acc.reviewListCurrentPage,acc.reviewListitemsPerPage,acc.user.role).then(function(respo){$scope.truefalse="true",acc.reviewListtotalItem=respo.count,acc.getReview=respo.result,acc.finalResult=[],angular.forEach(acc.getReview,function(value,key){value.task&&acc.finalResult.push(value)})})},acc.getuserreviewdetails=function(status){acc.index=1,accountService.getuserReview(acc.user._id,acc.reviewListCurrentPage,acc.reviewListitemsPerPage,acc.user.role).then(function(respo){$scope.truefalse="true",acc.reviewListtotalItem=respo.count,acc.getReview=respo.result,acc.finalResult=[],angular.forEach(acc.getReview,function(value,key){value.task&&acc.finalResult.push(value)})})},acc.accountMode=!0,"undefined"!=typeof acc.user.address.line1?acc.temp_address=acc.user.address.line1:acc.temp_address="",acc.saveTaskerAccount=function(isValid){if(isValid){if(acc.user.avatarBase64=acc.myCroppedImage,console.log("----acc.place----",acc.place),console.log("----acc.temp_address----------",acc.temp_address),console.log("----acc.user.address.line1----",acc.user.address.line1),acc.temp_address!=acc.user.address.line1&&"undefined"==typeof acc.place)return acc.temp_address="",void $translate("INVALID ADDRESS").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)});acc.user.address.line1=acc.temp_address,console.log(acc.user.address),accountService.saveTaskerAccount(acc.user).then(function(response){$translate("UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$location.hash("editaccountdiv"),$anchorScroll();var user=AuthenticationService.GetCredentials();if(user.currentUser.username&&"tasker"==user.currentUser.user_type)return MainService.getCurrentTaskers(user.currentUser.username).then(function(response){console.log("response*******",response),acc.user=response[0],$scope.visibleValue=!1},function(err){})},function(err){err.msg?toastr.error(err.msg):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})}else $translate("PLEASE ENTER THE VALID DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},acc.password={},acc.password.userId=acc.user._id,acc.saveTaskerPassword=function(isvalid){isvalid?accountService.saveTaskerPassword(acc.password).then(function(response){$translate("UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$state.go("account")},function(err){err.msg?toastr.error(err.msg):$translate("PLEASE TYPE A DIFFERENT PASSWORD").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}):$translate("FORM IS INVALID").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},acc.deactivateTasker=function(deactivateTaskerAcc){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/deactivate.modal.tab.html",controller:"DeactivateCtrl",controllerAs:"DECM",resolve:{user:function(){return acc.user}}});modalInstance.result.then(function(userid){accountService.deactivateTaskerAccount(userid).then(function(response){$translate("YOUR ACCOUNT DEACTIVATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})},function(){err.msg?toastr.error(err.msg):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})})}}function accountService($http,$q,Upload){function setReview(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/addReview",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function saveAccount(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/settings/save",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function disputeUpdateTask(data,status){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/disputeupdateTask",data:{data:data,status:status}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getUserWalletTransaction(id,page,itemsPerPage){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getuserwallettransaction",data:{id:id,skip:skip,limit:itemsPerPage}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function ignoreTask(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/ignoreTask",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function taskerconfirmTask(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/taskerconfirmtask",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function saveProfile(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updateprofiledetails",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function savePassword(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/password/save",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function saveAvailability(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/availability/save",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function updateAvailability(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/availability/update",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function edit(id){var data={id:id},deferred=$q.defer();return $http({method:"POST",url:"/site/account/edit",data:data}).success(function(data){deferred.resolve(data[0])}).error(function(err){deferred.reject(err)}),deferred.promise}function getCategories(){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/categories/get"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getChild(id){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/categories/getchild",data:{id:id}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getTransactionHis(id,page,itemsPerPage){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/transcationhis",data:{id:id,skip:skip,limit:itemsPerPage}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getUserTransaction(id,page,itemsPerPage){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/usertranscation",data:{id:id,skip:skip,limit:itemsPerPage}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function updatewalletdata(data,user){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updatewalletdata",data:{data:data,user:user}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getmaincatname(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getmaincatname",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function updatetaskstatus(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updatetaskstatus",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function updatetaskstatuscash(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updatetaskstatuscash",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function updatewalletdatapaypal(data,user){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updatewalletdatapaypal",data:{data:data,user:user}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getwalletdetails(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getwalletdetails",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getsettings(){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getsettings"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getQuestion(){var deferred=$q.defer();return $http({method:"GET",url:"/site/account/question/getQuestion"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getExperience(){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/categories/get-experience"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getCategoriesofuser(id){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getcategoriesofuser",data:{_id:id}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getTaskDetailsByStaus(Id,status,page,itemsPerPage){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getTaskDetailsByStaus",data:{_id:Id,status:status,skip:skip,limit:itemsPerPage}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getUserTaskDetailsByStaus(Id,status,page,itemsPerPage){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getUserTaskDetailsByStaus",data:{_id:Id,status:status,skip:skip,limit:itemsPerPage}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getTaskDetailsBytaskid(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getTaskDetailsBytaskid",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function taskListService(Id,status,page,itemsPerPage){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getTaskList",data:{_id:Id,status:status,skip:skip,limit:itemsPerPage}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function updateTask(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updateTask",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function inserttaskerreview(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/insertaskerReview",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function updateTaskcompletion(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updateTaskcompletion",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function usercanceltask(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/usercanceltask",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function updateCategory(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updatecategoryinfo",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function deactivateAccount(userid){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/deactivateAccount",data:{userid:userid}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function deleteCategory(categoryinfo){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/deleteCategory",data:categoryinfo}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise;
}function getReview(id,page,itemsPerPage,role){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getreview",data:{id:id,skip:skip,limit:itemsPerPage,role:role}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getuserReview(id,page,itemsPerPage,role){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getuserReview",data:{id:id,skip:skip,limit:itemsPerPage,role:role}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function saveTaskerAccount(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/tasker/settings/save",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function saveTaskerPassword(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/tasker/password/save",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function deactivateTaskerAccount(userid){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/deactivateTaskertAccount",data:{userid:userid}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function taskinfo(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/taskinfo",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function confirmtask(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/taskinfo",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function addUserReview(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/addReview",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function gettaskinfobyid(taskid){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/gettaskbyid",data:{task:taskid}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getTaskDetails(userid){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getTaskDetails",data:{_id:userid}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function gettaskreview(taskid){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/gettaskreview",data:{taskid:taskid}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function downloadPdf(_id){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/downloadPdf",data:{_id:_id}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getcancelreason(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getcancelreason",data:{type:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function saveaccountinfo(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/saveaccountinfo",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getseosetting(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getseosetting"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function checkphoneno(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/checkphoneno",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}var accountService={saveAccount:saveAccount,savePassword:savePassword,saveProfile:saveProfile,getCategories:getCategories,edit:edit,updatetaskstatus:updatetaskstatus,updatetaskstatuscash:updatetaskstatuscash,updatewalletdata:updatewalletdata,getmaincatname:getmaincatname,getwalletdetails:getwalletdetails,getsettings:getsettings,getQuestion:getQuestion,getChild:getChild,getCategoriesofuser:getCategoriesofuser,taskListService:taskListService,getTaskDetailsByStaus:getTaskDetailsByStaus,getTaskDetailsBytaskid:getTaskDetailsBytaskid,updateTask:updateTask,inserttaskerreview:inserttaskerreview,updateTaskcompletion:updateTaskcompletion,usercanceltask:usercanceltask,ignoreTask:ignoreTask,taskerconfirmTask:taskerconfirmTask,saveAvailability:saveAvailability,getExperience:getExperience,updateCategory:updateCategory,deleteCategory:deleteCategory,deactivateAccount:deactivateAccount,getReview:getReview,getuserReview:getuserReview,setReview:setReview,getTransactionHis:getTransactionHis,saveTaskerAccount:saveTaskerAccount,saveTaskerPassword:saveTaskerPassword,deactivateTaskerAccount:deactivateTaskerAccount,taskinfo:taskinfo,confirmtask:confirmtask,addUserReview:addUserReview,gettaskinfobyid:gettaskinfobyid,disputeUpdateTask:disputeUpdateTask,getTaskDetails:getTaskDetails,gettaskreview:gettaskreview,updateAvailability:updateAvailability,downloadPdf:downloadPdf,getcancelreason:getcancelreason,saveaccountinfo:saveaccountinfo,getUserTransaction:getUserTransaction,getUserTaskDetailsByStaus:getUserTaskDetailsByStaus,getseosetting:getseosetting,updatewalletdatapaypal:updatewalletdatapaypal,getUserWalletTransaction:getUserWalletTransaction,checkphoneno:checkphoneno};return accountService}function messagesCtrl(MessageserviceResolve,MessageService,CurrentuserResolve,$uibModal,toastr,$translate){var msg=this;msg.messages=MessageserviceResolve.messages,msg.msgtotalItem=MessageserviceResolve.count.length,msg.currentPage=1,msg.msgitemsPerPage=2,msg.messages1=msg.messages.filter(function(value){if(value.task)return value}).map(function(value){return value}),msg.currentusertype=CurrentuserResolve.user_type,msg.currentuserid=CurrentuserResolve.user_id,msg.deletemessage=function(taskid,userid,taskerid,currentpage){console.log("currentPage",currentpage);var ids={};ids.taskid=taskid,ids.userid=userid,ids.taskerid=taskerid;var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/messages/views/deletemessage.modal.tab.html",controller:"deletemessageCtrl",controllerAs:"DACM",resolve:{idinfo:function(){return ids}}});modalInstance.result.then(function(idinfo){MessageService.deleteConversation(idinfo,msg.currentusertype).then(function(response){$translate("MESSAGE DELETED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),MessageService.getMessage(msg.currentuserid,msg.currentusertype,0,3).then(function(response){msg.messages=response.messages,msg.messages1=msg.messages.filter(function(value){if(value.task)return value}).map(function(value){return value}),msg.getMessage(currentpage)},function(){})},function(){})},function(){})},msg.msgitemsPerPage=3,msg.getMessage=function(page){console.log("page",page),page=(page-1)*msg.msgitemsPerPage,MessageService.getMessage(msg.currentuserid,msg.currentusertype,page,msg.msgitemsPerPage).then(function(response){response&&(msg.messages=response.messages,msg.msgtotalItem=response.count.length,msg.messages1=msg.messages.filter(function(value){if(value.task)return value}).map(function(value){return value}))})}}function chatCtrl(ChatServiceResolve,$state,toastr,$filter,AuthenticationService,TaskProfileResolve,MainService,$stateParams,socket,$scope,$rootScope,TaskServiceResolve,TaskService,CurrentuserResolve,$translate){function webupdatechat(data){console.log("dataforwebupdatechat",data),chat.data.task==data.task&&chat.data.tasker._id==data.tasker&&chat.data.user._id==data.user&&(chat.messages.push(data.messages[0]),data.messages[0].from!=chat.currentUser&&(data.currentuserid=$rootScope.userId,data.usertype=$rootScope.usertype,socket.emit("single message status",data)),setTimeout(function(){$("#chatscroll").scrollTop($("#chatscroll").scrollTop()+$("#chatscroll .chat-cnt:last").position().top)},0))}function singlemessagestatus(data){console.log("singlemessagestatusinangular",data),chat.messages=chat.messages.map(function(message){if(message._id==data.messages[0]._id){var usertype=chat.currentusertype;"user"==usertype?message.tasker_status=2:"tasker"==usertype&&(message.user_status=2)}return message})}function messagestatus(data){chat.data.task==data.task&&chat.data.tasker._id==data.tasker&&chat.data.user._id==data.user&&(chat.messages=data.messages)}function starttyping(data){chat.data.task==data.chat.task&&chat.data.tasker._id==data.chat.tasker&&chat.data.user._id==data.chat.user&&(chat.typing.status=!0)}function stoptyping(data){chat.data.task==data.chat.task&&chat.data.tasker._id==data.chat.tasker&&chat.data.user._id==data.chat.user&&(chat.typing.status=!1)}var chat=this,user=AuthenticationService.GetCredentials();if(chat.currentusertype=CurrentuserResolve.user_type,chat.taskerDetails=TaskProfileResolve,"user"==chat.currentusertype&&(chat.CurrentType="Tasker Name",TaskServiceResolve.tasker?(chat.UserName=TaskServiceResolve.tasker.username,chat.currentname=TaskServiceResolve.tasker.name.first_name):(chat.UserName=chat.taskerDetails.username,chat.currentname=chat.taskerDetails.name.first_name),MainService.getCurrentUsers(user.currentUser.username).then(function(result){chat.currentUserData=result[0]},function(error){$translate("INIT CURRENT DATA ERROR").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})),"tasker"==chat.currentusertype&&(chat.CurrentType="User Name",chat.UserName=TaskServiceResolve.user.username,chat.currentname=TaskServiceResolve.user.name.first_name,MainService.getCurrentTaskers(user.currentUser.username).then(function(result){chat.currentUserData=result[0]},function(error){$translate("INIT CURRENT DATA ERROR").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})),chat.currentUser=user.currentUser.user_id,chat.data=ChatServiceResolve,chat.data){var data={};data.task=$stateParams.task,data.user=$stateParams.user,data.tasker=$stateParams.tasker,data.type=user.currentUser.user_type,socket.emit("message status",data)}chat.messages=ChatServiceResolve.messages||[],chat.taskinfo=TaskServiceResolve,$rootScope.$emit("notification",{user:$rootScope.userId,type:$rootScope.usertype}),chat.typing={},chat.typing.status=!1,"tasker"==user.currentUser.user_type?chat.typing.message="User is typing. . .":"user"==user.currentUser.user_type&&(chat.typing.message="Tasker is typing. . ."),chat.taskinfo.amount=$filter("filter")(chat.taskerDetails.taskerskills,{childid:chat.taskinfo.category._id})[0].hour_rate,chat.send=function(message){if("tasker"==user.currentUser.user_type)var data={user:$stateParams.user,tasker:$stateParams.tasker,message:message,task:$stateParams.task,from:chat.currentUser};else if("user"==user.currentUser.user_type)var data={user:$stateParams.user,tasker:$stateParams.tasker,message:message,task:$stateParams.task,from:chat.currentUser};message&&socket.emit("new message",data),$scope.message=""},chat.ontyping=function(message){var data={};"tasker"==user.currentUser.user_type?(data.from=$stateParams.tasker,data.to=$stateParams.user):"user"==user.currentUser.user_type&&(data.from=$stateParams.user,data.to=$stateParams.tasker),data.task=$stateParams.task,data.user=$stateParams.user,data.tasker=$stateParams.tasker,data.type=user.currentUser.user_type,socket.emit("start typing",data),lastTypingTime=(new Date).getTime(),setTimeout(function(){var typingTimer=(new Date).getTime(),timeDiff=typingTimer-lastTypingTime;timeDiff>=400&&socket.emit("stop typing",data)},400)},chat.confirmatask=function(message){chat.taskinfo.status=message,chat.taskinfo.tasker=$stateParams.tasker,chat.taskinfo.hourly_rate=chat.taskinfo.amount,chat.taskinfo.invoice={amount:{minimum_cost:chat.taskinfo.category.commision,task_cost:chat.taskinfo.category.commision,total:chat.taskinfo.category.commision,grand_total:chat.taskinfo.category.commision}},chat.taskinfo.booking_information={service_type:chat.taskinfo.category.name,work_type:chat.taskinfo.category.name,work_id:chat.taskinfo.category._id,instruction:chat.taskinfo.task_description,booking_date:"",reach_date:"",est_reach_date:"",job_email:chat.taskerDetails.email,location:"",user_latlong:{lon:chat.taskinfo.location.log,lat:chat.taskinfo.location.lat}},TaskService.confirmtask(chat.taskinfo).then(function(result){"You have already booked a job in the chosen time, please choose a different time slot to perform job."==result?(chat.taskinfo.status=1,toastr.warning("You have already booked a job in the chosen time, please choose a different time slot to perform job.")):(2==chat.taskinfo.status?$translate("TASK ACCEPTED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}):$translate("REQUEST HAS BEEN SENT TO TASKER SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$state.go("landing",{reload:!1}))},function(error){toastr.error(error)})},socket.on("webupdatechat",webupdatechat),socket.on("single message status",singlemessagestatus),socket.on("message status",messagestatus),socket.on("start typing",starttyping),socket.on("stop typing",stoptyping),$scope.$on("$destroy",function(event){socket.removeListener("webupdatechat",webupdatechat),socket.removeListener("single message status",singlemessagestatus),socket.removeListener("message status",messagestatus),socket.removeListener("start typing",starttyping),socket.removeListener("stop typing",stoptyping)})}function socket($rootScope){var socket=io.connect("/chat"),events={},that={},addCallback=function(name,callback){var event=events[name],wrappedCallback=wrapCallback(callback);return event||(event=events[name]=[]),event.push({callback:callback,wrapper:wrappedCallback}),wrappedCallback},removeCallback=function(name,callback){var wrappedCallback,event=events[name];if(event)for(var i=event.length-1;i>=0;i--)if(event[i].callback===callback){wrappedCallback=event[i].wrapper,event.slice(i,1);break}return wrappedCallback},removeAllCallbacks=function(name){delete events[name]},wrapCallback=function(callback){var wrappedCallback=angular.noop;return callback&&(wrappedCallback=function(){var args=arguments;$rootScope.$apply(function(){callback.apply(socket,args)})}),wrappedCallback},listener=function(name,callback){return{bindTo:function(scope){null!==scope&&scope.$on("$destroy",function(){that.removeListener(name,callback)})}}};return{on:function(name,callback){return socket.on(name,addCallback(name,callback)),listener(name,callback)},once:function(name,callback){return socket.once(name,addCallback(name,callback)),listener(name,callback)},removeListener:function(name,callback){socket.removeListener(name,removeCallback(name,callback))},removeAllListeners:function(name){socket.removeAllListeners(name),removeAllCallbacks(name)},emit:function(name,data,callback){callback?socket.emit(name,data,wrapCallback(callback)):socket.emit(name,data)}}}function MessageService($http,$q){function deletemessage(categoryinfo){var deferred=$q.defer();return $http({method:"POST",url:"/site/chat/deletemessage",data:categoryinfo}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function saveChat(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/chat/save",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getMessage(currentuserid,currentusertype,page,itemsPerPage){console.log("currentuserid",currentuserid),console.log("currentusertype",currentusertype),console.log("page",page),console.log("itemsPerPage",itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/chat/getmessage",data:{userId:currentuserid,currentusertype:currentusertype,skip:page,limit:itemsPerPage}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function chatHistory(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/chat/chathistory",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function deleteConversation(chatinfo,usertype){var deferred=$q.defer();return $http({method:"POST",url:"/site/chat/deleteConversation",data:{chatinfo:chatinfo,usertype:usertype}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}var MessageService={saveChat:saveChat,getMessage:getMessage,deletemessage:deletemessage,chatHistory:chatHistory,deleteConversation:deleteConversation};return MessageService}function notificationCtrl(NotificationsResolve,NotificationService,toastr,$rootScope,$translate){var nc=this;nc.itemsPerPage=3,nc.currentPage=1,nc.totalItems=0,nc.notifications=NotificationsResolve,nc.notifications[0]&&(nc.totalItems=nc.notifications[0].count),$rootScope.$emit("webNotification",{user:$rootScope.userId,type:$rootScope.usertype});var data={};data.user=$rootScope.userId,data.type=$rootScope.usertype,nc.getnotification=function(){nc.notification=[],nc.getnotificationResponse=!1,NotificationService.getMessage(data,nc.currentPage,nc.itemsPerPage).then(function(data){nc.notifications=data},function(error){})}}function NotificationService($http,$q){function getMessage(data,page,itemsPerPage){var skip=0;if(page>1)var skip=(parseInt(page)-1)*itemsPerPage;var deferred=$q.defer();return $http({method:"POST",url:"/site/notifications/list",data:{data:data,skip:skip,itemsCount:itemsPerPage}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}var NotificationService={getMessage:getMessage};return NotificationService}function carddetailCtrl($scope,$rootScope,$window,$stateParams,$state,CarddetailResolve,CarddetailService,MainService,CurrentUserResolve,$translate,$location,$anchorScroll,toastr){var cdc=this;cdc.data=CarddetailResolve.taskdata[0],cdc.currentUser=CurrentUserResolve[0],7==cdc.data.status&&1==cdc.data.invoice.status&&(cdc.paymentStatus="Completed"),CarddetailService.paymentmode().then(function(response){cdc.paymentmode=response}),cdc.balance_amount=cdc.data.invoice.amount.balance_amount,cdc.data.invoice.amount.coupon?(cdc.couponbtn=0,cdc.coupon=cdc.data.invoice.coupon):(console.log("elsees"),cdc.coupon="",cdc.couponbtn=1),cdc.couponVisible=!1,cdc.applyCoupon=function(coupon){if(void 0==coupon)$translate("ENTER VALID COUPON CODE").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)});else{var data={};data.coupon=coupon,data.task=CarddetailResolve.taskdata[0]._id,data.user=CurrentUserResolve[0]._id,CarddetailService.applyCoupon(data).then(function(response){console.log("response/*/*/",response),cdc.couponVisible=!0,cdc.couponAmount=response[0].invoice.amount.coupon,cdc.couponbtn=0,cdc.data=CarddetailResolve.taskdata[0],console.log("cdc.data",cdc.data),cdc.grandtotal=response[0].invoice.amount.grand_total,0!=response[0].invoice.amount.coupon&&(cdc.grandtotal=response[0].invoice.amount.grand_total-response[0].invoice.amount.coupon),console.log("CDC.grandtotal",cdc.grandtotal),cdc.balance_amount=response[0].invoice.amount.balance_amount,$translate("SAVED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})},function(err){$scope.addAlert("danger",err.message)})}},cdc.removeCoupon=function(coupon){if(void 0==coupon)$translate("ENTER VALID COUPON CODE").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)});else{var data={};data.coupon=coupon,data.task=CarddetailResolve.taskdata[0]._id,data.user=CurrentUserResolve[0]._id,CarddetailService.removeCoupon(data).then(function(response){console.log("response",response),cdc.couponVisible=!1,cdc.couponbtn=1,cdc.grandtotal=response[0].invoice.amount.grand_total,console.log("cdc.grandtotal/*/*/",response[0].invoice.amount.grand_total),cdc.balance_amount=response[0].invoice.amount.balance_amount,cdc.coupon="",cdc.data=CarddetailResolve.taskdata[0],cdc.data.invoice.amount.grand_total=response[0].invoice.amount.grand_total,cdc.data.invoice.amount.balance_amount=response[0].invoice.amount.balance_amount,cdc.data.invoice.amount.coupon=0,$translate("SAVED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})},function(err){$scope.addAlert("danger",err.message)})}},cdc.walletpayment=function(data,coupon){var walletdata={};cdc.balance_amount?walletdata.amount=cdc.balance_amount:walletdata.amount=data.invoice.amount.balance_amount,walletdata.taskid=data._id,walletdata.taskerid=data.tasker._id,walletdata.userid=data.user._id,walletdata.createdat=data.createdAt,CarddetailService.walletpayment(walletdata).then(function(response){cdc.data=response,"wallet-other"==cdc.data.payment_type&&7!=cdc.data.status?(cdc.couponbtn=1,cdc.paymentStatus="Wallet money over",cdc.balance_amount=cdc.data.invoice.amount.balance_amount):0==cdc.data.status?($translate("Recharge Your Wallet").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}),cdc.data=CarddetailResolve.taskdata[0]):(cdc.paymentStatus="completed",$state.go("account"),$translate("PAYMENT_COMPLETED").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),CarddetailResolve.taskdata[0]._id)},function(err){err.message?$scope.addAlert("danger",err.message):$translate("UNABLE TO PROCESS YOUR PAYMENT").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})},cdc.creditscroll=function(){$location.hash("dopaymentcredit"),$anchorScroll(),$location.url($location.path())},cdc.payment=function(isValid){isValid?($location.hash("dopaymentcredit"),$anchorScroll(),$location.url($location.path()),cdc.formdata=cdc.taskPayment,cdc.formdata.taskid=CarddetailResolve.taskdata[0]._id,CarddetailService.confirmtask(cdc.formdata).then(function(response){console.log("response",response),cdc.data=response,1==cdc.data.status&&($state.go("account"),$translate("PAYMENT_COMPLETED").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),cdc.paymentStatus="completed",CarddetailResolve.taskdata[0]._id)},function(err){err.message?$scope.addAlert("danger",err.message):$translate("UNABLE PROCESS YOUR PAYMENT").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})):$translate("PLEASE ENTER THE VALID DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},cdc.couponCompltePayment=function(data){var couponCompletedata={};couponCompletedata.amount=data.invoice.amount.balance_amount,couponCompletedata.taskid=data._id,couponCompletedata.taskerid=data.tasker._id,couponCompletedata.userid=data.user._id,couponCompletedata.createdat=data.createdAt,CarddetailService.couponCompletePayment(couponCompletedata).then(function(response){response&&(cdc.data=response),cdc.paymentStatus="completed",$state.go("account"),$translate("PAYMENT_COMPLETED").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),CarddetailResolve.taskdata[0]._id},function(err){err.message?$scope.addAlert("danger",err.message):$translate("UNABLE PROCESS YOUR PAYMENT").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})},cdc.paypalPayment=function(data){var paymentdetails={};paymentdetails.task=data._id,paymentdetails.user=data.user._id,CarddetailService.paypalPayment(paymentdetails).then(function(response){console.log("response",response),1==response.status&&"paypal"==response.payment_mode?$window.location.href=response.redirectUrl:$translate("UNABLE PROCESS YOUR PAYMENT").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},function(err){err.message?$scope.addAlert("danger",err.message):$translate("UNABLE PROCESS YOUR PAYMENT").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})},cdc.payemntvalue=function(payemnt){cdc.type=payemnt}}function paypalfaileddetailCtrl($scope,$rootScope,$window,$stateParams,$state,paypaltaskid){var ppdc=this;ppdc.taskid=paypaltaskid.task}function CarddetailService($http,$q){function gettaskbyid(taskid){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/gettaskbyid",data:{task:taskid}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function confirmtask(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/confirmtask",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function paypalPayment(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/paypalPayment",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function walletpayment(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/paybywallet",data:data}).success(function(data){deferred.resolve(data),console.log("data----------wallet-------",data)}).error(function(err){deferred.reject(err)}),deferred.promise}function couponCompletePayment(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/couponCompletePayment",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function applyCoupon(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/apply-coupon",data:data}).success(function(data){deferred.resolve(data),console.log("")}).error(function(err){deferred.reject(err)}),deferred.promise}function removeCoupon(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/remove-coupon",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function paymentmode(){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/paymentmode"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}var carddetailService={gettaskbyid:gettaskbyid,confirmtask:confirmtask,walletpayment:walletpayment,applyCoupon:applyCoupon,removeCoupon:removeCoupon,paypalPayment:paypalPayment,paymentmode:paymentmode,couponCompletePayment:couponCompletePayment};return carddetailService}function pagesCtrl($scope,$rootScope,$location,$stateParams,PagesserviceResolve,PageService,$state,$sce,$translate,ngMeta,$cookies){var pac=this;return PagesserviceResolve.seo&&(ngMeta.setTitle(PagesserviceResolve.seo.title),ngMeta.setTag("description",PagesserviceResolve.seo.description),ngMeta.setTag("keyword",PagesserviceResolve.seo.keyword)),PagesserviceResolve[0].parent?$rootScope.pageId=PagesserviceResolve[0].parent:$rootScope.pageId=PagesserviceResolve[0]._id,PagesserviceResolve[0]?(pac.data=PagesserviceResolve[0],$scope.html=pac.data.description,$rootScope.trustedHtml=$sce.trustAsHtml($scope.html),pac.getSubcategoryResponse=!0,void(pac.getSubcategory=function(){pac.subcategory=[],angular.isDefined(pac.categoryDatails._id)&&(pac.getSubcategoryResponse=!1,PageService.getcategory(pac.categoryDatails.slug,pac.currentPage,pac.itemsPerPage).then(function(data){data.response.ActiveCategory.subcategory.length>0&&(pac.subcategory=data.response.ActiveCategory.subcategory,pac.totalItems=data.response.ActiveCategory.totalsubcategory)},function(error){}))})):void $state.go("404")}function PageService($http,$q){function getpage(slug,language){var deferred=$q.defer(),data={};return data.slug=slug.slug,data.language=language,$http({method:"POST",url:"/site/pages/getpage",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}var PageService={getpage:getpage};return PageService}function faqCtrl($scope,$rootScope,$location,$stateParams,FaqserviceResolve,FaqService,$state,$sce,$translate){var fac=this;fac.data=FaqserviceResolve,$scope.oneAtATime=!0}function emergencyCtrl($scope,toastr,ForgotpasswordService,$stateParams,$translate,$state){var userid=$stateParams.userid,emrg=this;emrg.verifyemergencycontact=function(isValid,formData){isValid?ForgotpasswordService.verifyemergencycontact({formData:formData,userid:userid}).then(function(response){$translate("MOBILE NO VERIFIED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$state.go("landing")},function(err){$translate("ERROR IN MOBILE VERIFICATION").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}):$translate("ERROR IN MOBILE VERIFICATION").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},ForgotpasswordService.mailverification({userid:userid}).then(function(response){$translate("MAIL VERIFIED  SUCCESSFULLY!").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})},function(err){$translate("ERROR IN MAIL VERIFICATION").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})}function FaqService($http,$q){function getfaq(){var deferred=$q.defer();return $http({method:"GET",url:"/site/faq/getfaq"}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}var FaqService={getfaq:getfaq};return FaqService}function pwdloginCtrl($scope,ForgotpasswordService,ForgotpasswordServiceResolve,toastr,$translate){var pwc=this;pwc.forgotpass=function(isValid,formData){isValid?ForgotpasswordService.saveUserInfo(formData).then(function(response){$translate("PASSWORD RESET MAIL HAS BEEN SENT TO YOUR EMAIL ID").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})},function(err){$translate("INVALID EMAIL ID").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}):$translate("EMAIL IS REQUIRED").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}}function ForgotpasswordService($http,$q){function saveUserInfo(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/saveforgotpasswordinfo",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function verifyemergencycontact(data){var deferred=$q.defer();return $http({method:"POST",url:"/mobile/verifyemergency",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function mailverification(data){var deferred=$q.defer();return $http({method:"POST",url:"/mobile/mailverification",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}var ForgotpasswordService={saveUserInfo:saveUserInfo,verifyemergencycontact:verifyemergencycontact,mailverification:mailverification};return ForgotpasswordService}function pwduserCtrl($scope,ForgotpwduserService,ForgotpwduserServiceResolve,toastr,$translate){var pwuc=this;pwuc.forgotpass=function(isValid,formData){isValid?ForgotpwduserService.saveUserInfopwd(formData).then(function(response){$translate("PASSWORD RESET MAIL HAS BEEN SENT TO YOUR EMAIL ID").then(function(headline){
toastr.success(headline)},function(translationId){toastr.success(headline)})},function(err){$translate("INVALID EMAIL ID").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}):$translate("EMAIL IS REQUIRED").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}}function ForgotpwduserService($http,$q){function saveUserInfopwd(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/saveforgotpwduser",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function otpsave(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/otpsave",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function resendotp(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/resendotp",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function getuserdata(data){console.log(data);var deferred=$q.defer();return $http({method:"POST",url:"/site/getuserdata",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}function activateUserAccount(data){console.log(data);var deferred=$q.defer();return $http({method:"POST",url:"/site/activateUserAccount",data:data}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}var ForgotpwduserService={saveUserInfopwd:saveUserInfopwd,otpsave:otpsave,resendotp:resendotp,getuserdata:getuserdata,activateUserAccount:activateUserAccount};return ForgotpwduserService}function pwdmailCtrl($scope,toastr,ForgotpwdusermailService,$state,$stateParams,$translate){var userid=$stateParams.userid,resetid=$stateParams.resetid,pwmc=this;pwmc.forgotpassmailuser=function(isValid,formData){isValid?ForgotpwdusermailService.saveUsermailpwd({formData:formData,userid:userid,resetid:resetid}).then(function(response){$translate("PASSWORD HAS BEEN CHANGED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$state.go("userlogin")},function(err){$translate("ERROR IN CHANGING PASSWORD").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}):$translate("ERROR IN CHANGING PASSWORD").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}}function ForgotpwdusermailService($http,$q){function saveUsermailpwd(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/forgotpwdmailuser",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}var ForgotpwdusermailService={saveUsermailpwd:saveUsermailpwd};return ForgotpwdusermailService}function pwdmailtskrCtrl($scope,toastr,ForgotpwdtaskermailService,$state,$stateParams,$translate){var userid=$stateParams.userid,resetid=$stateParams.resetid,pwmtc=this;pwmtc.forgotpassmailtasker=function(isValid,formData){isValid?ForgotpwdtaskermailService.saveTaskermailpwd({formData:formData,userid:userid,resetid:resetid}).then(function(response){$translate("PASSWORD HAS BEEN CHANGED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$state.go("taskerlogin")},function(err){$translate("ERROR IN CHANGING PASSWORD").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}):$translate("ERROR IN CHANGING PASSWORD").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}}function otploginCtrl($scope,$state,ForgotpwduserService,toastr,$translate,$stateParams,AuthenticationService,$cookieStore,$location){var otpc=this;otpc.newstatus=!1,ForgotpwduserService.getuserdata($stateParams.id).then(function(response){otpc.user=response}),otpc.activate=function(isValid,formData){if(formData!=otpc.user.phone.number)$translate("MOBILE NUMBER IS NOT MATCH").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)});else if(formData){var data={};data.mobile=formData,data.userid=$stateParams.id,ForgotpwduserService.activateUserAccount(data).then(function(response){response&&(otpc.newstatus=!0)},function(err){otpc.newstatus=!0,$translate(err.message).then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})}},otpc.otpsignup=function(isValid,otpvalue){if(otpvalue){var data={};data.otpKey=otpvalue,data.userid=$stateParams.id,ForgotpwduserService.otpsave(data).then(function(response){response?($translate("ACCOUNT VERIFIED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$state.go("userlogin")):$translate("INVALID OTP").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},function(err){$translate("INVALID EMAIL ID").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})}else $translate("Enter OTP").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},otpc.resendotp=function(isValid,formData){$stateParams.id?ForgotpwduserService.resendotp($stateParams.id).then(function(response){$translate("OTP RESEND SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})},function(err){$translate("INVALID DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}):$translate("OTP IS REQUIRED").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}}function ForgotpwdtaskermailService($http,$q){function saveTaskermailpwd(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/forgotpwdmailtasker",data:{data:data}}).success(function(data){deferred.resolve(data)}).error(function(err){deferred.reject(err)}),deferred.promise}var ForgotpwdtaskermailService={saveTaskermailpwd:saveTaskermailpwd};return ForgotpwdtaskermailService}angular.module("Authentication",[]),angular.module("handyforall.contactus",[]),angular.module("handyforall.page",[]),angular.module("handyforall.faq",[]),angular.module("handyforall.becometasker",[]),angular.module("handyforall.category",[]),angular.module("handyforall.task",[]),angular.module("handyforall.accounts",[]),angular.module("handyforall.messages",[]),angular.module("handyforall.carddeatil",[]),angular.module("handyforall.forgotpassword",[]),angular.module("handyforall.notifications",[]),angular.module("handyforall.site",["Authentication","ngAnimate","ngSanitize","ngCookies","ui.calendar","ui.validate","ui.bootstrap","ui.router","toastr","pascalprecht.translate","ngFileUpload","ngMap","ngImgCrop","slugifier","checklist-model","ngIntlTelInput","hSweetAlert","ui.select","ngMeta","ui.slider","afkl.lazyImage","handyforall.contactus","handyforall.faq","handyforall.becometasker","handyforall.category","handyforall.task","handyforall.page","handyforall.accounts","handyforall.messages","handyforall.carddeatil","handyforall.notifications","handyforall.forgotpassword"]).run(["$rootScope","$state","$location","$cookieStore","$http","$stateParams","AuthenticationService","toastr","MainService","$window","socket","ngMeta",function($rootScope,$state,$location,$cookieStore,$http,$stateParams,AuthenticationService,toastr,MainService,$window,socket,ngMeta){ngMeta.init(),$rootScope.$state=$state,$rootScope.siteglobals=$cookieStore.get("siteglobals")||{},$rootScope.siteglobals.currentUser&&($http.defaults.headers.common.Authorization=$rootScope.siteglobals.currentUser.authdata,MainService.getCurrentUsers($rootScope.siteglobals.currentUser.username).then(function(result){"wrong"==typeof $rootScope.currentUser?$window.location.href="/login":MainService.setCurrentUserValue(result[0])},function(error){toastr.error("Server Down !")})),$rootScope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams){var userdata=AuthenticationService.GetCredentials();userdata.currentUser&&"hirestep1"==toState.name&&"tasker"==userdata.currentUser.user_type&&($state.transitionTo("login"),toastr.error("Tasker Cannot  access"),event.preventDefault()),"hirestep1"!=toState.name&&"chat"!=toState.name||$rootScope.siteglobals.currentUser||($state.transitionTo("login"),event.preventDefault()),toState.authenticate&&!AuthenticationService.isAuthenticated()&&($state.transitionTo("login"),event.preventDefault()),toState.registerauthenticate&&("user"!=toParams.type&&"tasker"!=toParams.type||AuthenticationService.isAuthenticated())&&(AuthenticationService.isAuthenticated()?$state.transitionTo("landing"):$state.transitionTo("signup"),event.preventDefault()),toState.taskerauthenticate&&AuthenticationService.isTaskerAuthenticated()&&($state.transitionTo("landing"),event.preventDefault()),toState.loginauthenticate&&AuthenticationService.isAuthenticated()&&($state.transitionTo("landing"),event.preventDefault()),$rootScope.PreviousState=fromState,$rootScope.Previousparams=fromParams,$rootScope.currentState=toState,$rootScope.currentparams=toParams})}]).factory("myHttpInterceptor",function($q,$location,$rootScope,$cookieStore){var timestampMarker={response:function(response){return $rootScope.imgSrc=!1,404==response.status&&$location.path("/404"),response},responseError:function(rejection){return 401==rejection.status&&($cookieStore.remove("siteglobals"),$location.path("/login")),$q.reject(rejection)},request:function(config){return $rootScope.imgSrc="/app/site/public/images/loader.gif",config||$q.when(config)}};return timestampMarker}).config(function(ngMetaProvider,ngIntlTelInputProvider,toastrConfig){ngMetaProvider.useTitleSuffix(!0),ngIntlTelInputProvider.set({defaultCountry:""}),angular.extend(toastrConfig,{autoDismiss:!0,maxOpened:1,tapToDismiss:!0,closeButton:!0,closeHtml:'<i class="fa fa-times"></i>'})}).config(["$translateProvider","$urlMatcherFactoryProvider",function($translateProvider,$urlMatcherFactoryProvider){$translateProvider.useStaticFilesLoader({prefix:"/uploads/languages/",suffix:".json"}),$translateProvider.useLocalStorage(),$translateProvider.preferredLanguage("en"),$translateProvider.useSanitizeValueStrategy(null),$translateProvider.fallbackLanguage("en"),$urlMatcherFactoryProvider.caseInsensitive(!1),$urlMatcherFactoryProvider.strictMode(!0)}]).factory("PreviousState",["$rootScope","$state",function($rootScope,$state){var lastHref="/",lastStateName="landing",lastParams={},event="";return $rootScope.$on("$stateChangeSuccess",function(events,toState,toParams,fromState,fromParams){event=events,lastStateName=fromState.name,lastParams=fromParams,lastHref=$state.href(lastStateName,lastParams)}),{getLastHref:function(){return lastHref},goToLastState:function(){return $state.go(lastStateName,lastParams)}}}]).config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function($stateProvider,$urlRouterProvider,$locationProvider,$httpProvider){$locationProvider.html5Mode(!0),$urlRouterProvider.otherwise("/404"),$httpProvider.interceptors.push("myHttpInterceptor"),$stateProvider.state("landing",{url:"/",views:{content:{templateUrl:"app/site/modules/common/views/landing.html",controller:"MainCtrl",controllerAs:"MAC"}},data:{meta:{title:"Home"}},resolve:{MainserviceResolve:function(MainService){return MainService.landingdata()}}}).state("morecategories",{url:"/morecategories/:slug",views:{content:{templateUrl:"app/site/modules/common/views/morecategories.html",controller:"MorecategoryCtrl",controllerAs:"MOC"}},resolve:{MorecategoryserviceResolve:function(MainService,$stateParams){return MainService.getmorecategory($stateParams.slug)}}}).state("category",{url:"/category/:slug",views:{content:{templateUrl:"/app/site/modules/category/views/category.html",controller:"categoryCtrl",controllerAs:"CAC"}},data:{meta:{title:"Category"}},resolve:{CategoryserviceResolve:function(CategoryService,$stateParams){return CategoryService.getcategory($stateParams.slug,0,6)}}}).state("forgotpwd",{url:"/forgot_passwrd",controller:"pwdloginCtrl",controllerAs:"PWC",loginauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/forgetpassword.html",controller:"pwdloginCtrl",controllerAs:"PWC"},commonview:{template:"<div></div>"}},data:{meta:{title:"Forgot Your Password"}},resolve:{ForgotpasswordServiceResolve:function(ForgotpasswordService){return!0}}}).state("forgotpwduser",{url:"/forgot_passwrduser",controller:"pwduserCtrl",controllerAs:"PWUC",loginauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/forgetpassworduser.html",controller:"pwduserCtrl",controllerAs:"PWUC"},commonview:{template:"<div></div>"}},data:{meta:{title:"Forgot Your Password"}},resolve:{ForgotpwduserServiceResolve:function(ForgotpwduserService){return!0}}}).state("signupotp",{url:"/userverfication/:id",views:{commonview:{templateUrl:"app/site/modules/common/views/OTPSignup_model.html",controller:"otploginCtrl",controllerAs:"OTPC"}}}).state("forgotpwdusermail",{url:"/forgotpwdusermail/:userid/:resetid",controller:"pwdmailCtrl",controllerAs:"PWMC",loginauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/forgetpwdemaillink.html",controller:"pwdmailCtrl",controllerAs:"PWMC"},commonview:{template:"<div></div>"}},data:{meta:{title:"Forgot Your Password"}}}).state("emergency",{url:"/emergency/:userid",controller:"emergencyCtrl",controllerAs:"EMRG",loginauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/emergencycontact.html",controller:"emergencyCtrl",controllerAs:"EMRG"},commonview:{template:"<div></div>"}},data:{meta:{title:"Emergency Contact"}}}).state("forgotpwdtaskermail",{url:"/forgotpwdtaskermail/:userid/:resetid",controller:"pwdmailtskrCtrl",controllerAs:"PWMTC",loginauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/forgetpwdemaillinktasker.html",controller:"pwdmailtskrCtrl",controllerAs:"PWMTC"},commonview:{template:"<div></div>"}},data:{meta:{title:"Forgot Your Password"}}}).state("page",{url:"/page/:slug",views:{content:{templateUrl:"/app/site/modules/pages/views/pages.html",controller:"pagesCtrl",controllerAs:"PAC"}},data:{meta:{title:"Page"}},resolve:{PagesserviceResolve:function(PageService,$stateParams,$rootScope,$cookieStore,MainService){var languageUpdateValue=$cookieStore.get("language");return void 0==$rootScope.language&&($rootScope.language=languageUpdateValue),PageService.getpage($stateParams,$rootScope.language)}}}).state("login",{url:"/login",loginauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/login.html"},commonview:{template:"<div></div>"}},data:{meta:{title:"Login"}}}).state("userlogin",{url:"/user_login",controller:"userloginCtrl",controllerAs:"ULGC",loginauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/user-login.html",controller:"userloginCtrl",controllerAs:"ULGC"},commonview:{template:"<div></div>"}},data:{meta:{title:"User Login"}}}).state("taskerlogin",{url:"/tasker_login",controller:"taskerloginCtrl",controllerAs:"TLGC",loginauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/tasker-login.html",controller:"taskerloginCtrl",controllerAs:"TLGC"},commonview:{template:"<div></div>"}},data:{meta:{title:"Tasker Login"}}}).state("become_tasker",{url:"/become_tasker",views:{content:{templateUrl:"app/site/modules/common/views/taker.html"}},data:{meta:{title:"Become Tasker"}}}).state("contact_us",{url:"/contact_us",views:{content:{templateUrl:"app/site/modules/common/views/contactus.html",controller:"contactCtrl",controllerAs:"CTTC"}},data:{meta:{title:"Contact Us"}}}).state("faq",{url:"/faq",views:{content:{templateUrl:"/app/site/modules/common/views/faq.html",controller:"faqCtrl",controllerAs:"FAC"}},data:{meta:{title:"FAQ"}},resolve:{FaqserviceResolve:function(FaqService){return FaqService.getfaq()}}}).state("registertasker",{url:"/register-tasker",views:{content:{template:'<div ui-view="registertasker"></div>',controller:"registerTaskerCtrl",controllerAs:"RTTC"}},data:{meta:{title:"Tasker SignUp"}}}).state("signup",{url:"/signup",loginauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/signup.html"},commonview:{template:"<div></div>"}},data:{meta:{title:"SignUp"}}}).state("social",{url:"/social/:type",registerauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/social.html",controller:"userloginCtrl",controllerAs:"ULGC"},commonview:{template:"<div></div>"}},data:{meta:{title:"SignUp"}}}).state("messages",{url:"/messages",authenticate:!0,views:{content:{templateUrl:"app/site/modules/messages/views/messages.html",controller:"messagesCtrl",controllerAs:"MSG"}},data:{meta:{title:"Messages"}},resolve:{MessageserviceResolve:function(AuthenticationService,MessageService){var user=AuthenticationService.GetCredentials();return MessageService.getMessage(user.currentUser.user_id,user.currentUser.user_type,0,3)},CurrentuserResolve:function(AuthenticationService){var user=AuthenticationService.GetCredentials();return user.currentUser}}}).state("notifications",{url:"/notifications",authenticate:!0,views:{content:{templateUrl:"app/site/modules/notifications/views/notifications.html",controller:"notificationCtrl",controllerAs:"NC"}},data:{meta:{title:"Notifications"}},resolve:{NotificationsResolve:function(AuthenticationService,NotificationService){var user=AuthenticationService.GetCredentials(),data={};return data.user=user.currentUser.user_id,data.type=user.currentUser.user_type,NotificationService.getMessage(data,0,3)}}}).state("404",{url:"/404",views:{specialview:{templateUrl:"app/site/modules/common/views/404.html"},commonview:{template:"<div></div>"}},data:{meta:{title:"PageNotFound"}}}).state("chat",{url:"/chat/:task/:user/:tasker",views:{content:{templateUrl:"app/site/modules/messages/views/chat.html",controller:"chatCtrl",controllerAs:"CHAT"}},data:{meta:{title:"Messenger"}},resolve:{ChatServiceResolve:function(AuthenticationService,MessageService,$stateParams,socket){var user=AuthenticationService.GetCredentials(),data={};return data.task=$stateParams.task,data.user=$stateParams.user,data.tasker=$stateParams.tasker,data.type=user.currentUser.user_type,MessageService.chatHistory(data)},TaskServiceResolve:function(TaskService,$stateParams){return TaskService.getTaskDetailsbyid($stateParams.task)},TaskProfileResolve:function(TaskService,$stateParams){return TaskService.taskprofileinfo($stateParams.tasker)},CurrentuserResolve:function(AuthenticationService){var user=AuthenticationService.GetCredentials();return user.currentUser}}}).state("register",{url:"/register/:type",registerauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/user-register.html",controller:"registerCtrl",controllerAs:"RGC"},commonview:{template:"<div></div>"}},data:{meta:{title:"User SignUp"}}}).state("becometasker",{url:"/become-tasker",views:{content:{template:'<div ui-view="becometasker"></div>',controller:"becomeTaskerCtrl",controllerAs:"BTC"}},data:{meta:{title:"Tasker SignUp"}},resolve:{CategoryserviceResolve:function(CategoryService){return CategoryService.getcategoryList()}}}).state("becometasker.step0",{url:"/basicinfo",views:{becometasker:{templateUrl:"app/site/modules/tasker/views/basicinfo-step0.html"}},data:{meta:{title:"Tasker SignUp"}}}).state("becometasker.step1",{url:"/basicinfo",taskerauthenticate:!0,views:{becometasker:{templateUrl:"app/site/modules/tasker/views/addressInfo-step1.html"}},data:{meta:{title:"Tasker SignUp"}}}).state("becometasker.step3",{url:"/basicinfo",taskerauthenticate:!0,views:{becometasker:{templateUrl:"app/site/modules/tasker/views/availabiltyInfo-step3.html"}},data:{meta:{title:"Tasker SignUp"}}}).state("becometasker.step7",{url:"/basicinfo",taskerauthenticate:!0,views:{becometasker:{templateUrl:"app/site/modules/tasker/views/imageInfo-step7.html"}},data:{meta:{title:"Tasker SignUp"}}}).state("becometasker.step8",{url:"/basicinfo",taskerauthenticate:!0,views:{becometasker:{templateUrl:"app/site/modules/tasker/views/hoursInfo-step8.html"}},data:{meta:{title:"Tasker SignUp"}}}).state("becometasker.success",{url:"/basicinfo",views:{becometasker:{templateUrl:"app/site/modules/tasker/views/post_step8.html"}},data:{meta:{title:"Tasker SignUp"}}}).state("hirestep1",{url:"/hirestep1/:slug",views:{content:{templateUrl:"app/site/modules/task-step/views/hire-step1.html",controller:"taskCtrl",controllerAs:"TAC"}},data:{meta:{title:"Task"}},resolve:{TaskserviceResolve:function(TaskService,$stateParams,AuthenticationService){return TaskService.taskbaseinfo($stateParams.slug)},CurrentUserTaskserviceResolve:function(MainService,AuthenticationService){var user=AuthenticationService.GetCredentials();return MainService.getCurrentUsers(user.currentUser.username)}}}).state("search",{url:"/search/:slug?&task",views:{content:{templateUrl:"app/site/modules/task-step/views/search-results.html",controller:"taskFilterCtrl",controllerAs:"TFC"}},data:{meta:{title:"Task"}},resolve:{SearchResolve:function(TaskService,$stateParams){return TaskService.searchTasker($stateParams.task)},TaskserviceResolve:function(TaskService,$stateParams){return TaskService.taskbaseinfo($stateParams.slug)},CurrentUserTaskserviceResolve:function(MainService,AuthenticationService){var user=AuthenticationService.GetCredentials();if(user.currentUser.username)return MainService.getCurrentUsers(user.currentUser.username)},TaskServiceNewResolve:function(TaskService,$stateParams){return TaskService.getTaskDetailsbyid($stateParams.task)},TaskerCountResolve:function(TaskService,$stateParams){return TaskService.taskerCount($stateParams.task,0,5)}}}).state("account",{url:"/account",authenticate:!0,views:{content:{templateUrl:"app/site/modules/accounts/views/accounts.html",controller:"accountsCtrl",controllerAs:"ACC"}},data:{meta:{title:"My Account"}},resolve:{accountServiceResolve:function(AuthenticationService,MainService){var user=AuthenticationService.GetCredentials();if(user.currentUser.username){if("user"==user.currentUser.user_type)return MainService.getCurrentUsers(user.currentUser.username);if("tasker"==user.currentUser.user_type)return MainService.getCurrentTaskers(user.currentUser.username)}}}}).state("notifyaccount",{url:"/notifyaccount/:status",views:{content:{templateUrl:"app/site/modules/accounts/views/accounts.html",controller:"accountsCtrl",controllerAs:"ACC"}},data:{meta:{title:"My Account"}},resolve:{accountServiceResolve:function(AuthenticationService,MainService,$stateParams){var user=AuthenticationService.GetCredentials();if(user.currentUser.username){if("user"==user.currentUser.user_type)return MainService.getCurrentUsers(user.currentUser.username);if("tasker"==user.currentUser.user_type)return MainService.getCurrentTaskers(user.currentUser.username)}}}}).state("carddeatil",{url:"/carddeatil/:slug",authenticate:!0,views:{content:{templateUrl:"app/site/modules/carddetail/views/carddetail.html",controller:"carddetailCtrl",controllerAs:"CDC"}},data:{meta:{title:"Payment"}},resolve:{CarddetailResolve:function(CarddetailService,$stateParams){return CarddetailService.gettaskbyid($stateParams.slug)},CurrentUserResolve:function(MainService,AuthenticationService){var user=AuthenticationService.GetCredentials();if(user.currentUser.username)return MainService.getCurrentUsers(user.currentUser.username)}}}).state("paymentsuccess",{url:"/payment-success",authenticate:!0,views:{content:{templateUrl:"app/site/modules/carddetail/views/carddetailsuccess.html"}},data:{meta:{title:"Payment"}}}).state("walletsuccess",{url:"/wallet-success",authenticate:!0,views:{content:{templateUrl:"app/site/modules/carddetail/views/walletsuccess.html"}},data:{meta:{title:"Payment"}}}).state("paymentfailed",{url:"/payment-failed/:task",authenticate:!0,views:{content:{templateUrl:"app/site/modules/carddetail/views/carddetailfailed.html",controller:"paypalfaileddetailCtrl",controllerAs:"PPDC"}},data:{meta:{title:"Payment"}},resolve:{paypaltaskid:function($stateParams){return $stateParams}}}).state("paymentfaileduser",{url:"/walletpayment-failed",authenticate:!0,views:{content:{templateUrl:"app/site/modules/carddetail/views/carddetailfaileduser.html",controller:"paypalfaileddetailCtrl",controllerAs:"PPDC"}},data:{meta:{title:"Payment"}},resolve:{paypaltaskid:function($stateParams){return $stateParams}}}).state("logout",{url:"/logout",views:{content:{controller:"LogoutController",controllerAs:"DBC"}},data:{meta:{title:"Logout"}}}).state("taskerProfile",{url:"/tasker/:taskerId/:sub_id?slug",views:{content:{templateUrl:"app/site/modules/task-step/views/tasker_profile.html",controller:"taskProfileCtrl",controllerAs:"TPC"}},data:{meta:{title:"Tasker Details"}},resolve:{TaskProfileResolve:function(TaskService,$stateParams){return TaskService.taskprofileinfo($stateParams.taskerId)}}})}]).controller("rootCtrl",function($window,$scope,$rootScope,$state,AuthenticationService,MainService,socket,notify,$translate,toastr,$cookieStore,ngMeta,$sce){var rc=this;MainService.getMainData().then(function(results){rc.title=results.response[0].settings.site_title,rc.getsetting=results.response[0].settings,$rootScope.siteurl=results.response[0].settings.site_url,$scope.cashOption=rc.getsetting.pay_by_cash.status,rc.favicon=results.response[0].settings.site_url+results.response[0].settings.favicon,ngMeta.setDefaultTag("title",results.response[1].seo.seo_title),ngMeta.setDefaultTag("titleSuffix"," | "+rc.title),ngMeta.setDefaultTag("keyword",results.response[1].seo.focus_keyword),ngMeta.setDefaultTag("description",results.response[1].seo.meta_description),$window.ga("create",results.response[1].seo.webmaster.google_analytics,"auto"),rc.socialNetworks=results.response[2].social,rc.language=results.response[3].languages,rc.widgets=results.response[4].widgets,rc.signupimg=results.response[5].images[0],rc.loginimage=results.response[5].images[3],rc.bgimage=results.response[5].images[1],rc.tpimg=results.response[5].images[4],rc.Currency=results.response[6].currencies,rc.sociallinks=results.response[7].social,rc.pages=results.response[8].pages,rc.social=[],rc.appstore=[],rc.sociallinks[0].settings.link.filter(function(data){1==data.status&&rc.social.push(data)}),rc.sociallinks[0].settings.mobileapp.filter(function(data){1==data.status&&rc.appstore.push(data)}),rc.copyrightYear=new Date,$scope.date={format:results.response[0].settings.date_format+" "+results.response[0].settings.time_format,timezone:results.response[0].settings.time_zone,date_format:results.response[0].settings.time_format,time_format:results.response[0].settings.time_format}}),MainService.getDefaultCurrency().then(function(response){$cookieStore.get("Currency")?(rc.DefaultCurrency=$cookieStore.get("Currency"),$scope.DefaultCurrency=$cookieStore.get("Currency")):(rc.DefaultCurrency=response,$scope.DefaultCurrency=response)}),rc.setDefaultCurrency=function(data){MainService.getDefaultCurrency(data).then(function(response){rc.DefaultCurrency=response,$scope.DefaultCurrency=response,$cookieStore.put("Currency",response),document.body.scrollTop=document.documentElement.scrollTop=0})},rc.otpverifications=function(data){data?MainService.otpverifications(data).then(function(response){rc.userdata=response,data==rc.userdata.username?$state.go("signupotp",{id:rc.userdata._id},{reload:!1}):$translate("USERNAME ALREADY ACTIVATED").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},function(err){$translate(err.message).then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}):$translate("ENTER USER NAME").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},MainService.getDefaultLanguage().then(function(response){$cookieStore.get("language")?(rc.language_code=$cookieStore.get("language_code"),rc.DefaultLanguage=$cookieStore.get("language"),$rootScope.language=$cookieStore.get("language"),$translate.proposedLanguage(rc.language_code)||$translate.use(rc.language_code)):(rc.DefaultLanguage=response[0].name,$rootScope.language=response[0].name,$translate.proposedLanguage(response[0].code)||$translate.use(response[0].code))}),rc.setDefaultLanguage=function(data){MainService.getDefaultLanguage(data).then(function(response){$cookieStore.put("language",response[0].name),$rootScope.language=response[0].name,$cookieStore.put("language_code",response[0].code),$translate.proposedLanguage(response[0].code)||$translate.use(response[0].code),rc.DefaultLanguage&&(MainService.getTransalatePage($rootScope.pageId,rc.DefaultLanguage).then(function(response){0!=response.length?($scope.html=response[0].description,$rootScope.trustedHtml=$sce.trustAsHtml($scope.html)):$rootScope.translatepage="Translate language is not available"}),MainService.getTransalatePageNames(rc.DefaultLanguage).then(function(response){var matchid,translatepages=response;angular.forEach(rc.pages[0].categoryname,function(data,key){angular.forEach(translatepages,function(data1){data.parent?currentid=data.parent:currentid=data._id,matchid=data1.parent?data1.parent:data1._id,currentid==matchid&&(rc.pages[0].categoryname[key]=data1)})}),angular.forEach(rc.pages[1].categoryname,function(data,key){angular.forEach(translatepages,function(data1){matchid=data1.parent?data1.parent:data1._id,data._id==matchid&&(rc.pages[1].categoryname[key]=data1)})})}))})},$rootScope.$on("notification",function(event,data){AuthenticationService.currentmsgcount(data).then(function(response){$scope.chatCount=response})}),$rootScope.$on("webNotification",function(event,data){MainService.getNotificationsCount(data).then(function(response){$scope.notifyCount=response})}),$rootScope.$on("unreadmsg",function(event,data){AuthenticationService.unreadmsg(data).then(function(response){$scope.unreadmsgs=response})}),$scope.currentUserCredentials=AuthenticationService.GetCredentials(),""==$scope.currentUserCredentials||0==Object.keys($scope.currentUserCredentials).length?($rootScope.userId="",$rootScope.username="",$rootScope.usertype="",$rootScope.taskerStatus=""):($rootScope.userId=$scope.currentUserCredentials.currentUser.user_id,$rootScope.username=$scope.currentUserCredentials.currentUser.username,$rootScope.usertype=$scope.currentUserCredentials.currentUser.user_type,$rootScope.taskerStatus=$scope.currentUserCredentials.currentUser.tasker_status,socket.emit("create room",{user:$rootScope.userId}),notify.emit("join network",{user:$rootScope.userId}),$rootScope.$emit("notification",{user:$rootScope.userId,type:$rootScope.usertype}),$rootScope.$emit("webNotification",{user:$rootScope.userId,type:$rootScope.usertype}),$rootScope.$emit("unreadmsg",{user:$rootScope.userId,type:$rootScope.usertype})),$scope.tinymceOptions={plugins:"link image code",toolbar:"undo redo | bold italic | alignleft aligncenter alignright | code"},socket.on("roomcreated",function(data){$scope.socket=data}),socket.on("webupdatechat",function(data){"chat"!=$state.current.name&&$rootScope.$emit("notification",{user:$rootScope.userId,type:$rootScope.usertype})}),notify.on("network created",function(data){$scope.socket=data}),notify.on("web notification",function(data){$rootScope.$emit("webNotification",{user:$rootScope.userId,type:$rootScope.usertype}),toastr.info(data.message.message,"Notification")}),$scope.alerts=[],$scope.alertTimeout=5e3,$scope.addAlert=function(type,msg){var alert={};alert.type=type,alert.msg=msg,$scope.alerts.push(alert)},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$rootScope.$on("eventName",function(event,args){$scope.currentUserCredentials=AuthenticationService.GetCredentials(),$scope.cartcount=args.count,""==$scope.currentUserCredentials||0==Object.keys($scope.currentUserCredentials).length?($rootScope.userId="",
$rootScope.username="",$rootScope.usertype="",$rootScope.taskerStatus=""):($rootScope.userId=$scope.currentUserCredentials.currentUser.user_id,$rootScope.username=$scope.currentUserCredentials.currentUser.username,$rootScope.usertype=$scope.currentUserCredentials.currentUser.user_type,$rootScope.taskerStatus=$scope.currentUserCredentials.currentUser.tasker_status)})}).controller("MainCtrl",function($scope,$location,$rootScope,$http,toastr,MainserviceResolve,MainService,$state,$translate){var mac=this;mac.myInterval=9e3,mac.data=MainserviceResolve,mac.postheader=mac.data.response[1].PostHeader,mac.banner=mac.data.response[3].slider,$scope.getLocation=function(data){return MainService.searchSuggestions(data).then(function(response){return response},function(error){return error})},mac.subscription=function(subscriptionForm,data){function clearSubscribe(){mac.email="",subscriptionForm.$setPristine(),subscriptionForm.$setUntouched(),subscriptionForm.email.$setValidity(),subscriptionForm.email.$setDirty()}return data?MainService.subscription(data).then(function(response){$translate("SUBSCRIBED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),clearSubscribe()},function(error){$translate("EMAIL ALREADY SUBSCRIBED").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}),clearSubscribe()}):void $translate("INVALID EMAIL").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},$scope.searchData={},mac.getsubcategory=function(parentid){return MainService.getsubcategory(parentid).then(function(response){return $scope.searchData.child=null,mac.subcategorydata=response,response},function(error){return error})},$scope.changeparent=function(data){return MainService.searchchildSuggestions(data).then(function(response){$scope.childcat=response},function(error){return error})},$scope.search=function(data){data.parent?data.child?$state.go("hirestep1",{slug:data.child.slug}):$state.go("category",{slug:data.parent.slug}):$translate("PLEASE CHOOSE A CATEGORY").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}}).controller("MorecategoryCtrl",function(MorecategoryserviceResolve){var moc=this;moc.count=4,moc.data=MorecategoryserviceResolve}).controller("DatepickerDemoCtrl",function($scope){$scope.today=function(){$scope.dt=new Date},$scope.today(),$scope.clear=function(){$scope.dt=null},$scope.disabled=function(date,mode){return"day"===mode&&(0===date.getDay()||6===date.getDay())},$scope.toggleMin=function(){$scope.minDate=$scope.minDate?null:new Date},$scope.toggleMin(),$scope.open=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.opened=!0},$scope.dateOptions={formatYear:"yy",startingDay:1,"class":"datepicker"},$scope.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],$scope.format=$scope.formats[0]}).controller("DatepickerDobCtrl",function($scope){$scope.today=function(){$scope.dt=new Date},$scope.today(),$scope.disabled=function(date,mode){return"day"===mode&&(0===date.getDay()||6===date.getDay())},$scope.toggleMin=function(){$scope.minDate=$scope.minDate?null:new Date(1945,1,1)},$scope.toggleMin(),$scope.open=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.opened=!0},$scope.dateOptions={formatYear:"yy",startingDay:1,"class":"datepicker"},$scope.formats=["dd-MM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],$scope.format=$scope.formats[0]}).filter("clock",function(){return function(timestamp,date){return moment.tz(timestamp,date.timezone).format(date.format)}}).filter("money",["$filter",function(filter){var currencyFilter=filter("currency");return function(amount,data){var calAmount=amount*data.value,fractionSize=2;return currencyFilter(calAmount,data.symbol+" ",fractionSize)}}]).filter("clocksettings",function(){return function(timestamp,format,timezone){return moment.tz(timestamp,timezone).format(format)}}).directive("submitValidate",function(){return{require:"form",restrict:"A",link:function(scope,element,attributes){var $element=angular.element(element);$element.on("submit",function(e){$element.find(".ng-pristine").removeClass("ng-pristine").addClass("ng-dirty");var form=scope[attributes.name];angular.forEach(form,function(formElement,fieldName){"$"!==fieldName[0]&&(formElement.$pristine=!1,formElement.$dirty=!0)},this),form.$setDirty(),scope.$apply()})}}}).directive("taskAction",function(){return{restrict:"EA",link:function(scope,element,attributes){var $element=angular.element(element);$element.on("click",function(e){$(".action-space").not($element.parents(".slidetd").find(".action-space")).hide().removeClass("clickd"),$element.parents(".slidetd").find(".action-space").hasClass("clickd")?$element.parents(".slidetd").find(".action-space").hide().removeClass("clickd"):$element.parents(".slidetd").find(".action-space").show().addClass("clickd"),e.preventDefault()})}}}).directive("stringToNumber",function(){return{require:"ngModel",link:function(scope,element,attrs,ngModel){ngModel.$parsers.push(function(value){return""+value}),ngModel.$formatters.push(function(value){if(value)return parseFloat(value.replace(",",""))})}}}).directive("errSrc",function(){return{link:function(scope,element,attrs){element.bind("error",function(){attrs.src!=attrs.errSrc&&(attrs.errSrc="uploads/default/user.jpg",attrs.$set("src",attrs.errSrc))})}}}).directive("checkFileSize",function(){return{link:function(scope,elem,attr,ctrl){$(elem).bind("change",function(){alert("File size:"+this.files[0].size)})}}}).filter("encodeURIComponent",function($window){return $window.encodeURIComponent}).filter("decodeURIComponent",function($window){return $window.decodeURIComponent}).directive("numbersOnly",function(){return{require:"ngModel",link:function(scope,element,attr,ngModelCtrl){function fromUser(text){if(text){var transformedInput=text.replace(/[^0-9]/g,"");return transformedInput!==text&&(ngModelCtrl.$setViewValue(transformedInput),ngModelCtrl.$render()),transformedInput}}ngModelCtrl.$parsers.push(fromUser)}}}).directive("allowOnlyNumbers",function(){return{restrict:"A",link:function(scope,elm,attrs,ctrl){elm.on("keydown",function(event){return 64!=event.which&&16!=event.which&&(event.which>=48&&event.which<=57||(event.which>=96&&event.which<=105||([8,13,27,37,38,39,40,9,190,110].indexOf(event.which)>-1||(event.preventDefault(),!1))))})}}}).directive("scroll",function($timeout){return{restrict:"A",link:function(scope,element,attr){scope.$watchCollection(attr.scroll,function(newVal){$timeout(function(){element[0].scrollTop=element[0].scrollHeight})})}}}).directive("lazyerr",function(){return{restrict:"A",link:function(scope,element,attrs){return attrs.$observe("afklLazyImageLoaded",function(value){})}}}).directive("tooltip",function(){return{restrict:"A",link:function(scope,element,attrs){$(element).hover(function(){},function(){})}}}).directive("disallowSpaces",function(){return{restrict:"A",link:function($scope,$element){$element.bind("input",function(){$(this).val($(this).val().replace(/ /g,""))})}}});var app=angular.module("handyforall.site");app.factory("MainService",MainService);var app=angular.module("handyforall.site");app.factory("notify",notify),angular.module("Authentication").controller("registerCtrl",registerCtrl).controller("LogoutController",LogoutController).controller("LogoffconfirmModalInstanceCtrl",LogoffconfirmModalInstanceCtrl).controller("userloginCtrl",userloginCtrl).controller("registerTaskerCtrl",registerTaskerCtrl).controller("taskerloginCtrl",taskerloginCtrl),registerTaskerCtrl.$inject=["$scope","$rootScope","$location","AuthenticationService","$state","toastr","$cookieStore","socket","$translate"],taskerloginCtrl.$inject=["$scope","$rootScope","$location","AuthenticationService","$state","toastr","$cookieStore","socket","$translate"],userloginCtrl.$inject=["$scope","$http","$rootScope","$location","AuthenticationService","$state","toastr","$cookieStore","socket","PreviousState","$window","$translate"],registerCtrl.$inject=["$scope","$rootScope","$location","AuthenticationService","$state","$filter","toastr","$cookieStore","$stateParams","$translate"],LogoutController.$inject=["$scope","$rootScope","$location","AuthenticationService","$state","$filter","toastr","$cookieStore"],LogoutController.$inject=["$scope","$rootScope","$location","AuthenticationService","$state","$filter","toastr","$cookieStore","$uibModal","$translate"],LogoffconfirmModalInstanceCtrl.$inject=["$uibModalInstance","$state","sweet"];var app=angular.module("Authentication");app.factory("AuthenticationService",AuthenticationService),AuthenticationService.$inject=["$http","$cookieStore","$rootScope","toastr","$q","$cookies","Upload","socket","notify"],angular.module("handyforall.site").directive("onBlurValidation",function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){ctrl&&(elm.on("focus",function(){elm.addClass("has-focus"),scope.$apply(function(){ctrl.hasFocus=!0})}),elm.on("blur",function(){elm.removeClass("has-focus"),elm.addClass("has-visited"),scope.$apply(function(){ctrl.hasFocus=!1,ctrl.hasVisited=!0})}),elm.closest("form").on("submit",function(){elm.addClass("has-visited"),scope.$apply(function(){ctrl.hasFocus=!1,ctrl.hasVisited=!0})}))}}}),angular.module("checklist-model",[]).directive("checklistModel",["$parse","$compile",function($parse,$compile){function contains(arr,item,comparator){if(angular.isArray(arr))for(var i=arr.length;i--;)if(comparator(arr[i],item))return!0;return!1}function add(arr,item,comparator){return arr=angular.isArray(arr)?arr:[],contains(arr,item,comparator)||arr.push(item),arr}function remove(arr,item,comparator){if(angular.isArray(arr))for(var i=arr.length;i--;)if(comparator(arr[i],item)){arr.splice(i,1);break}return arr}function postLinkFn(scope,elem,attrs){function setValueInChecklistModel(value,checked){var current=getter(scope.$parent);angular.isFunction(setter)&&(checked===!0?setter(scope.$parent,add(current,value,comparator)):setter(scope.$parent,remove(current,value,comparator)))}function setChecked(newArr,oldArr){return checklistBeforeChange&&checklistBeforeChange(scope)===!1?void setValueInChecklistModel(value,scope[attrs.ngModel]):void(scope[attrs.ngModel]=contains(newArr,value,comparator))}var checklistModel=attrs.checklistModel;attrs.$set("checklistModel",null),$compile(elem)(scope),attrs.$set("checklistModel",checklistModel);var getter=$parse(checklistModel),setter=getter.assign,checklistChange=$parse(attrs.checklistChange),checklistBeforeChange=$parse(attrs.checklistBeforeChange),value=attrs.checklistValue?$parse(attrs.checklistValue)(scope.$parent):attrs.value,comparator=angular.equals;if(attrs.hasOwnProperty("checklistComparator"))if("."==attrs.checklistComparator[0]){var comparatorExpression=attrs.checklistComparator.substring(1);comparator=function(a,b){return a[comparatorExpression]===b[comparatorExpression]}}else comparator=$parse(attrs.checklistComparator)(scope.$parent);scope.$watch(attrs.ngModel,function(newValue,oldValue){if(newValue!==oldValue){if(checklistBeforeChange&&checklistBeforeChange(scope)===!1)return void(scope[attrs.ngModel]=contains(getter(scope.$parent),value,comparator));setValueInChecklistModel(value,newValue),checklistChange&&checklistChange(scope)}}),angular.isFunction(scope.$parent.$watchCollection)?scope.$parent.$watchCollection(checklistModel,setChecked):scope.$parent.$watch(checklistModel,setChecked,!0)}return{restrict:"A",priority:1e3,terminal:!0,scope:!0,compile:function(tElement,tAttrs){if(("INPUT"!==tElement[0].tagName||"checkbox"!==tAttrs.type)&&"MD-CHECKBOX"!==tElement[0].tagName&&!tAttrs.btnCheckbox)throw'checklist-model should be applied to `input[type="checkbox"]` or `md-checkbox`.';if(!tAttrs.checklistValue&&!tAttrs.value)throw"You should provide `value` or `checklist-value`.";return tAttrs.ngModel||tAttrs.$set("ngModel","checked"),postLinkFn}}}]),angular.module("ngIntlTelInput",[]),angular.module("ngIntlTelInput").provider("ngIntlTelInput",function(){var me=this,props={},setFn=function(obj){if("object"==typeof obj)for(var key in obj)props[key]=obj[key]};me.set=setFn,me.$get=["$log",function($log){return Object.create(me,{init:{value:function(elm){window.intlTelInputUtils||$log.warn("intlTelInputUtils is not defined. Formatting and validation will not work."),elm.intlTelInput(props)}}})}]}),angular.module("ngIntlTelInput").directive("ngIntlTelInput",["ngIntlTelInput","$log","$http",function(ngIntlTelInput,$log,$http){return{restrict:"A",require:"ngModel",scope:{country:"@"},link:function(scope,elm,attr,ctrl){return attr.type&&"text"!==attr.type&&"tel"!==attr.type||"INPUT"!==elm[0].tagName?void $log.warn("ng-intl-tel-input can only be applied to a *text* or *tel* input"):(ctrl.$validators.ngIntlTelInput=function(value){return!(value||elm[0].value.length>0)||elm.intlTelInput("isValidNumber")},ctrl.$parsers.push(function(value){var phone={};return phone.code="+"+elm.intlTelInput("getSelectedCountryData").dialCode,phone.number=elm.intlTelInput("getNumber"),phone.number=phone.number.replace(phone.code,""),phone}),void ctrl.$formatters.push(function(phone){return $http.get("//ipinfo.io").then(function(response){var countryCode=response&&response.data.country?response.data.country:"";return ngIntlTelInput.set({defaultCountry:countryCode}),ngIntlTelInput.init(elm),phone?(elm.intlTelInput("setNumber",phone.code+phone.number),phone.number):void 0})}))}}}]),angular.module("handyforall.becometasker").controller("becomeTaskerCtrl",becomeTaskerCtrl),becomeTaskerCtrl.$inject=["$scope","$compile","uiCalendarConfig","$uibModal","$state","$cookieStore","CategoryserviceResolve","$filter","toastr","AuthenticationService","$rootScope","$location","accountService","$translate","NgMap","$timeout"],angular.module("handyforall.becometasker").controller("ModalInstanceWorkingDayCtrl",function($scope,$uibModalInstance,DaysData,WorkingDays,workingTimes,selectedIndex){$scope.WorkingDays=WorkingDays[selectedIndex],$scope.workingTimes=workingTimes,$scope.days=DaysData,$scope.ok=function(){1==$scope.WorkingDays.hour.morning||1==$scope.WorkingDays.hour.afternoon||1==$scope.WorkingDays.hour.evening?$scope.WorkingDays.not_working=!1:$scope.WorkingDays.not_working=!0,$uibModalInstance.close($scope.WorkingDays,selectedIndex)},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").directive("cropImgChange",function(){return{restrict:"A",link:function(scope,element,attrs){var onChangeHandler=scope.$eval(attrs.cropImgChange);element.bind("change",onChangeHandler)}}}),angular.module("handyforall.becometasker").controller("ModalInstancecategory",function(accountService,$uibModalInstance,experiences,user,toastr,categories,category,selectedCat,defaultcurrency,$translate){var acm=this;acm.user=user,acm.selectedCat=selectedCat,acm.categories=categories,acm.defaultcurrency=defaultcurrency,acm.experiences=experiences,acm.selectedCategoryData={},category?acm.mode="Edit":(acm.mode="Add",acm.categories=acm.categories.filter(function(obj){return acm.selectedCat.indexOf(obj._id)===-1}));for(var i=0;i<acm.user.taskerskills.length;i++)acm.user.taskerskills[i].childid==category&&(acm.selectedCategoryData=angular.copy(acm.user.taskerskills[i]));acm.onChangeCategory=function(category){acm.category=acm.categories.filter(function(obj){return obj._id===category})[0]},acm.onChangeCategoryChild=function(category){accountService.getChild(category).then(function(response){acm.MinimumAmount=response.commision})},acm.ok=function(valid,data){valid?(acm.selectedCategoryData.mode=acm.mode,$uibModalInstance.close(acm.selectedCategoryData)):toastr.error("form is invalid")},acm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.contactus").controller("contactCtrl",contactCtrl),contactCtrl.$inject=["$scope","ContactService","$rootScope","$location","$filter","$state","toastr","$translate"];var app=angular.module("handyforall.category");app.factory("ContactService",ContactService),angular.module("handyforall.category").controller("categoryCtrl",categoryCtrl),categoryCtrl.$inject=["$scope","$rootScope","$location","$stateParams","CategoryserviceResolve","CategoryService","$state","$translate","ngMeta"];var app=angular.module("handyforall.category");app.factory("CategoryService",CategoryService),angular.module("handyforall.task").controller("taskCtrl",taskCtrl),taskCtrl.$inject=["$scope","$rootScope","$location","$stateParams","$uibModal","TaskService","TaskserviceResolve","toastr","$state","AuthenticationService","CurrentUserTaskserviceResolve","MainService","$translate","ngMeta"],angular.module("handyforall.task").controller("RegisterModalInstanceCtrl",function($modalInstance,$filter,toastr,$scope,AuthenticationService,$cookieStore,$state,$translate){var rcm=this;rcm.registerUser=function(){$modalInstance.close(rcm)},rcm.registerUser=function(isValid,formData){rcm.Error="";var today=$filter("date")(new Date,"yyyy-MM-dd HH:mm:ss");isValid?(rcm.UserDetails.today=today,rcm.UserDetails.role=rcm.type,rcm.UserDetails.location=$scope.location,AuthenticationService.Register(rcm.UserDetails,function(err,response){if(err)for(var i=0;i<err.length;i++)toastr.error("Your credentials are wrong "+err[i].msg+"--"+err[i].param);else response.user==rcm.UserDetails.username?(AuthenticationService.SetCredentials(response.user,response.user_id,response.token,response.user_type,response.tasker_status),$cookieStore.remove("TaskerData"),"user"==rcm.type?$location.path("/"):$state.reload()):$translate("EMAIL ID ALREADY EXISTS OR USER NAME EXISTS").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})):$translate("INVALID DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}}),angular.module("handyforall.task").controller("changeCategoryModalInstanceCtrl",function($uibModalInstance){var ccm=this;ccm.ok=function(){$uibModalInstance.close("ok")},ccm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.task").controller("AddAddress",function($uibModalInstance,toastr,user,$location,$state,$scope,$translate){var ata=this;ata.editaddressdata=user,$scope.location={},ata.addressList={},ata.addressList.location={lat:"",lng:""},ata.placeChanged=function(){ata.place=this.getPlace(),ata.addressList.location.lat=ata.place.geometry.location.lat(),ata.addressList.location.lng=ata.place.geometry.location.lng(),ata.availability=2;for(var locationa=ata.place,i=0;i<locationa.address_components.length;i++)for(var j=0;j<locationa.address_components[i].types.length;j++)"sublocality_level_1"==locationa.address_components[i].types[j]&&(ata.editaddressdata.line1=locationa.address_components[i].long_name),"route"!=locationa.address_components[i].types[j]&&"street_number"!=locationa.address_components[i].types[j]||(ata.editaddressdata.street=locationa.address_components[i].long_name),"sublocality_level_2"==locationa.address_components[i].types[j]&&(ata.editaddressdata.city=locationa.address_components[i].long_name),"locality"==locationa.address_components[i].types[j]&&(ata.editaddressdata.locality=locationa.address_components[i].long_name),"country"==locationa.address_components[i].types[j]&&(ata.editaddressdata.country=locationa.address_components[i].long_name),"postal_code"==locationa.address_components[i].types[j]&&(ata.editaddressdata.zipcode=locationa.address_components[i].long_name),"administrative_area_level_1"!=locationa.address_components[i].types[j]&&"administrative_area_level_2"!=locationa.address_components[i].types[j]||(ata.editaddressdata.state=locationa.address_components[i].long_name)},ata.ok=function(isValid){""==ata.addressList.location.lat||""==ata.addressList.location.lng?$translate("PLEASE ENTER VALID LOCATION").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}):1==isValid?$uibModalInstance.close(ata):$translate("INVALID DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},ata.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.task").controller("DeleteAddress",function($uibModalInstance,user,$state){var data=this;data.ok=function(){$uibModalInstance.close()},data.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.task").directive("setClassWhenAtTop",function($window){var $win=angular.element($window);return{restrict:"A",link:function(scope,element,attrs){var topClass=attrs.setClassWhenAtTop;offsetTop=element.offset().top,$win.on("scroll",function(e){$win.scrollTop()>=offsetTop?element.addClass(topClass):element.removeClass(topClass)})}}}),angular.module("handyforall.task").controller("taskProfileCtrl",taskProfileCtrl),taskProfileCtrl.$inject=["$scope","$rootScope","$location","$stateParams","$uibModal","TaskService","TaskProfileResolve","toastr","$state","$translate"],angular.module("handyforall.task").controller("taskFilterCtrl",taskFilterCtrl),taskFilterCtrl.$inject=["$scope","$rootScope","$location","$stateParams","SearchResolve","TaskService","TaskserviceResolve","toastr","$state","$filter","AuthenticationService","$modal","MainService","TaskServiceNewResolve","$translate","ngMeta","TaskerCountResolve","NgMap","$scope","$q","$log"],angular.module("handyforall.task").controller("changeCategoryModalInstanceCtrl",function($uibModalInstance){var ccm=this;ccm.ok=function(){$uibModalInstance.close("ok")},ccm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.task").controller("DeleteAddress",function($uibModalInstance,user,$state){var data=this;data.ok=function(){$uibModalInstance.close()},data.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.task").directive("setClassWhenAtTop",function($window){var $win=angular.element($window);return{restrict:"A",link:function(scope,element,attrs){var topClass=attrs.setClassWhenAtTop,offsetTop=element.offset().top;$win.on("scroll",function(e){$win.scrollTop()>=offsetTop?element.addClass(topClass):element.removeClass(topClass)})}}});var app=angular.module("handyforall.task");app.factory("TaskService",TaskService),angular.module("handyforall.accounts").controller("accountsCtrl",accountsCtrl),accountsCtrl.$inject=["$scope","MainService","accountService","accountServiceResolve","$filter","$uibModal","$location","toastr","$timeout","Slug","$state","$window","$anchorScroll","AuthenticationService","sweet","$stateParams","$translate","NgMap"],angular.module("handyforall.accounts").controller("TaskPayModalInstanceCtrl",function($scope,$filter,$uibModalInstance,Taskinfobyid,updatingstatus){var tpm=this;tpm.user=Taskinfobyid.taskdata[0].user,tpm.taskid=Taskinfobyid.taskdata[0]._id,tpm.status=updatingstatus,tpm.bookingid=Taskinfobyid.taskdata[0].booking_id,tpm.taskname=Taskinfobyid.taskdata[0].category.name,tpm.admincommision=Taskinfobyid.settingsdata.settings.admin_commission,tpm.servicetax=Taskinfobyid.settingsdata.settings.service_tax,tpm.minimumamount=Taskinfobyid.settingsdata.settings.minimum_amount,tpm.taskdescription=Taskinfobyid.taskdata[0].task_description,tpm.hourlyrate=$filter("filter")(Taskinfobyid.taskdata[0].tasker.taskerskills,{childid:Taskinfobyid.taskdata[0].category._id}),tpm.totalhour1=function(){tpm.total=tpm.hourlyrate[0].hour_rate,tpm.totalhour>1?(tpm.newtotal=parseInt(tpm.minimumamount)+parseInt(tpm.total)*(parseInt(tpm.totalhour)-1),tpm.taxamount=parseInt(tpm.newtotal)*(parseInt(tpm.servicetax)/100),tpm.adminamount=parseInt(tpm.newtotal)*(parseInt(tpm.admincommision)/100),tpm.commisionamount=parseInt(tpm.adminamount)+parseInt(tpm.taxamount),tpm.grandtotal=parseInt(tpm.newtotal)+parseInt(tpm.commisionamount)):tpm.totalhour<=1?(tpm.newtotal=parseInt(tpm.minimumamount),tpm.taxamount=parseInt(tpm.minimumamount)*(parseInt(tpm.servicetax)/100),tpm.adminamount=parseInt(tpm.minimumamount)*(parseInt(tpm.admincommision)/100),tpm.commisionamount=parseInt(tpm.adminamount)+parseInt(tpm.taxamount),tpm.grandtotal=parseInt(tpm.minimumamount)+parseInt(tpm.commisionamount)):tpm.grandtotal=parseInt(tpm.total)},tpm.ok=function(){$uibModalInstance.close(tpm)},tpm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("DeactivateCtrl",function($uibModalInstance,user,$state){var decm=this;decm.user=user,decm.userid=decm.user._id,decm.ok=function(){$uibModalInstance.close(decm.userid),$state.go("logout")},decm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("CategoriesModalInstanceCtrl",function(accountService,$uibModalInstance,experiences,user,toastr,categories,category,defaultcurrency,$translate){var acm=this;category?acm.role="Edit":acm.role="New",acm.user=user,acm.defaultcurrency=defaultcurrency,acm.categories=categories,acm.experiences=experiences,acm.category=acm.categories.filter(function(obj){return obj._id===category})[0],acm.selectedCategoryData={},acm.selectedCategoryData.skills=[],acm.selectedCategoryData.hour_rate=0,acm.category?acm.mode="EDIT":acm.mode="ADD";for(var i=0;i<acm.user.taskerskills.length;i++)acm.user.taskerskills[i].childid==category&&(acm.selectedCategoryData=acm.user.taskerskills[i]);acm.selectedCategoryData.userid=acm.user._id,acm.onChangeCategory=function(category){acm.category=acm.categories.filter(function(obj){return obj._id===category})[0]},acm.onChangeCategoryChild=function(category){accountService.getChild(category).then(function(response){acm.MinimumAmount=response.commision}),acm.category=acm.user.taskerskills.filter(function(obj){return obj.childid!==category?obj._id===category:void $translate("ALREADY THE CATEGORY IS EXISTS").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})[0]},acm.selectedCategoryData.childid&&accountService.getChild(acm.selectedCategoryData.childid).then(function(response){acm.MinimumAmount=response.commision}),acm.selectedCategoryData.hour_rate=parseFloat((acm.selectedCategoryData.hour_rate*acm.defaultcurrency[0].value).toFixed(2)),acm.ok=function(valid){valid?$uibModalInstance.close(acm.selectedCategoryData):(console.log("ACM.selectedCategoryData.terms",acm.selectedCategoryData.terms),$translate("FORM IS INVALID").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}))},acm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("AvailabilityModalInstanceCtrl",function($scope,$uibModalInstance,workingDays,workingTimes,DaysData,selectedIndex){$scope.WorkingDays=workingDays[selectedIndex],$scope.workingTimes=workingTimes,$scope.days=DaysData,$scope.ok=function(){1==$scope.WorkingDays.hour.morning||1==$scope.WorkingDays.hour.afternoon||1==$scope.WorkingDays.hour.evening?$scope.WorkingDays.not_working=!1:$scope.WorkingDays.not_working=!0,console.log($scope.WorkingDays,selectedIndex),$uibModalInstance.close($scope.WorkingDays,selectedIndex)},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskInviteViewModalInstanceCtrl",function($uibModalInstance,TaskInvite,DefaultCurrency,getsettings){var tvmi=this;tvmi.TaskInvite=TaskInvite,tvmi.DefaultCurrency=DefaultCurrency,tvmi.getsettings=getsettings,tvmi.ok=function(working_day,index){var data={};$uibModalInstance.close(data)},tvmi.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskerExtraViewModalInstanceCtrl",function($uibModalInstance,$translate,Taskid,status,DefaultCurrency,accountService,toastr){var tevmi=this;tevmi.defaultcurrency=DefaultCurrency,tevmi.addmaterial=!1,tevmi.total=0,tevmi.choices=[],tevmi.addNewChoice=function(){var newItemNo=tevmi.choices.length+1;tevmi.choices.push({id:"choice"+newItemNo}),tevmi.calculateChoice()},tevmi.calculateChoice=function(){if(tevmi.total=0,tevmi.newchoice)for(var i=0;i<tevmi.choices.length;i++)tevmi.newchoice.value[i]&&(tevmi.total=tevmi.total+parseFloat(tevmi.newchoice.value[i]))},tevmi.removeChoice=function(){var lastItem=tevmi.choices.length-1;0!=lastItem?(tevmi.newchoice.value[lastItem]="",tevmi.newchoice.name[lastItem]="",tevmi.choices.pop({id:"choice"+lastItem})):(tevmi.addmaterial=!1,tevmi.newchoice.value[lastItem]="",tevmi.newchoice.name[lastItem]="",tevmi.choices.pop({id:"choice"+lastItem})),tevmi.calculateChoice()},tevmi.taskid=Taskid,tevmi.defaultCurrency=DefaultCurrency,tevmi.status=status;var newdata=[];tevmi.ok=function(test,valid){if(valid)if(test.newchoice){for(var i=0;i<test.choices.length;i++){var data={};data.name=test.newchoice.name[i],data.price=parseFloat((test.newchoice.value[i]/tevmi.defaultcurrency[0].value).toFixed(2)),newdata.push(data)}tevmi.newdata=newdata,$uibModalInstance.close(tevmi)}else{var data={};data.taskid=test.taskid,data.status=test.status,$uibModalInstance.close(data)}else $translate("FORM IS INVALID").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},tevmi.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskDetailsViewModalInstanceCtrl",function($uibModalInstance,TaskDetails,DefaultCurrency){var tdvmi=this;tdvmi.TaskDetails=TaskDetails,tdvmi.DefaultCurrency=DefaultCurrency,tdvmi.taskdescription=TaskDetails.task_description,tdvmi.ok=function(){$uibModalInstance.close()},tdvmi.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskDetailsViewforstatusModalInstanceCtrl",function($uibModalInstance,TaskDetails,defaultcurrency){var tdvsmi=this;tdvsmi.defaultcurrency=defaultcurrency,tdvsmi.TaskDetails=TaskDetails;var a=TaskDetails.invoice.worked_hours,hours=Math.trunc(a/60),minutes=a%60;0==hours?.1==minutes?(console.log("/*/*/*/*/"),tdvsmi.Task_time=minutes+" min"):tdvsmi.Task_time=minutes+" mins":tdvsmi.Task_time=hours+" hours "+minutes+" mins",tdvsmi.taskdescription=TaskDetails.task_description,tdvsmi.ok=function(){$uibModalInstance.close()},tdvsmi.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskDetailsIgnoreModalInstanceCtrl",function($translate,$uibModalInstance,$state,userid,status,toastr,cancelreason){var tdimi=this;tdimi.userid=userid,tdimi.taskstatus=status,tdimi.cancelreason=cancelreason,tdimi.other=0,tdimi.ok=function(data){data.reason?$uibModalInstance.close(tdimi):$translate("REASON FIELD IS EMPTY").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},tdimi.cancel=function(){$uibModalInstance.dismiss("cancel")},tdimi.otherclick=function(other){tdimi.other=1},tdimi.click=function(other){tdimi.other=0}}),angular.module("handyforall.accounts").controller("WalletRechargeModal",function($uibModalInstance,$state,$translate,Rechargeamount,toastr){var wrm=this;wrm.rechargeamount=Rechargeamount;var walletamount=wrm.rechargeamount.data.replace(/,/g,""),currencyvalue=wrm.rechargeamount.currencyvalue,result=parseFloat(walletamount)/parseFloat(currencyvalue),walletamount="";wrm.walletamount=result.toFixed(2),wrm.ok=function(isValid){1==isValid?$uibModalInstance.close(wrm):$translate("FORM IS INVALID").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},wrm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskDetailsconfirmModalInstanceCtrl",function($uibModalInstance,$state,sweet,taskid,status,taskerid){var tdcmi=this;tdcmi.taskid=taskid,tdcmi.taskstatus=status,tdcmi.taskerid=taskerid,tdcmi.ok=function(){$uibModalInstance.close(tdcmi)},tdcmi.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("DeleteCategoriesModalInstanceCtrl",function($uibModalInstance,user,category,categoryname,$translate,toastr){
var dacm=this;dacm.category=category,dacm.user=user;var categoryinfo={};categoryinfo.userid=user._id,categoryinfo.categoryid=category,categoryinfo.categoryname=categoryname,dacm.ok=function(){$uibModalInstance.close(categoryinfo),$translate("CATEGORY DELETED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})},dacm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("DisputeReviewModalInstanceCtrl",function($uibModalInstance,TaskDetails,accountService,status,$state){var dnm=this;dnm.indexValue=TaskDetails._id,dnm.ststusvalue=status,dnm.ok=function(){accountService.disputeUpdateTask(dnm.indexValue,dnm.ststusvalue).then(function(response){$state.reload()},function(err){}),$uibModalInstance.close(dnm.review)},dnm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskReviewModalCtrl",function($uibModalInstance,TaskDetails){var trem=this;trem.TaskDetails=TaskDetails,trem.ok=function(){$uibModalInstance.close(trem.review)},trem.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskReviewModalSave",function($uibModalInstance){var trem=this;trem.ok=function(){$uibModalInstance.close(trem.review)},trem.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskTranscationViewModal",function($scope,task,$uibModalInstance,accountService,TaskDetails,defaultcurrency,getsettings,getmaincatname){var trems=this;trems.TaskDetails=TaskDetails,trems.task=task,trems.maincategoryname=getmaincatname.name,trems.defaultcurrency=defaultcurrency,trems.getsettings=getsettings,trems.downloadPdf=function(){accountService.downloadPdf(trems.TaskDetails.bookingid).then(function(response){})},trems.ok=function(){$uibModalInstance.close(trems.review)},trems.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskUserTranscationViewModal",function($scope,task,$uibModalInstance,accountService,TaskDetails,defaultcurrency,getsettings,getmaincatname){var trems=this;trems.TaskDetails=TaskDetails,trems.task=task,trems.maincategoryname=getmaincatname.name,console.log("trems.maincategoryname",trems.maincategoryname),trems.defaultcurrency=defaultcurrency,trems.getsettings=getsettings,(trems.TaskDetails.invoice.amount.total+trems.TaskDetails.invoice.amount.service_tax)*trems.defaultcurrency[0].value>trems.TaskDetails.invoice.amount.coupon*trems.defaultcurrency[0].value?(trems.checkvalue="big",trems.total=(((trems.TaskDetails.invoice.amount.total+trems.TaskDetails.invoice.amount.service_tax)*trems.defaultcurrency[0].value-trems.TaskDetails.invoice.amount.coupon)*trems.defaultcurrency[0].value).toFixed(2)):(trems.checkvalue="small",trems.total="0"),console.log("((TTEMS.TaskDetails.invoice.amount.total + TTEMS.TaskDetails.invoice.amount.service_tax) * TTEMS.defaultcurrency[0].value | number:2)",(trems.TaskDetails.invoice.amount.total+trems.TaskDetails.invoice.amount.service_tax)*trems.defaultcurrency[0].value),console.log("(TTEMS.TaskDetails.invoice.amount.coupon * TTEMS.defaultcurrency[0].value)",trems.TaskDetails.invoice.amount.coupon*trems.defaultcurrency[0].value),trems.downloadPdf=function(){accountService.downloadPdf(trems.TaskDetails.bookingid).then(function(response){})},trems.ok=function(){$uibModalInstance.close(trems.review)},trems.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("addReviewModal",function($uibModalInstance,TaskDetails,$scope,$state){var arm=this;arm.user=TaskDetails.user,arm.tasker=TaskDetails.tasker._id,arm.task=TaskDetails._id,arm.type="user",arm.ok=function(){$uibModalInstance.close(arm),$state.go("account")},arm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("reviewModelCtrl",function($uibModalInstance,data,role){var rmc=this;rmc.reviewData=data,rmc.role=role,rmc.ok=function(){$uibModalInstance.close(rmc)},rmc.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").directive("cropImgChange",function(){return{restrict:"A",link:function(scope,element,attrs){var onChangeHandler=scope.$eval(attrs.cropImgChange);element.bind("change",onChangeHandler)}}});var app=angular.module("handyforall.accounts");app.factory("accountService",accountService),angular.module("handyforall.messages").controller("messagesCtrl",messagesCtrl),messagesCtrl.$inject=["MessageserviceResolve","MessageService","CurrentuserResolve","$uibModal","toastr","$translate"],angular.module("handyforall.messages").controller("deletemessageCtrl",function($uibModalInstance,idinfo){var dacm=this;idinfo.from=idinfo.from,idinfo.to=idinfo.to,dacm.ok=function(){$uibModalInstance.close(idinfo)},dacm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.messages").controller("chatCtrl",chatCtrl),chatCtrl.$inject=["ChatServiceResolve","$state","toastr","$filter","AuthenticationService","TaskProfileResolve","MainService","$stateParams","socket","$scope","$rootScope","TaskServiceResolve","TaskService","CurrentuserResolve","$translate"];var app=angular.module("handyforall.messages");app.factory("socket",socket);var app=angular.module("handyforall.messages");app.factory("MessageService",MessageService),angular.module("handyforall.notifications").controller("notificationCtrl",notificationCtrl),notificationCtrl.$inject=["NotificationsResolve","NotificationService","toastr","$rootScope","$translate"];var app=angular.module("handyforall.notifications");app.factory("NotificationService",NotificationService),angular.module("handyforall.category").controller("carddetailCtrl",carddetailCtrl),carddetailCtrl.$inject=["$scope","$rootScope","$window","$stateParams","$state","CarddetailResolve","CarddetailService","MainService","CurrentUserResolve","$translate","$location","$anchorScroll","toastr"],angular.module("handyforall.category").controller("paypalfaileddetailCtrl",paypalfaileddetailCtrl),paypalfaileddetailCtrl.$inject=["$scope","$rootScope","$window","$stateParams","$state","paypaltaskid"];var app=angular.module("handyforall.carddeatil");app.factory("CarddetailService",CarddetailService),angular.module("handyforall.page").controller("pagesCtrl",pagesCtrl),pagesCtrl.$inject=["$scope","$rootScope","$location","$stateParams","PagesserviceResolve","PageService","$state","$sce","$translate","ngMeta","$cookies"];var app=angular.module("handyforall.category");app.factory("PageService",PageService),angular.module("handyforall.faq").controller("faqCtrl",faqCtrl),faqCtrl.$inject=["$scope","$rootScope","$location","$stateParams","FaqserviceResolve","FaqService","$state","$sce","$translate"],angular.module("handyforall.forgotpassword").controller("emergencyCtrl",emergencyCtrl),emergencyCtrl.$inject=["$scope","toastr","ForgotpasswordService","$stateParams","$translate","$state"];var app=angular.module("handyforall.faq");app.factory("FaqService",FaqService),angular.module("handyforall.forgotpassword").controller("pwdloginCtrl",pwdloginCtrl),pwdloginCtrl.$inject=["$scope","ForgotpasswordService","ForgotpasswordServiceResolve","toastr","$translate"];var app=angular.module("Authentication");app.factory("ForgotpasswordService",ForgotpasswordService),angular.module("handyforall.forgotpassword").controller("pwduserCtrl",pwduserCtrl),pwduserCtrl.$inject=["$scope","ForgotpwduserService","ForgotpwduserServiceResolve","toastr","$translate"];var app=angular.module("Authentication");app.factory("ForgotpwduserService",ForgotpwduserService),angular.module("handyforall.forgotpassword").controller("pwdmailCtrl",pwdmailCtrl),pwdmailCtrl.$inject=["$scope","toastr","ForgotpwdusermailService","$state","$stateParams","$translate"];var app=angular.module("Authentication");app.factory("ForgotpwdusermailService",ForgotpwdusermailService),angular.module("handyforall.forgotpassword").controller("pwdmailtskrCtrl",pwdmailtskrCtrl),pwdmailtskrCtrl.$inject=["$scope","toastr","ForgotpwdtaskermailService","$state","$stateParams","$translate"],angular.module("handyforall.forgotpassword").controller("otploginCtrl",otploginCtrl),otploginCtrl.$inject=["$scope","$state","ForgotpwduserService","toastr","$translate","$stateParams","AuthenticationService","$cookieStore","$location"];var app=angular.module("Authentication");app.factory("ForgotpwdtaskermailService",ForgotpwdtaskermailService);